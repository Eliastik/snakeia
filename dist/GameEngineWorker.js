(()=>{var __webpack_modules__={293:function(module){(function(a){var b=Math.sign,c=Math.min,d=Math.abs;void 0===a.Lowlight&&(a.Lowlight={}),"object"==typeof module.exports&&(module.exports=a.Lowlight);class e{constructor(){this.nodes=new Map}id(t){return t}node(t,e=!1){return e?this.nodes.get(this.id(arguments[0])):this.nodes.get(t)}data(t,e){return 2===arguments.length&&(t.graph.get(this)._data=e),t.graph.get(this)._data}adjacent(t,e){return t.graph.get(this).has(e)}neighbors(t){return Array.from(t.graph.get(this).keys())}connected(t,e){return t.graph.get(this)._connectivity===e.graph.get(this)._connectivity}connect(){let t=Array.from(this.nodes.values()),e=0;for(let e=0;e<t.length;e++)t[e].graph.get(this)._connectivity=void 0;for(let i=0;i<t.length;i++){if(void 0!==t[i].graph.get(this)._connectivity)continue;let r=[t[i]];for(e++;r.length;){let t=r.shift();t.graph.get(this)._connectivity=e,this.neighbors(t).map((t=>{void 0===t.graph.get(this)._connectivity&&0>r.indexOf(t)&&r.push(t)}))}}}add(t){return 1<arguments.length?Array.from(arguments).map((t=>this.add(t))):(t.graph.set(this,new Map),this.nodes.set(t.id,t),t)}delete(t){return 1<arguments.length?Array.from(arguments).map((t=>this.delete(t))):(t.graph.delete(this),this.nodes.delete(t.id),t)}edge(t,e,i=1,r=1){if(!t.graph.has(this)||!e.graph.has(this))throw new Error("Nodes must be on the same graph");return null===i?t.graph.get(this).delete(e):t.graph.get(this).set(e,i),null===r?e.graph.get(this).delete(t):e.graph.get(this).set(t,r),this}cost(t,e){return this.adjacent(t,e)?t.graph.get(this).get(e):null}}e.fromArray=function(t,i={}){let r=e.fromArray.X(t,i.order),s=e.fromArray.Y(t,i.order),n=e.fromArray.at.bind(null,t,i.order),o=[],a=null;for(let t,h=1;h<Math.max(2,arguments.length);h++){t=new e,o.push(t),i=arguments[h]||{};let u=e.fromArray.id.bind(null,r,s,i.torus),c=i.cost||e.fromArray.cost,l=e.fromArray.edge.bind(null,t,c);for(let e=0;e<r;e++)for(let i,r=0;r<s;r++)i=t.add(a?a.get(u(e,r)):new f(u(e,r))),i.x=e,i.y=r,i.graph.get(t)._data=n(e,r),l(i,t.nodes.get(u(e-1,r))),l(i,t.nodes.get(u(e+1,r))),l(i,t.nodes.get(u(e,r-1))),l(i,t.nodes.get(u(e,r+1)));if(i.diagonals)for(let e=0;e<r;e++)for(let r=0;r<s;r++){let s=t.nodes.get(u(e,r)),n=t.adjacent(s,t.nodes.get(u(e-1,r))),o=t.adjacent(s,t.nodes.get(u(e+1,r))),a=t.adjacent(s,t.nodes.get(u(e,r-1))),h=t.adjacent(s,t.nodes.get(u(e,r+1)));"strict"===i.cutting?(n&&a&&l(s,t.nodes.get(u(e-1,r-1))),n&&h&&l(s,t.nodes.get(u(e-1,r+1))),o&&a&&l(s,t.nodes.get(u(e+1,r-1))),o&&h&&l(s,t.nodes.get(u(e+1,r+1)))):((n||a||i.cutting)&&l(s,t.nodes.get(u(e-1,r-1))),(n||h||i.cutting)&&l(s,t.nodes.get(u(e-1,r+1))),(o||a||i.cutting)&&l(s,t.nodes.get(u(e+1,r-1))),(o||h||i.cutting)&&l(s,t.nodes.get(u(e+1,r+1))))}Object.defineProperty(t,"id",{enumerable:!1,configurable:!1,writable:!0,value:t=>u(t.x,t.y)}),t.connect(),t.X=r,t.Y=s,t.TORUS=i.torus,a||(a=t.nodes)}return 1<o.length?o:o[0]},e.fromArray.X=function(t,e="yx"){return"xy"===e?t.length:"yx"===e?t[0].length:0},e.fromArray.Y=function(t,e="yx"){return"xy"===e?t[0].length:"yx"===e?t.length:0},e.fromArray.at=function(t,e="yx",i,r){return"xy"===e?t[i][r]:t[r][i]},e.fromArray.id=function(t=0,e=0,i=!1,r,s){return i?(s+e)%e*t+(r+t)%t:0<=r&&r<t&&0<=s&&s<e?s*t+r:null},e.fromArray.cost=function(){return 1},e.fromArray.edge=function(t,e,i,r){r&&t.edge(i,r,e(t.data(i),t.data(r)),e(t.data(r),t.data(i)))},e.fromArray.update=function(){console.warn("Graph.fromArray isn't implemented yet")};class f{constructor(t,e){for(let i in this.id=t,this.graph=new Map,e)"id"!=i&&"graph"!=i&&(this[i]=e[i])}}class g{constructor(t){this.nodes=[],this.score="function"==typeof t?t:t=>+t}get size(){return this.nodes.length}add(t){if(1<arguments.length){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return this.nodes.push(t),this.bubble(this.size-1)}set(t){let e=this.nodes.indexOf(t);return~e?this.score(t)<=this.score(this.nodes[e])?this.bubble(this.nodes.indexOf(t)):this.sink(this.nodes.indexOf(t)):this.add(t)}pop(){let t=this.nodes[0],e=this.nodes.pop();return 0<this.size&&(this.nodes[0]=e,this.sink(0)),t}top(){return this.nodes[0]}delete(t){if(1<arguments.length){for(let t=0;t<arguments.length;t++)this.delete(arguments[t]);return this}for(let e=0;e<this.size;e++){if(this.nodes[e]!=t)continue;let i=this.nodes.pop();return e==this.size-1?this:(this.nodes[e]=i,this.bubble(e).sink(e))}}bubble(t){let e=this.nodes[t],i=this.score(e);for(;0<t;){let r=Math.floor((t+1)/2)-1,s=this.nodes[r];if(i>=this.score(s))break;this.nodes[r]=e,this.nodes[t]=s,t=r}return this}sink(t){let e=this.nodes[t],i=this.score(e);for(;;){let r=2*(t+1),s=r-1,n=null;if(s<this.size&&this.score(this.nodes[s])<i&&(n=s),r<this.size&&this.score(this.nodes[r])<(n?this.score(this.nodes[n]):i)&&(n=r),null===n)break;this.nodes[t]=this.nodes[n],this.nodes[n]=e,t=n}return this}}let h={manhattan:function(t,e,i={}){let r=d(e.x-t.x),s=d(e.y-t.y);return(i.multiplier||1)*(r+s)},manhattanTorus:function(t,e,i={}){let r=c(d(e.x-t.x),e.x+(i.x||0)-t.x,t.x+(i.x||0)-e.x),s=c(d(e.y-t.y),e.y+(i.y||0)-t.y,t.y+(i.y||0)-e.y);return(i.multiplier||1)*(r+s)},diagonal:function(t,e,i={}){let r=d(e.x-t.x),s=d(e.y-t.y);return m*(r+s)+(dm-2*m)*c(r,s)},diagonalTorus:function(t,e,i={}){let r=c(d(e.x-t.x),e.x+(i.x||0)-t.x,t.x+(i.x||0)-e.x),s=c(d(e.y-t.y),e.y+(i.y||0)-t.y,t.y+(i.y||0)-e.y);return(i.multiplier||1)*(r+s)+((i.diagonalMultiplier||1.4)-2*(i.multiplier||1))*c(r,s)},euclidian:function(t,e,i={}){let r=d(e.x-t.x),s=d(e.y-t.y);return(i.multiplier||1)*Math.sqrt(r*r+s*s)},euclidianTorus:function(t,e,i={}){let r=c(d(e.x-t.x),e.x+(i.x||0)-t.x,t.x+(i.x||0)-e.x),s=c(d(e.y-t.y),e.y+(i.y||0)-t.y,t.y+(i.y||0)-e.y);return(i.multiplier||1)*(r+s)+((i.diagonalMultiplier||1.4)-2*(i.multiplier||1))*c(r,s)}};class i extends Error{constructor(t){super(t),this.name="WorkerError"}}class j{constructor(t,r={}){if(this.graphs=[],this.heuristic=r.heuristic||"manhattan",this.heuristicOptions=r.heuristicOptions||{},Array.isArray(t)&&(this.heuristic=r.heuristic in h?r.heuristic:r.diagonals?r.torus?"diagonalTorus":"diagonal":r.torus?"manhattanTorus":"manhattan",this.heuristicOptions.x=e.fromArray.X(t,r.order),this.heuristicOptions.y=e.fromArray.Y(t,r.order),this.graphs=e.fromArray.apply(this,arguments),!Array.isArray(this.graphs)&&(this.graphs=[this.graphs])),r.thread&&("undefined"==typeof WorkerGlobalScope||!(self instanceof WorkerGlobalScope))){this.worker=null;try{this.worker=new Worker(r.thread)}catch(t){throw"file:"===window.location.protocol&&console.warn("WebWorkers in local files may not be supported by your browser."),new i(`${r.thread} couldn't be opened.`)}"cost"in r&&(r.cost=r.cost.toString()),this.worker.postMessage(["constructor",t,r]),this.path=(t,e,i={})=>{this._worker_path_callback=i.callback,delete i.callback,this.worker.postMessage(["path",t,e,i])},this.worker.onmessage=t=>{let e=JSON.parse(t.data);"path"===e[0]&&this._worker_path_callback(e[1])}}}path(t,e,i={}){if(i.jps)return this.jps(t,e,i);let r=new g((t=>t.estimated)),s=new Map,n=this.graphs[i.layer||0];if(t=n.node(t,!0),e=n.node(e,!0),r.add({node:t,estimated:0}),s.set(t,{score:0,from:null}),!i.static||n.connected(t,e))for(;r.size;){let t=r.pop().node;if(t===e)break;n.neighbors(t).map((o=>{let a=(s.has(t)?s.get(t).score:0)+n.cost(t,o);a<(s.has(o)?s.get(o).score:1/0)&&(s.set(o,{score:a,from:t}),r.set({node:o,estimated:a+h[i.heuristic||this.heuristic](o,e,i.heuristicOptions||this.heuristicOptions)}))})),r.delete(t)}let o=[];if(s.has(e)){let t=e;for(o.push(e);null!==(t=s.get(t).from);)o.push(t);o=o.reverse()}return i.callback&&i.callback(o,s),o}}if(j.JPS=class{constructor(){}static access(t,e,i,r){return t.adjacent(e,r?t.node(i,!0):i)}static neighborhood(t,e,i,r){let s=[],n=i.get(r).from||null;if(null===n)return e.neighbors(r);{let i={x:b(r.x-n.x),y:b(r.y-n.y)};if(0!=i.x&&0!=i.y){let n=t(r,{x:r.x+i.x,y:r.y},!0),o=t(r,{x:r.x,y:r.y+i.y},!0);(n||o)&&(s.push(e.node({x:r.x+i.x,y:r.y+i.y},!0)),n&&(s.push(e.node({x:r.x+i.x,y:r.y},!0)),!t(r,{x:r.x,y:r.y-i.y},!0)&&s.push(e.node({x:r.x+i.x,y:r.y-i.y},!0))),o&&(s.push(e.node({x:r.x,y:r.y+i.y},!0)),!t(r,{x:r.x-i.x,y:r.y},!0)&&s.push(e.node({x:r.x-i.x,y:r.y+i.y},!0))))}else t(r,{x:r.x+i.x,y:r.y+i.y},!0)&&(s.push(e.node({x:r.x+i.x,y:r.y+i.y},!0)),0==i.x?0!=i.y&&(!t(r,{x:r.x-1,y:r.y},!0)&&s.push(e.node({x:r.x-1,y:r.y+i.y},!0)),!t(r,{x:r.x+1,y:r.y},!0)&&s.push(e.node({x:r.x+1,y:r.y+i.y},!0))):(!t(r,{x:r.x,y:r.y-1},!0)&&s.push(e.node({x:r.x+i.x,y:r.y-1},!0)),!t(r,{x:r.x,y:r.y+1},!0)&&s.push(e.node({x:r.x+i.x,y:r.y+1},!0))))}return s.filter((t=>t))}static jump(t,e,i,r,s,n){for(;;){if(!t(n,s))return null;if(s.x===r.x&&s.y===r.y)return s;let o={x:b(s.x-n.x),y:b(s.y-n.y)};if(0!=o.x&&0!=o.y){if(!t(s,{x:s.x-o.x,y:s.y},!0)&&t(s,{x:s.x-o.x,y:s.y+o.y},!0)||!t(s,{x:s.x,y:s.y-o.y},!0)&&t(s,{x:s.x+o.x,y:s.y-o.y},!0))return s;let n=j.JPS.jump.bind(this,t,e,i,r);if(null!==n(e.node({x:s.x+o.x,y:s.y},!0),s)||null!==n(e.node({x:s.x,y:s.y+o.y},!0),s))return s}else if(0!=o.x){if(!t(s,{x:s.x,y:s.y-1},!0)&&t(s,{x:s.x+o.x,y:s.y-1},!0)||!t(s,{x:s.x,y:s.y+1},!0)&&t(s,{x:s.x+o.x,y:s.y+1},!0))return s}else if(0!=o.y&&(!t(s,{x:s.x-1,y:s.y},!0)&&t(s,{x:s.x-1,y:s.y+o.y},!0)||!t(s,{x:s.x+1,y:s.y},!0)&&t(s,{x:s.x+1,y:s.y+o.y},!0)))return s;n=s,s=e.node({x:s.x+o.x,y:s.y+o.y},!0)}return null}},j.prototype.jps=function(t,e,i={}){if(this.graphs[i.layer||0].TORUS)return console.warn("Torus map aren't yet supported by JPS"),i.callback&&i.callback([],new Map),[];let r=new g((t=>t.estimated)),s=new Map,n=this.graphs[i.layer||0],o=null;t=n.node(t,!0),e=n.node(e,!0),r.add({node:t,estimated:0}),s.set(t,{score:0,from:null});let a=j.JPS.access.bind(this,n),u=j.JPS.neighborhood.bind(this,a,n,s),c=j.JPS.jump.bind(this,a,n,s,e);if(!i.static||n.connected(t,e))for(;r.size;){let t=r.pop().node;if(t===e)break;u(t).map((a=>{if(null!==(o=c(a,t))){let a=(s.has(t)?s.get(t).score:0)+n.cost(t,o);a<(s.has(o)?s.get(o).score:1/0)&&(s.set(o,{score:a,from:t,jumped:!0}),r.set({node:o,estimated:a+h[i.heuristic||this.heuristic](o,e,i.heuristicOptions||this.heuristicOptions)}))}})),r.delete(t)}let l=[];if(s.has(e)){let i=e;for(;i.x!=t.x||i.y!=t.y;)for(let t=s.get(i).from;i.x!=t.x||i.y!=t.y;)l.push(i),i=n.node({x:i.x+b(t.x-i.x),y:i.y+b(t.y-i.y)},!0);l.push(i),l.reverse()}return i.callback&&i.callback(l,s),l},"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope){let a;onmessage=function(b){let c=b.data;switch(c[0]){case"constructor":if("cost"in c[2]){let a=/^\((.*?)\)\s*=>\s*{/.test(c[2].cost),b=/^function /.test(c[2].cost);c[2].cost=eval(`(${a||b?"":"function "}${c[2].cost})`)}a=new j(c[1],c[2]);break;case"path":postMessage(JSON.stringify(["path",a.path(c[1],c[2],c[3])]))}}}a.Lowlight.Astar={Graph:e,Node:f,BinaryHeap:g,Heuristic:h,Configuration:j,WorkerError:i}})("undefined"==typeof window?this:window)},391:(t,e,i)=>{var r=i(180),s=i(181),n=i(31),o=i(67),a=i(833),h=i(717),u=i(801);u.alea=r,u.xor128=s,u.xorwow=n,u.xorshift7=o,u.xor4096=a,u.tychei=h,t.exports=u},180:function(t,e,i){var r;!function(t,s){function n(t){var e,i=this,r=(e=4022871197,function(t){t=String(t);for(var i=0;i<t.length;i++){var r=.02519603282416938*(e+=t.charCodeAt(i));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)});i.next=function(){var t=2091639*i.s0+2.3283064365386963e-10*i.c;return i.s0=i.s1,i.s1=i.s2,i.s2=t-(i.c=0|t)},i.c=1,i.s0=r(" "),i.s1=r(" "),i.s2=r(" "),i.s0-=r(t),i.s0<0&&(i.s0+=1),i.s1-=r(t),i.s1<0&&(i.s1+=1),i.s2-=r(t),i.s2<0&&(i.s2+=1),r=null}function o(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function a(t,e){var i=new n(t),r=e&&e.state,s=i.next;return s.int32=function(){return 4294967296*i.next()|0},s.double=function(){return s()+11102230246251565e-32*(2097152*s()|0)},s.quick=s,r&&("object"==typeof r&&o(r,i),s.state=function(){return o(i,{})}),s}s&&s.exports?s.exports=a:i.amdD&&i.amdO?void 0===(r=function(){return a}.call(e,i,e,s))||(s.exports=r):this.alea=a}(0,t=i.nmd(t),i.amdD)},717:function(t,e,i){var r;!function(t,s){function n(t){var e=this,i="";e.next=function(){var t=e.b,i=e.c,r=e.d,s=e.a;return t=t<<25^t>>>7^i,i=i-r|0,r=r<<24^r>>>8^s,s=s-t|0,e.b=t=t<<20^t>>>12^i,e.c=i=i-r|0,e.d=r<<16^i>>>16^s,e.a=s-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):i+=t;for(var r=0;r<i.length+20;r++)e.b^=0|i.charCodeAt(r),e.next()}function o(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function a(t,e){var i=new n(t),r=e&&e.state,s=function(){return(i.next()>>>0)/4294967296};return s.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=i.next,s.quick=s,r&&("object"==typeof r&&o(r,i),s.state=function(){return o(i,{})}),s}s&&s.exports?s.exports=a:i.amdD&&i.amdO?void 0===(r=function(){return a}.call(e,i,e,s))||(s.exports=r):this.tychei=a}(0,t=i.nmd(t),i.amdD)},181:function(t,e,i){var r;!function(t,s){function n(t){var e=this,i="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:i+=t;for(var r=0;r<i.length+64;r++)e.x^=0|i.charCodeAt(r),e.next()}function o(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function a(t,e){var i=new n(t),r=e&&e.state,s=function(){return(i.next()>>>0)/4294967296};return s.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=i.next,s.quick=s,r&&("object"==typeof r&&o(r,i),s.state=function(){return o(i,{})}),s}s&&s.exports?s.exports=a:i.amdD&&i.amdO?void 0===(r=function(){return a}.call(e,i,e,s))||(s.exports=r):this.xor128=a}(0,t=i.nmd(t),i.amdD)},833:function(t,e,i){var r;!function(t,s){function n(t){var e=this;e.next=function(){var t,i,r=e.w,s=e.X,n=e.i;return e.w=r=r+1640531527|0,i=s[n+34&127],t=s[n=n+1&127],i^=i<<13,t^=t<<17,i^=i>>>15,t^=t>>>12,i=s[n]=i^t,e.i=n,i+(r^r>>>16)|0},function(t,e){var i,r,s,n,o,a=[],h=128;for(e===(0|e)?(r=e,e=null):(e+="\0",r=0,h=Math.max(h,e.length)),s=0,n=-32;n<h;++n)e&&(r^=e.charCodeAt((n+32)%e.length)),0===n&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,n>=0&&(o=o+1640531527|0,s=0==(i=a[127&n]^=r+o)?s+1:0);for(s>=128&&(a[127&(e&&e.length||0)]=-1),s=127,n=512;n>0;--n)r=a[s+34&127],i=a[s=s+1&127],r^=r<<13,i^=i<<17,r^=r>>>15,i^=i>>>12,a[s]=r^i;t.w=o,t.X=a,t.i=s}(e,t)}function o(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function a(t,e){null==t&&(t=+new Date);var i=new n(t),r=e&&e.state,s=function(){return(i.next()>>>0)/4294967296};return s.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=i.next,s.quick=s,r&&(r.X&&o(r,i),s.state=function(){return o(i,{})}),s}s&&s.exports?s.exports=a:i.amdD&&i.amdO?void 0===(r=function(){return a}.call(e,i,e,s))||(s.exports=r):this.xor4096=a}(0,t=i.nmd(t),i.amdD)},67:function(t,e,i){var r;!function(t,s){function n(t){var e=this;e.next=function(){var t,i,r=e.x,s=e.i;return t=r[s],i=(t^=t>>>7)^t<<24,i^=(t=r[s+1&7])^t>>>10,i^=(t=r[s+3&7])^t>>>3,i^=(t=r[s+4&7])^t<<7,t=r[s+7&7],i^=(t^=t<<13)^t<<9,r[s]=i,e.i=s+1&7,i},function(t,e){var i,r=[];if(e===(0|e))r[0]=e;else for(e=""+e,i=0;i<e.length;++i)r[7&i]=r[7&i]<<15^e.charCodeAt(i)+r[i+1&7]<<13;for(;r.length<8;)r.push(0);for(i=0;i<8&&0===r[i];++i);for(8==i?r[7]=-1:r[i],t.x=r,t.i=0,i=256;i>0;--i)t.next()}(e,t)}function o(t,e){return e.x=t.x.slice(),e.i=t.i,e}function a(t,e){null==t&&(t=+new Date);var i=new n(t),r=e&&e.state,s=function(){return(i.next()>>>0)/4294967296};return s.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=i.next,s.quick=s,r&&(r.x&&o(r,i),s.state=function(){return o(i,{})}),s}s&&s.exports?s.exports=a:i.amdD&&i.amdO?void 0===(r=function(){return a}.call(e,i,e,s))||(s.exports=r):this.xorshift7=a}(0,t=i.nmd(t),i.amdD)},31:function(t,e,i){var r;!function(t,s){function n(t){var e=this,i="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:i+=t;for(var r=0;r<i.length+64;r++)e.x^=0|i.charCodeAt(r),r==i.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function o(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function a(t,e){var i=new n(t),r=e&&e.state,s=function(){return(i.next()>>>0)/4294967296};return s.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=i.next,s.quick=s,r&&("object"==typeof r&&o(r,i),s.state=function(){return o(i,{})}),s}s&&s.exports?s.exports=a:i.amdD&&i.amdO?void 0===(r=function(){return a}.call(e,i,e,s))||(s.exports=r):this.xorwow=a}(0,t=i.nmd(t),i.amdD)},801:function(t,e,i){var r;!function(s,n,o){var a,h=256,u=o.pow(h,6),c=o.pow(2,52),l=2*c,d=255;function f(t,e,i){var r=[],d=v(p((e=1==e?{entropy:!0}:e||{}).entropy?[t,x(n)]:null==t?function(){try{var t;return a&&(t=a.randomBytes)?t=t(h):(t=new Uint8Array(h),(s.crypto||s.msCrypto).getRandomValues(t)),x(t)}catch(t){var e=s.navigator,i=e&&e.plugins;return[+new Date,s,i,s.screen,x(n)]}}():t,3),r),f=new g(r),k=function(){for(var t=f.g(6),e=u,i=0;t<c;)t=(t+i)*h,e*=h,i=f.g(1);for(;t>=l;)t/=2,e/=2,i>>>=1;return(t+i)/e};return k.int32=function(){return 0|f.g(4)},k.quick=function(){return f.g(4)/4294967296},k.double=k,v(x(f.S),n),(e.pass||i||function(t,e,i,r){return r&&(r.S&&y(r,f),t.state=function(){return y(f,{})}),i?(o.random=t,e):t})(k,d,"global"in e?e.global:this==o,e.state)}function g(t){var e,i=t.length,r=this,s=0,n=r.i=r.j=0,o=r.S=[];for(i||(t=[i++]);s<h;)o[s]=s++;for(s=0;s<h;s++)o[s]=o[n=d&n+t[s%i]+(e=o[s])],o[n]=e;(r.g=function(t){for(var e,i=0,s=r.i,n=r.j,o=r.S;t--;)e=o[s=d&s+1],i=i*h+o[d&(o[s]=o[n=d&n+e])+(o[n]=e)];return r.i=s,r.j=n,i})(h)}function y(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function p(t,e){var i,r=[],s=typeof t;if(e&&"object"==s)for(i in t)try{r.push(p(t[i],e-1))}catch(t){}return r.length?r:"string"==s?t:t+"\0"}function v(t,e){for(var i,r=t+"",s=0;s<r.length;)e[d&s]=d&(i^=19*e[d&s])+r.charCodeAt(s++);return x(e)}function x(t){return String.fromCharCode.apply(0,t)}if(v(o.random(),n),t.exports){t.exports=f;try{a=i(234)}catch(t){}}else void 0===(r=function(){return f}.call(e,i,e,t))||(t.exports=r)}("undefined"!=typeof self?self:this,[],Math)},234:()=>{}},__webpack_module_cache__={};function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var i=__webpack_module_cache__[t]={id:t,loaded:!1,exports:{}};return __webpack_modules__[t].call(i.exports,i,i.exports,__webpack_require__),i.loaded=!0,i.exports}__webpack_require__.amdD=function(){throw new Error("define cannot be used indirect")},__webpack_require__.amdO={},__webpack_require__.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return __webpack_require__.d(e,{a:e}),e},__webpack_require__.d=(t,e)=>{for(var i in e)__webpack_require__.o(e,i)&&!__webpack_require__.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),__webpack_require__.nmd=t=>(t.paths=[],t.children||(t.children=[]),t);var __webpack_exports__={};(()=>{"use strict";const t=0,e=1,i=2,r=3,s=4,n=5,o=6,a=7,h="PLAYER_AI",u="PLAYER_HUMAN",c="PLAYER_HYBRID_HUMAN_AI",l="AI_LEVEL_RANDOM",d="AI_LEVEL_LOW",f="AI_LEVEL_DEFAULT",g="AI_LEVEL_HIGH",y="AI_LEVEL_ULTRA",p="AI_LEVEL_CUSTOM",v="AI_LEVEL_MOCK",x=15,k=100,m=50,w=0,b=0,P=1,_=2,O=3,S=4,A=5,D=6,M=7,G=38,I=39,T=40,E=37;function L(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function z(t){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},z(t)}function N(t){var e=function(t){if("object"!=z(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,"string");if("object"!=z(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==z(e)?e:e+""}function F(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,N(r.key),r)}}function R(t,e,i){return e&&F(t.prototype,e),i&&F(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}var j=function(){function t(e,i,r){L(this,t),this.x=e,this.y=i,this.direction=r}return R(t,[{key:"copy",value:function(){return new t(this.x,this.y,this.direction)}},{key:"convertToKeyDirection",value:function(){switch(this.direction){case w:return G;case P:return I;case O:return E;case _:return T;default:return this.direction}}},{key:"convertToSimpleDirection",value:function(){switch(this.direction){case G:return w;case I:return P;case E:return O;case T:return _;default:return this.direction}}},{key:"equals",value:function(t){return null!=t&&this.x==t.x&&this.y==t.y}}])}();const C=function(t,e,i){return Math.floor((i?i():Math.random())*(e-t+1))+t};var q=__webpack_require__(391),W=__webpack_require__.n(q),B=__webpack_require__(293),U=function(){return R((function t(e,i,r,s,n,o,a,h,u,c){L(this,t),this.width=null==e?20:e,this.height=null==i?20:i,this.generateWalls=null!=r&&r,this.borderWalls=null!=s&&s,this.maze=null!=n&&n,this.mazeFirstPosition=new j(1,1,P),this.mazeForceAuto=null!=a&&a,this.grid,this.initialGrid,this.fruitPos,this.fruitPosGold,this.customGrid=o,this.seedGrid=h?""+parseInt(h):void 0,this.seedGame=h?""+parseInt(u):void 0,this.rngGrid,this.rngGame,this.probGoldFruitIncrease=null!=c&&c}),[{key:"init",value:function(){if(null!=this.customGrid||null!=this.initialGrid){var e;e=null!=this.initialGrid?this.initialGrid:this.customGrid,this.height=e.length,this.width=e[0].length,this.initialGrid=new Array(this.height),this.grid=new Array(this.height);for(var i=0;i<this.height;i++)this.initialGrid[i]=e[i].slice(),this.grid[i]=e[i].slice()}else{this.grid=new Array(this.height);for(var s=0;s<this.height;s++){this.grid[s]=new Array(this.width);for(var n=0;n<this.width;n++)this.borderWalls&&(0==s||s==this.height-1||0==n||n==this.width-1)||this.generateWalls&&this.rngGrid&&this.rngGrid()>.65||this.maze?this.grid[s][n]=r:this.grid[s][n]=t}this.maze?this.generateMaze():this.generateWalls&&this.fixWalls(this.borderWalls)}this.fruitPosGold=null}},{key:"reset",value:function(){this.grid=void 0,this.initialGrid=void 0,this.fruitPos=void 0,this.fruitPosGold=void 0,this.rngGrid=new(W())(this.seedGrid),this.rngGame=new(W())(this.seedGame)}},{key:"fixWalls",value:function(e){var i,s,n,o;e?(i=1,n=this.height-1,s=1,o=this.width-1):(i=0,n=this.height,s=0,o=this.width);for(var a=i;a<n;a++)for(var h=s;h<o;h++){var u=new j(h,a),c=this.getNextPosition(u,w),l=this.getNextPosition(c,O),d=this.getNextPosition(c,P),f=this.getNextPosition(u,_),g=this.getNextPosition(f,O),y=this.getNextPosition(f,P);this.get(l)!=r&&this.get(d)!=r&&this.get(g)!=r&&this.get(y)!=r||this.set(t,u)}}},{key:"maze_recursion",value:function(e,i){for(var r=function(t,e){for(var i,r,s=t.length-1;s>0;s--)i=Math.floor((e?e():Math.random())*(s+1)),r=t[s],t[s]=t[i],t[i]=r;return t}([w,P,_,O],this.rngGrid),s=0;s<r.length;s++)switch(r[s]){case w:if(e-2<=0)continue;this.get(new j(i,e-2))!=t&&(this.set(t,new j(i,e-2)),this.set(t,new j(i,e-1)),this.maze_recursion(e-2,i));break;case P:if(i+2>=this.width-1)continue;this.get(new j(i+2,e))!=t&&(this.set(t,new j(i+2,e)),this.set(t,new j(i+1,e)),this.maze_recursion(e,i+2));break;case _:if(e+2>=this.height-1)continue;this.get(new j(i,e+2))!=t&&(this.set(t,new j(i,e+2)),this.set(t,new j(i,e+1)),this.maze_recursion(e+2,i));break;case O:if(i-2<=0)continue;this.get(new j(i-2,e))!=t&&(this.set(t,new j(i-2,e)),this.set(t,new j(i-1,e)),this.maze_recursion(e,i-2))}}},{key:"generateMaze",value:function(){this.mazeFirstPosition=new j(1,1,P),this.set(t,this.mazeFirstPosition),this.maze_recursion(1,1)}},{key:"set",value:function(t,e){this.grid[e.y][e.x]=t}},{key:"get",value:function(t){return this.grid[t.y][t.x]}},{key:"valToChar",value:function(a){switch(a){case t:return"-";case e:return"o";case s:return"O";case i:return"x";case r:return"#";case n:return"/";case o:return"X"}}},{key:"getImageCase",value:function(h){switch(this.get(h)){case r:return"wall.png";case i:return"fruit.png";case o:return"fruit_gold.png";case t:case e:case s:case n:case a:return""}return"unknown.png"}},{key:"getGraph",value:function(t){for(var i=new Array(this.height),r=0;r<this.height;r++){i[r]=new Array(this.width);for(var s=0;s<this.width;s++){var n=new j(s,r);t&&this.get(n)==e?i[r][s]=0:this.isDeadPosition(n)?i[r][s]=1:i[r][s]=0}}return i}},{key:"getRandomPosition",value:function(){return new j(C(0,this.width-1,this.rngGame),C(0,this.height-1,this.rngGame))}},{key:"setFruit",value:function(e,r){var s,a,h=[1];if(r||null==this.fruitPos||this.get(this.fruitPos)!=i||this.set(t,this.fruitPos),!(this.getTotal(t)>0))return!!(this.getTotal(t)<=0&&this.fruitPosGold);do{if(s=this.getRandomPosition(),(a=this.detectCorridor(s))&&this.get(s)==t&&this.set(n,s),this.getTotal(t)<=0)return!!this.fruitPosGold}while(this.get(s)!=t||this.isFruitSurrounded(s,!0)||this.maze&&!this.testFruitMaze(s,h)||a);return r?(this.fruitPosGold=s,this.set(o,s)):(this.fruitPos=s,this.set(i,s)),this.maze||null!=this.fruitPosGold||1!=C(1,this.probGoldFruitIncrease?3:e>1?m:k,this.rngGame)||this.setFruit(e,!0),!0}},{key:"testFruitMaze",value:function(e,i){var r=this.getGraph(!0);return new B.Astar.Configuration(r,{order:"yx",torus:!1,diagonals:!1,cutting:!1,cost:function(t,e){return 1==e?null:1}}).path({x:this.mazeFirstPosition.x,y:this.mazeFirstPosition.y},{x:e.x,y:e.y}).length<Math.ceil(this.getTotal(t)/(1*Math.ceil(i[0]/4)))?(i[0]++,!1):(i[0]++,!0)}},{key:"isCaseSurrounded",value:function(e,r,s,h){if(!e)return!1;for(var u=JSON.parse(JSON.stringify(this.grid)),c=[e];c.length>0;){var l=c[0];c.shift();for(var d=[this.getNextPosition(l,w),this.getNextPosition(l,_),this.getNextPosition(l,O),this.getNextPosition(l,P)],f=0;f<d.length;f++)if(u[d[f].y][d[f].x]!=a&&h.indexOf(this.get(d[f]))>-1){if(c.push(d[f]),s.indexOf(this.get(d[f]))>-1)return!1;r&&this.get(d[f])==t?(this.set(n,d[f]),u[d[f].y][d[f].x]=n):u[d[f].y][d[f].x]=a}}return(r&&(this.get(e)==t||this.get(e)==i)||this.get(e)==o)&&this.set(n,e),!0}},{key:"isFruitSurrounded",value:function(i,r){var s=this.isCaseSurrounded(i,!1,[e],[t,e]);return s&&r&&this.isCaseSurrounded(i,!0,[e],[t,e]),s}},{key:"detectCorridor",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.grid?JSON.parse(JSON.stringify(this.grid)):null;if(this.maze||!t||!e)return!1;var i=this.getNextPosition(t,b),r=this.getNextPosition(t,_),s=this.getNextPosition(t,P),n=this.getNextPosition(t,O),o=this.isDeadPosition(i,!0,!0)+this.isDeadPosition(r,!0,!0)+this.isDeadPosition(s,!0,!0)+this.isDeadPosition(n,!0,!0);if(o<=1||this.isDeadPosition(t,!0))return!1;if(o>=3)return!0;e[t.y][t.x]=a;var h=e[i.y][i.x]!=a&&this.detectCorridor(i,e),u=e[r.y][r.x]!=a&&this.detectCorridor(r,e),c=e[n.y][n.x]!=a&&this.detectCorridor(n,e),l=e[s.y][s.x]!=a&&this.detectCorridor(s,e);return!!(u||h||c||l)}},{key:"getOnLine",value:function(t,e){for(var i=0,r=0;r<this.width;r++)this.get(new j(r,e))==t&&i++;return i}},{key:"getTotal",value:function(t){for(var e=0,i=0;i<this.height;i++)e+=this.getOnLine(t,i);return e}},{key:"getNextPosition",value:function(t,e){var i=new j(t.x,t.y,e);switch(e){case O:i.x--,i.direction=O;break;case w:i.y--,i.direction=w;break;case P:i.x++,i.direction=P;break;case _:i.y++,i.direction=_;break;case E:i.x--,i.direction=E;break;case G:i.y--,i.direction=G;break;case I:i.x++,i.direction=P;break;case T:i.y++,i.direction=_}return i.x<0?i.x=this.width-1:i.x>=this.width&&(i.x=0),i.y<0?i.y=this.height-1:i.y>=this.height&&(i.y=0),i}},{key:"getDirectionTo",value:function(t,e){return this.getNextPosition(t,w).equals(e)?w:this.getNextPosition(t,_).equals(e)?_:this.getNextPosition(t,P).equals(e)?P:this.getNextPosition(t,O).equals(e)?O:-1}},{key:"invertDirection",value:function(t){return t==w?_:t==_?w:t==P?O:t==O?P:null}},{key:"isDeadPosition",value:function(t,i,o){return!i&&this.get(t)==e||this.get(t)==r||this.get(t)==s||!!o&&this.get(t)==n}},{key:"toString",value:function(){for(var t="",e=0;e<this.height;e++){for(var i=0;i<this.width;i++)t+=this.valToChar(this.get(new j(i,e)))+" ";t+="\n"}return t}}])}(),K=function(){return R((function t(){L(this,t),this.aiFruitGoal=i,this._aiLevelText="custom"}),[{key:"ai",value:function(t){var e=t.getHeadPosition(),r=t.grid.fruitPos,s=t.grid.fruitPosGold;if(r&&t.grid.get(r)==i){var n=Math.abs(r.x-e.x)+Math.abs(r.y-e.y),a=s?Math.abs(s.x-e.x)+Math.abs(s.y-e.y):-1;s&&t.grid.get(s)==o&&this.aiFruitGoal==i?this.aiFruitGoal=a<=n?o:i:s&&t.grid.get(s)==o||(this.aiFruitGoal=i)}else r&&t.grid.get(r)==i||!s||t.grid.get(s)!=o||(this.aiFruitGoal=o);return null}},{key:"aiLevelText",get:function(){return this._aiLevelText}}])}();function J(t,e){if(e&&("object"==z(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function H(t){return H=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},H(t)}function X(){return X="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,i){var r=function(t,e){for(;!{}.hasOwnProperty.call(t,e)&&null!==(t=H(t)););return t}(t,e);if(r){var s=Object.getOwnPropertyDescriptor(r,e);return s.get?s.get.call(arguments.length<3?t:i):s.value}},X.apply(null,arguments)}function V(t,e){return V=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},V(t,e)}function Y(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&V(t,e)}function $(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return($=function(){return!!t})()}var Q=function(t){function e(){var t,i,r,s;return L(this,e),i=this,r=H(r=e),(t=J(i,$()?Reflect.construct(r,[],H(i).constructor):r.apply(i,s)))._aiLevelText="random",t}return Y(e,t),R(e,[{key:"ai",value:function(t){var i,r;(i=this,"function"==typeof(r=X(H(e.prototype),"ai",i))?function(t){return r.apply(i,t)}:r)([t]);var s=t.getHeadPosition(),n=t.grid.isDeadPosition(t.getNextPosition(s,G)),o=t.grid.isDeadPosition(t.getNextPosition(s,E)),a=t.grid.isDeadPosition(t.getNextPosition(s,T)),h=t.grid.isDeadPosition(t.getNextPosition(s,I));if(n&&o&&a&&h)return G;for(var u=null;null==u||t.grid.isDeadPosition(t.getNextPosition(s,u));)switch(C(1,4,t.grid?t.grid.rngGame:null)){case 1:u=G;break;case 2:u=E;break;case 3:u=T;break;case 4:u=I}return u}}])}(K);function Z(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Z=function(){return!!t})()}var tt=function(t){function e(){var t,i,r,s;return L(this,e),i=this,r=H(r=e),(t=J(i,Z()?Reflect.construct(r,[],H(i).constructor):r.apply(i,s)))._aiLevelText="low",t}return Y(e,t),R(e,[{key:"ai",value:function(t){var i,r,s;if((i=e,r=this,"function"==typeof(s=X(H(1&3?i.prototype:i),"ai",r))?function(t){return s.apply(r,t)}:s)([t]),null!=t.grid.fruitPos){var n=t.getHeadPosition(),a=this.aiFruitGoal==o?t.grid.fruitPosGold:t.grid.fruitPos,h=I;a.x>n.x?h=a.x-n.x>t.grid.width/2?E:I:a.x<n.x?h=n.x-a.x>t.grid.width/2?I:E:a.y<n.y?h=n.y-a.y>t.grid.height/2?T:G:a.y>n.y&&(h=a.y-n.y>t.grid.height/2?G:T);var u=t.getNextPosition(n,h);if(t.grid.isDeadPosition(u)){for(var c=this.direction,l=null,d=1;d<t.queue.length;d++)if(t.get(d).direction!=c){l=t.get(d).direction;break}u=t.getNextPosition(n,l),t.grid.isDeadPosition(u)?t.grid.isDeadPosition(t.getNextPosition(n,G))?t.grid.isDeadPosition(t.getNextPosition(n,I))?t.grid.isDeadPosition(t.getNextPosition(n,T))?t.grid.isDeadPosition(t.getNextPosition(n,E))||(h=E):h=T:h=I:h=G:h=u.convertToKeyDirection()}return h}}}])}(K);function et(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(et=function(){return!!t})()}var it=function(t){function e(t){var i,r,s,n;return L(this,e),r=this,s=H(s=e),(i=J(r,et()?Reflect.construct(s,[],H(r).constructor):s.apply(r,n))).enableTorus=t,i._aiLevelText="normal",i}return Y(e,t),R(e,[{key:"ai",value:function(t){var i,r,s;(i=e,r=this,"function"==typeof(s=X(H(1&3?i.prototype:i),"ai",r))?function(t){return s.apply(r,t)}:s)([t]);var n=t.getHeadPosition(),a=t.grid.fruitPos,h=t.grid.fruitPosGold,u=a;if(n&&(a||h)){var c=t.grid.getGraph(!1),l=new B.Astar.Configuration(c,{order:"yx",torus:!!this.enableTorus,diagonals:!1,cutting:!1,static:!0,cost:function(t,e){return 1==e?null:1}});h&&this.aiFruitGoal==o&&(u=h);var d=l.path({x:n.x,y:n.y},{x:u?u.x:null,y:u?u.y:null});if(d.length<1&&(this.aiFruitGoal!=o&&h||(u=a),d=l.path({x:n.x,y:n.y},{x:u?u.x:null,y:u?u.y:null})),d.length>1){var f=new j(d[1].x,d[1].y);return new j(null,null,t.getDirectionTo(n,f)).convertToKeyDirection()}d=null}return null}}])}(K);function rt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(rt=function(){return!!t})()}var st=function(t){function e(t){var i,r,s,n;return L(this,e),r=this,n=[!0],s=H(s=e),(i=J(r,rt()?Reflect.construct(s,n||[],H(r).constructor):s.apply(r,n))).aiLow=new tt(t),i._aiLevelText="high",i}return Y(e,t),R(e,[{key:"ai",value:function(t){var i,r,s;return(i=e,r=this,"function"==typeof(s=X(H(1&3?i.prototype:i),"ai",r))?function(t){return s.apply(r,t)}:s)([t])||this.aiLow.ai(t)}}])}(it);function nt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(nt=function(){return!!t})()}var ot,at=function(t){function e(){var t,i,r,s;return L(this,e),i=this,r=H(r=e),(t=J(i,nt()?Reflect.construct(r,[],H(i).constructor):r.apply(i,s)))._aiLevelText="mock",t}return Y(e,t),R(e,[{key:"ai",value:function(){return null}}])}(K),ht=function(){function r(t,e,i,s,n,o,a,h){L(this,r),this.direction=null==t?P:t,this.initialDirection=this.direction,this.initialLength=null==e?3:e,this.initTriedDirections=[],this.errorInit=!1,this.grid=i||new U,this.queue=[],this.lastKey=-1,this.lastTail,this.lastTailMoved,this.ticksDead=0,this.player=null==s?u:s,this.aiLevel=null==n?f:n,this.autoRetry=null!=o&&o,this.score=0,this.gameOver=!1,this.scoreMax=!1,this.color,this.name=null==a?"Snake":a,this.snakeAI=new K,this.customAI=h,this.ticksWithoutAction=0,this.initAI()}return R(r,[{key:"init",value:function(){if(this.initialLength<=0)return this.errorInit=!0,!1;this.grid.maze&&this.initTriedDirections.length<=0&&(this.initialDirection=this.grid.mazeFirstPosition.direction,this.direction=this.initialDirection);var e=0,i=0;if(this.initialDirection==P&&-1==this.initTriedDirections.indexOf(P)||this.initialDirection==O&&-1==this.initTriedDirections.indexOf(O)){for(var r=0;r<this.grid.height;r++)for(var s=0,n=0;n<this.grid.width;n++)if(this.grid.get(new j(n,r))==t?s++:s=0,s>=this.initialLength){e++;break}}else if(this.initialDirection==w&&-1==this.initTriedDirections.indexOf(w)||this.initialDirection==_&&-1==this.initTriedDirections.indexOf(_))for(var o=0;o<this.grid.width;o++)for(var a=0,h=0;h<this.grid.height;h++)if(this.grid.get(new j(o,h))==t?a++:a=0,a>=this.initialLength){i++;break}if(this.initTriedDirections.push(this.initialDirection),e<=0&&(this.initialDirection==P||this.initialDirection==O)||i<=0&&(this.initialDirection==w||this.initialDirection==_))return-1==this.initTriedDirections.indexOf(P)?(this.initialDirection=P,this.direction=P,this.init()):-1==this.initTriedDirections.indexOf(O)?(this.initialDirection=O,this.direction=O,this.init()):-1==this.initTriedDirections.indexOf(w)?(this.initialDirection=w,this.direction=w,this.init()):-1==this.initTriedDirections.indexOf(_)?(this.initialDirection=_,this.direction=_,this.init()):(this.errorInit=!0,!1);for(var l,d,f=!0,y=[];f;){if(f=!1,!(l=this.grid.maze?this.grid.mazeFirstPosition:this.grid.getRandomPosition()))return this.errorInit=!0,!1;d=new j(l.x,l.y,this.initialDirection),y=[];for(var p=this.initialLength-1;p>=0;p--)p<this.initialLength-1&&(this.initialDirection==P?d=this.grid.getNextPosition(new j(d.x,d.y,this.initialDirection),P):this.initialDirection==O?d=this.grid.getNextPosition(new j(d.x,d.y,this.initialDirection),O):this.initialDirection==_?d=this.grid.getNextPosition(new j(d.x,d.y,this.initialDirection),_):this.initialDirection==w&&(d=this.grid.getNextPosition(new j(d.x,d.y,this.initialDirection),w))),this.grid.get(d)!=t?f=!0:y.push(new j(d.x,d.y,d.direction));if(this.grid.maze&&f)return this.init()}var v=!1;if(!this.grid.maze){var x=new j(y[y.length-1].x,y[y.length-1].y,this.direction);(this.grid.isDeadPosition(this.grid.getNextPosition(x,w),!1)&&this.direction==w||this.grid.isDeadPosition(this.grid.getNextPosition(x,_),!1)&&this.direction==_||this.grid.isDeadPosition(this.grid.getNextPosition(x,O),!1)&&this.direction==O||this.grid.isDeadPosition(this.grid.getNextPosition(x,P),!1)&&this.direction==P)&&(v=!0,this.direction=this.grid.invertDirection(this.direction))}for(var k=0;k<y.length;k++)if(v){var m=y[y.length-k-1];m.direction=this.grid.invertDirection(m.direction),this.insert(y[y.length-k-1])}else this.insert(y[k]);return this.grid.maze&&this.player==c&&(this.player=u),this.player==c&&(this.aiLevel=g),this.lastTail=this.get(this.queue.length-1),!0}},{key:"initAI",value:function(){if(this.customAI)this.snakeAI=this.customAI,this.aiLevel=p;else switch(this.aiLevel){case l:this.snakeAI=new Q;break;case d:this.snakeAI=new tt;break;case f:this.snakeAI=new it;break;case g:case y:this.snakeAI=new st;break;case v:this.snakeAI=new at;break;default:this.snakeAI=new it}}},{key:"reset",value:function(){this.direction=this.initialDirection,this.initTriedDirections=[],this.errorInit=!1,this.queue=[],this.score=0,this.gameOver=!1,this.scoreMax=!1,this.lastTailMoved=!0,this.lastTail=void 0,this.lastKey=-1,this.ticksDead=0,this.ticksWithoutAction=0,this.snakeAI&&(this.snakeAI.aiFruitGoal=i)}},{key:"insert",value:function(t){this.queue.unshift(t),this.grid.set(e,t)}},{key:"remove",value:function(){var e=this.queue.pop();this.grid.set(t,e),this.lastTail=e}},{key:"length",value:function(){return this.queue.length}},{key:"get",value:function(t){return null!=this.queue[t]?this.queue[t].copy():null}},{key:"set",value:function(t,e){t>=0&&t<this.length()&&(this.queue[t]=e)}},{key:"getHeadPosition",value:function(){return this.get(0)}},{key:"getTailPosition",value:function(){return this.get(this.length()-1)}},{key:"hasMaxScore",value:function(){return this.grid.getTotal(t)<=0&&!this.grid.fruitPosGold&&!this.grid.fruitPos}},{key:"setGameOver",value:function(t){this.gameOver=!0,this.ticksDead=t;for(var e=0;e<this.length();e++)this.grid.set(s,this.get(e))}},{key:"kill",value:function(){this.autoRetry=!1,this.grid=null,this.queue=null}},{key:"keyToDirection",value:function(t){return t==E&&this.direction!=P&&this.direction!=O?O:t==G&&this.direction!=_&&this.direction!=w?w:t==I&&this.direction!=O&&this.direction!=P?P:t==T&&this.direction!=w&&this.direction!=_?_:null}},{key:"moveTo",value:function(t){var e=this.keyToDirection(t);null!=e&&(this.direction=e)}},{key:"getNextPosition",value:function(t,e){return this.grid.getNextPosition(t,e)}},{key:"getDirectionTo",value:function(t,e){return this.grid.getDirectionTo(t,e)}},{key:"getGraphicDirectionFor",value:function(t,e,i){if(null==e||null==i)return t.direction;var r=this.getDirectionTo(t,i),s=this.getDirectionTo(t,e);return r==O&&s==_||r==_&&s==O?S:r==P&&s==_||r==_&&s==P?A:r==w&&s==P||r==P&&s==w?D:r==w&&s==O||r==O&&s==w?M:t.direction}},{key:"getGraphicDirection",value:function(t){return this.getGraphicDirectionFor(this.get(t),this.get(t-1),this.get(t+1))}},{key:"copy",value:function(){for(var t=new r(this.direction,3,new U(this.grid.width,this.grid.height,!1,!1),this.player,this.aiLevel,!1),e=0;e<t.grid.height;e++)for(var i=0;i<t.grid.width;i++)t.grid.set(this.grid.get(new j(i,e)),new j(i,e));t.queue=[];for(var s=0;s<this.queue.length;s++)t.queue.push(JSON.parse(JSON.stringify(this.queue[s])));return t}},{key:"ai",value:function(){if(this.snakeAI&&this.snakeAI.ai){var t=this.snakeAI.ai(this);return t&&this.keyToDirection(t)!=this.direction?this.ticksWithoutAction=0:this.ticksWithoutAction++,t}return null}},{key:"isAIStuck",value:function(t,e){if(this.snakeAI&&this.snakeAI.ai){if((this.direction==O||this.direction==P)&&this.ticksWithoutAction>=this.grid.width*t)return!0;if((this.direction==w||this.direction==_)&&this.ticksWithoutAction>=this.grid.height*e)return!0}return!1}},{key:"getAILevelText",value:function(){return this.snakeAI?this.snakeAI.aiLevelText:"???"}}])}(),ut=function(){return R((function t(e){L(this,t),this.name=e,this.callbacks=[]}),[{key:"registerCallback",value:function(t){this.callbacks.push(t)}}])}(),ct=function(){return R((function t(){L(this,t),this.events={}}),[{key:"registerEvent",value:function(t){this.events[t]=new ut(t)}},{key:"dispatchEvent",value:function(t,e){for(var i=this.events[t].callbacks,r=0,s=i.length;r<s;r++)i[r](e)}},{key:"addEventListener",value:function(t,e){this.events[t].registerCallback(e)}}])}(),lt=function(){return R((function t(e,i,r,s,n,o,a){L(this,t),this.grid=e,this.snakes=i,this.speed=null==r?8:r,this.initialSpeed=null==r?8:r,this.initialSpeedUntouched=null==r?8:r,this.enablePause=null==s||s,this.enableRetry=null==n||n,this.progressiveSpeed=null!=o&&o,this.aiStuckLimit=null==a?3:a,this.countBeforePlay=3,this.lastKey=-1,this.numFruit=1,this.ticks=0,this.firstStart=!0,this.starting=!1,this.paused=!0,this.exited=!1,this.killed=!1,this.isReseted=!0,this.gameOver=!1,this.gameFinished=!1,this.gameMazeWin=!1,this.scoreMax=!1,this.errorOccurred=!1,this.clientSidePredictionsMode=!1,this.aiStuck=!1,this.intervalPlay,this.reactor=new ct,this.reactor.registerEvent("onStart"),this.reactor.registerEvent("onPause"),this.reactor.registerEvent("onContinue"),this.reactor.registerEvent("onReset"),this.reactor.registerEvent("onStop"),this.reactor.registerEvent("onExit"),this.reactor.registerEvent("onKill"),this.reactor.registerEvent("onScoreIncreased"),this.reactor.registerEvent("onUpdate"),this.reactor.registerEvent("onUpdateCounter")}),[{key:"init",value:function(){if(!this.clientSidePredictionsMode)if(null==this.snakes?(this.errorOccurred=!0,this.snakes=[]):Array.isArray(this.snakes)?(Array.isArray(this.snakes)&&this.snakes.length<=0||this.grid.maze&&this.snakes.length>1)&&(this.errorOccurred=!0):this.snakes=[this.snakes],this.grid instanceof U==0)this.errorOccurred=!0;else if(!this.errorOccurred){this.initGridAndSnakes();for(var t=C(0,360,this.grid?new(W())(this.grid.seedGame):null),e=0;e<this.snakes.length;e++)this.snakes[e]instanceof ht==0?this.errorOccurred=!0:(i=t,r=Math.round(360/this.snakes.length),s=void 0,t=(s=i+r)>360?s-360:s<0?360+s:s,this.snakes[e].color=t)}var i,r,s}},{key:"initGridAndSnakes",value:function(){if(this.grid.reset(),this.grid.init(),null!=this.snakes){for(var t=0;t<this.snakes.length;t++)this.snakes[t].reset();for(var e=0;e<this.snakes.length;e++)this.snakes[e].init()}this.grid.setFruit(this.snakes.length)}},{key:"reset",value:function(){this.paused=!0,this.isReseted=!0,this.exited=!1,this.clearIntervalPlay(),this.numFruit=1,this.ticks=0,this.lastKey=-1,this.scoreMax=!1,this.errorOccurred=!1,this.gameOver=!1,this.gameFinished=!1,this.gameMazeWin=!1,this.starting=!1,this.initialSpeed=this.initialSpeedUntouched,this.speed=this.initialSpeedUntouched,this.aiStuck=!1,this.grid.seedGrid&&(this.grid.seedGrid=""+(parseInt(this.grid.seedGrid)+1)),this.grid.seedGame&&(this.grid.seedGame=""+(parseInt(this.grid.seedGame)+1)),this.initGridAndSnakes(),this.reactor.dispatchEvent("onReset"),this.start()}},{key:"start",value:function(){var t=this;if(this.reactor.dispatchEvent("onUpdateCounter"),!this.errorOccurred){if(null!=this.snakes)for(var e=0;e<this.snakes.length;e++)this.snakes[e].errorInit&&(this.errorOccurred=!0,this.stop());!this.paused||this.gameOver||this.killed||this.scoreMax||this.starting||(this.starting=!0,this.firstStart||this.reactor.dispatchEvent("onContinue"),this.countBeforePlay=3,this.clearIntervalPlay(),this.reactor.dispatchEvent("onUpdateCounter"),this.intervalPlay=setInterval((function(){t.countBeforePlay--,t.reactor.dispatchEvent("onUpdateCounter"),t.countBeforePlay<0&&t.forceStart()}),1e3))}}},{key:"forceStart",value:function(){this.clearIntervalPlay(),this.countBeforePlay=-1,this.paused=!1,this.isReseted=!1,this.firstStart=!1,this.starting=!1,this.reactor.dispatchEvent("onStart"),this.tick()}},{key:"clearIntervalPlay",value:function(){clearInterval(this.intervalPlay)}},{key:"continue",value:function(){this.clientSidePredictionsMode||(this.start(),this.reactor.dispatchEvent("onContinue"))}},{key:"stop",value:function(t){this.gameOver||this.clientSidePredictionsMode||(this.paused=!0,this.gameOver=!0,t&&(this.gameFinished=!0),this.clearIntervalPlay(),this.reactor.dispatchEvent("onStop"))}},{key:"pause",value:function(){this.paused||this.clientSidePredictionsMode||(this.paused=!0,this.clearIntervalPlay(),this.reactor.dispatchEvent("onPause"))}},{key:"kill",value:function(){if(!this.killed){if(this.paused=!0,this.gameOver=!0,this.killed=!0,null!=this.snakes)for(var t=0;t<this.snakes.length;t++)this.snakes[t].kill(),this.snakes[t]=null;this.clearIntervalPlay(),this.grid=null,this.snakes=null,this.reactor.dispatchEvent("onKill")}}},{key:"exit",value:function(){this.exited||(this.stop(),this.exited=!0,this.reactor.dispatchEvent("onExit"))}},{key:"destroySnakes",value:function(t,e){for(var i=0;i<this.snakes.length;i++)t&&Array.isArray(t)&&t.indexOf(i)<0&&e.indexOf(this.snakes[i].player)>-1&&this.snakes[i].setGameOver(this.ticks)}},{key:"getNBPlayer",value:function(t){var e=0;if(null!=this.snakes)for(var i=0;i<this.snakes.length;i++)this.snakes[i].player==t&&e++;return e}},{key:"getPlayer",value:function(t,e){var i=0;if(null!=this.snakes)for(var r=0;r<this.snakes.length;r++)if(this.snakes[r].player==e&&i++,i==t)return this.snakes[r];return null}},{key:"tick",value:function(){var t=this;setTimeout((function(){t.doTick()}),this.initialSpeed*x)}},{key:"doTick",value:function(){if(!this.paused&&!this.killed){this.ticks++;var e,r=!1;if(this.grid&&(!this.grid.maze||this.grid.mazeForceAuto||this.grid.maze&&this.getNBPlayer(u)<=0&&this.getNBPlayer(c)<=0||this.grid.maze&&(this.getNBPlayer(u)>0||this.getNBPlayer(c)>0)&&-1!=(this.getPlayer(1,c)||this.getPlayer(1,u)).lastKey)){for(var s=0;s<this.snakes.length;s++){var n=this.snakes[s].direction,a=!1,d=!1;if(r=!1,this.snakes[s].lastTailMoved=!1,!this.snakes[s].gameOver&&!this.snakes[s].scoreMax){this.snakes[s].player==u||this.snakes[s].player==c?(this.snakes[s].moveTo(this.snakes[s].lastKey),this.snakes[s].lastKey=-1):this.snakes[s].player==h&&(!this.clientSidePredictionsMode||this.clientSidePredictionsMode&&this.snakes[s].aiLevel!=l)&&this.snakes[s].moveTo(this.snakes[s].ai());var f=this.snakes[s].getHeadPosition();this.snakes[s].player==c&&this.grid.isDeadPosition(this.snakes[s].getNextPosition(f,this.snakes[s].direction))&&(this.snakes[s].direction=n,this.snakes[s].moveTo(this.snakes[s].ai()),this.snakes[s].lastKey=-1),f=this.snakes[s].getNextPosition(f,this.snakes[s].direction),this.grid.isDeadPosition(f)?this.snakes[s].setGameOver(this.ticks):this.grid.get(f)==i||this.grid.get(f)==o?(this.grid.get(f)==i?(this.snakes[s].score++,this.grid.set(t,this.grid.fruitPos),this.grid.fruitPos=null):this.grid.get(f)==o&&(this.snakes[s].score+=3,this.grid.set(t,this.grid.fruitPosGold),this.grid.fruitPosGold=null,d=!0),e=!0,this.snakes[s].insert(f),this.grid.maze?(this.gameMazeWin=!0,this.gameFinished=!0,this.stop()):this.snakes[s].hasMaxScore()&&this.snakes.length<=1?(this.scoreMax=!0,this.snakes[s].scoreMax=!0,this.stop()):(this.numFruit++,d||(a=!0)),this.snakes.length<=1&&this.progressiveSpeed&&this.snakes[s].score>0&&this.initialSpeed>1&&(this.initialSpeed=Math.ceil(-this.initialSpeedUntouched/100*this.snakes[s].score+this.initialSpeedUntouched),this.initialSpeed=this.initialSpeed<1?1:this.initialSpeed)):(this.snakes[s].insert(f),this.grid.maze||(this.snakes[s].remove(),this.snakes[s].lastTailMoved=!0))}this.scoreMax||!a||this.clientSidePredictionsMode||(r=!this.grid.setFruit(this.snakes.length))}this.scoreMax||r||!this.grid.detectCorridor(this.grid.fruitPos)&&!this.grid.isFruitSurrounded(this.grid.fruitPos,!0)||this.clientSidePredictionsMode||(r=!this.grid.setFruit(this.snakes.length)),this.scoreMax||null==this.grid.fruitPosGold||!this.grid.detectCorridor(this.grid.fruitPosGold)&&!this.grid.isFruitSurrounded(this.grid.fruitPosGold,!0)||(this.grid.set(t,this.grid.fruitPosGold),this.grid.fruitPosGold=null);for(var g=0,y=0;y<this.snakes.length;y++)(this.snakes[y].gameOver||this.snakes[y].scoreMax)&&g++;for(var p=!1,v=0;v<this.snakes.length;v++)if(!this.snakes[v].gameOver&&this.snakes[v].isAIStuck(1,1))this.aiStuck=!0,p=!!this.snakes[v].isAIStuck(this.aiStuckLimit,this.aiStuckLimit);else if((this.snakes[v].player==u||this.snakes[v].player==c)&&!this.snakes[v].gameOver||this.snakes[v].player==h&&!this.snakes[v].gameOver){this.aiStuck=!1,p=!1;break}(g>=this.snakes.length||r||p)&&(this.stop(),this.snakes.length>1&&(this.gameFinished=!0)),this.reactor.dispatchEvent("onUpdate"),e&&this.reactor.dispatchEvent("onScoreIncreased")}this.tick()}}},{key:"onReset",value:function(t){this.reactor.addEventListener("onReset",t)}},{key:"onStart",value:function(t){this.reactor.addEventListener("onStart",t)}},{key:"onContinue",value:function(t){this.reactor.addEventListener("onContinue",t)}},{key:"onStop",value:function(t){this.reactor.addEventListener("onStop",t)}},{key:"onPause",value:function(t){this.reactor.addEventListener("onPause",t)}},{key:"onExit",value:function(t){this.reactor.addEventListener("onExit",t)}},{key:"onKill",value:function(t){this.reactor.addEventListener("onKill",t)}},{key:"onScoreIncreased",value:function(t){this.reactor.addEventListener("onScoreIncreased",t)}},{key:"onUpdate",value:function(t){this.reactor.addEventListener("onUpdate",t)}},{key:"onUpdateCounter",value:function(t){this.reactor.addEventListener("onUpdateCounter",t)}}])}();function dt(t){var e=JSON.parse(JSON.stringify(t));if(e)for(var i=0;i<e.length;i++)delete e[i].grid,t[i].snakeAI&&t[i].snakeAI.aiLevelText&&(e[i].snakeAI.aiLevelText=t[i].snakeAI.aiLevelText);return e}function ft(t){var e=JSON.parse(JSON.stringify(t));return e&&(e.rngGrid=null,e.rngGame=null),e}function gt(t,e){ot&&(e=null!=e?e:ot.grid),e=Object.assign(new U,e),!t&&ot&&(t=ot.snakes);for(var i=0;i<t.length;i++){t[i].grid=e,t[i]=Object.assign(new ht,t[i]);for(var r=0;r<t[i].queue.length;r++)t[i].queue[r]=Object.assign(new j,t[i].queue[r]);t[i].initAI()}return{grid:e,snakes:t}}onmessage=function(t){var e=t.data;if(e.length>1&&"init"==e[0]){var i=gt(e[1].snakes,e[1].grid),r=i.grid,s=i.snakes;(ot=new lt(r,s,e[1].speed,e[1].enablePause,e[1].enableRetry,e[1].progressiveSpeed)).init(),self.postMessage(["init",{snakes:dt(ot.snakes),grid:ft(ot.grid),enablePause:ot.enablePause,enableRetry:ot.enableRetry,progressiveSpeed:ot.progressiveSpeed,offsetFrame:ot.speed*x,errorOccurred:ot.errorOccurred}]),ot.onReset((function(){self.postMessage(["reset",{paused:ot.paused,isReseted:ot.isReseted,exited:ot.exited,snakes:dt(ot.snakes),grid:ft(ot.grid),numFruit:ot.numFruit,ticks:ot.ticks,scoreMax:ot.scoreMax,gameOver:ot.gameOver,gameFinished:ot.gameFinished,gameMazeWin:ot.gameMazeWin,starting:ot.starting,initialSpeed:ot.initialSpeed,speed:ot.speed,offsetFrame:ot.speed*x,confirmReset:!1,confirmExit:!1,getInfos:!1,getInfosGame:!1,errorOccurred:ot.errorOccurred,aiStuck:ot.aiStuck,precAiStuck:!1}])})),ot.onStart((function(){self.postMessage(["start",{snakes:dt(ot.snakes),grid:ft(ot.grid),starting:ot.starting,countBeforePlay:ot.countBeforePlay,paused:ot.paused,isReseted:ot.isReseted,confirmReset:!1,confirmExit:!1,getInfos:!1,getInfosGame:!1,errorOccurred:ot.errorOccurred}])})),ot.onPause((function(){self.postMessage(["pause",{paused:ot.paused,confirmReset:!1,confirmExit:!1,getInfos:!1,getInfosGame:!1,errorOccurred:ot.errorOccurred}])})),ot.onContinue((function(){self.postMessage(["continue",{confirmReset:!1,confirmExit:!1,getInfos:!1,getInfosGame:!1,errorOccurred:ot.errorOccurred}])})),ot.onStop((function(){self.postMessage(["stop",{paused:ot.paused,scoreMax:ot.scoreMax,gameOver:ot.gameOver,gameFinished:ot.gameFinished,confirmReset:!1,confirmExit:!1,getInfos:!1,getInfosGame:!1,errorOccurred:ot.errorOccurred}])})),ot.onExit((function(){self.postMessage(["exit",{paused:ot.paused,gameOver:ot.gameOver,gameFinished:ot.gameFinished,exited:ot.exited,confirmReset:!1,confirmExit:!1,getInfos:!1,getInfosGame:!1,errorOccurred:ot.errorOccurred}])})),ot.onKill((function(){self.postMessage(["kill",{paused:ot.paused,gameOver:ot.gameOver,killed:ot.killed,snakes:dt(ot.snakes),grid:ft(ot.grid),gameFinished:ot.gameFinished,confirmReset:!1,confirmExit:!1,getInfos:!1,getInfosGame:!1,errorOccurred:ot.errorOccurred}])})),ot.onScoreIncreased((function(){self.postMessage(["scoreIncreased",{}])})),ot.onUpdate((function(){self.postMessage(["update",{paused:ot.paused,isReseted:ot.isReseted,exited:ot.exited,snakes:dt(ot.snakes),grid:ft(ot.grid),numFruit:ot.numFruit,ticks:ot.ticks,scoreMax:ot.scoreMax,gameOver:ot.gameOver,gameFinished:ot.gameFinished,gameMazeWin:ot.gameMazeWin,starting:ot.starting,initialSpeed:ot.initialSpeed,speed:ot.speed,countBeforePlay:ot.countBeforePlay,offsetFrame:0,errorOccurred:ot.errorOccurred,aiStuck:ot.aiStuck}])})),ot.onUpdateCounter((function(){self.postMessage(["updateCounter",{paused:ot.paused,isReseted:ot.isReseted,exited:ot.exited,snakes:dt(ot.snakes),grid:ft(ot.grid),numFruit:ot.numFruit,ticks:ot.ticks,scoreMax:ot.scoreMax,gameOver:ot.gameOver,gameFinished:ot.gameFinished,gameMazeWin:ot.gameMazeWin,starting:ot.starting,initialSpeed:ot.initialSpeed,speed:ot.speed,countBeforePlay:ot.countBeforePlay,errorOccurred:ot.errorOccurred}])}))}else if(null!=ot)switch(e[0]){case"reset":ot.reset();break;case"start":ot.start();break;case"stop":ot.stop(!1);break;case"finish":ot.stop(!0);break;case"pause":ot.pause();break;case"kill":ot.kill();break;case"tick":ot.paused=!1,ot.countBeforePlay=-1,ot.tick();break;case"ping":self.postMessage("pong");break;case"exit":ot.exit();break;case"forceStart":ot.forceStart();break;case"key":if(e.length>1){ot.lastKey=e[1];var n=ot.getPlayer(1,u)||ot.getPlayer(1,c);null!=n&&null!=n.lastKey&&(n.lastKey=e[1])}break;case"update":if(e.length>1)if("snakes"==e[1].key){var o=gt(e[1].data);o&&(ot.snakes=o.snakes)}else if("grid"==e[1].key){var a=gt(null,e[1].data);a&&(ot.grid=a.grid)}else ot[e[1].key]=e[1].data;break;case"destroySnakes":e[1]&&e[2]&&ot.destroySnakes(e[1],e[2])}else"ping"==e&&self.postMessage("pong")},self.postMessage("ready")})()})();