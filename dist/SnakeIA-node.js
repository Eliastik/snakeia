!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.SnakeIA=e():t.SnakeIA=e()}("undefined"!=typeof self?self:this,(function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=25)}([function(t,e,i){"undefined"!=typeof self&&self,t.exports=function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=14)}([function(t,e){function i(e){return t.exports=i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},i(e)}t.exports=i},function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e){function i(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}t.exports=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}},function(t,e){t.exports=function(t,e){var i=e.get(t);if(!i)throw new TypeError("attempted to get private field on non-instance");return i.get?i.get.call(t):i.value}},function(t,e,i){var n=i(10);function r(e,i,o){return"undefined"!=typeof Reflect&&Reflect.get?t.exports=r=Reflect.get:t.exports=r=function(t,e,i){var r=n(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(i):o.value}},r(e,i,o||e)}t.exports=r},function(t,e,i){var n=i(12);t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&n(t,e)}},function(t,e,i){var n=i(13),r=i(8);t.exports=function(t,e){return!e||"object"!==n(e)&&"function"!=typeof e?r(t):e}},function(t,e){t.exports=function(t,e,i){var n=e.get(t);if(!n)throw new TypeError("attempted to set private field on non-instance");if(n.set)n.set.call(t,i);else{if(!n.writable)throw new TypeError("attempted to set read only private field");n.value=i}return i}},function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},function(t,e,i){var n=i(10),r=i(11);function o(t,e,i,s){return(o="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(t,e,i,o){var s,a=n(t,e);if(a){if((s=Object.getOwnPropertyDescriptor(a,e)).set)return s.set.call(o,i),!0;if(!s.writable)return!1}if(s=Object.getOwnPropertyDescriptor(o,e)){if(!s.writable)return!1;s.value=i,Object.defineProperty(o,e,s)}else r(o,e,i);return!0})(t,e,i,s)}t.exports=function(t,e,i,n,r){if(!o(t,e,i,n||t)&&r)throw new Error("failed to set property");return i}},function(t,e,i){var n=i(0);t.exports=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=n(t)););return t}},function(t,e){t.exports=function(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}},function(t,e){function i(e,n){return t.exports=i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},i(e,n)}t.exports=i},function(t,e){function i(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?t.exports=i=function(t){return typeof t}:t.exports=i=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(e)}t.exports=i},function(t,e,i){"use strict";i.r(e),i.d(e,"Constants",(function(){return n})),i.d(e,"Button",(function(){return w})),i.d(e,"ButtonImage",(function(){return T})),i.d(e,"ImageLoader",(function(){return b})),i.d(e,"NotificationMessage",(function(){return A})),i.d(e,"Utils",(function(){return m})),i.d(e,"Menu",(function(){return L})),i.d(e,"Input",(function(){return I})),i.d(e,"Label",(function(){return M})),i.d(e,"Link",(function(){return F})),i.d(e,"Tooltip",(function(){return N})),i.d(e,"Scene",(function(){return U})),i.d(e,"FPSMeter",(function(){return _})),i.d(e,"ProgressBar",(function(){return j})),i.d(e,"Canvas",(function(){return z})),i.d(e,"Component",(function(){return x})),i.d(e,"EasingFunctions",(function(){return Y}));var n={Setting:{FONT_FAMILY:"sans-serif",FONT_SIZE:32,CLOSE_ICON:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAMAAADDpiTIAAAAqFBMVEUAAAD5+fn////////////09PT////+/v78/Pz7+/vu7u7////////////////4+Pj////+/v7////8/Pz////9/f3////////+/v79/f3+/v79/f339/f+/v7+/v78/Pz////+/v78/Pz7+/v+/v7+/v7+/v76+vr////+/v78/Pz5+fn////9/f3+/v79/f39/f3+/v7+/v7+/v79/f3+/v79/f3////yrZrxAAAAN3RSTlMAAvz05wntcyYZBb3h1McP3JTMLMJa+LSqMaVEDKCPItiuOh6CfngTuWQ1FtFUmWBPi4ZpSm1AuDPJ8gAAEYVJREFUeNrs1d1uEkEYBuDdthbLjwJakBaKtrQpNgqoZO7/zpxdMHJAw5L0ZIfnCQnZgYN53/1mNwMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA3kCeZxv/vxNWpp3ezme9n6vZevn9KvnEFYzv578m34at4ZfJ049plrjRrHUR/hm0n1f3zZOdgbzoo/H5MuwYdO5um2kWEjN9XPRD4Wz7KXVn79MMXMH186CoY1e87jfG6TUS8zTX7TJs2FFenvce0gtcoZBFpzwMu7YLF0/vEiskprlu74u7WRs8phb4cB+fWjH3WdijOBSdZUpnIiaZDstg+8X1/km9B2LS9eYl+HojNy9ZnkgjRdzBNu7rkeenMwF5lt8c7CN0R8k0Mj4Ut/x5lkzeg/f/4UOIDjaySOIZkGejbqhkchoTkGcvX8NZpQlo1L+RuP/lZcxSSS87AXl21alWSPzTXf0nIPtdJKloVv+4FU5EK1S3qvcExL0/hmP8qXXcanrhGL06T0Dc+Soc5fwve+eiljYQROFzFqRWLkVFwGotQkVFLGit8/5v1jb9/Eo/bySZJLOb/d+AzOywlzNnQr8LJ27lN/WoAQTOJCXn3v7arSAum5IKv/cBZ5KaW39/7VbciZNUeHs+Zqb4S28PIbPbkPTc+5kByf9/LAGbMOM3mfuXAcwafxl591tTsNORjBngH/eSjcYuwuVWMnINryDwTbLyA+GyLy5rBnhWGOeSESefESynPcnMLbyBwAfJzsElQuXpDBD87vin5KAV7m3gVPJw4kcGELiWXEwRKiupQwbgSPLxgDAhPkgu3MKDDCDWQ8nHEcKEuMgXf2nYzwDiQcRJLlYIE+Kb5MJJa9d4BhAnDXGxArwIMZd8OOnYzgBiOhQncQ/wIsRPyZ8BHw1nALH4q/+LpwDNm+BNnExmZjOAOGxIflrhPgZMRSEDlqdGM4DY7YgCkxuEytemRgb0PpnMAGKmEX8nYwTLzkA0aFuUBxCXz+Tu9Xn73pY7UWG0Zy4DiNOuqODC3QMCa9Hhs7UaQHAgTjToGvtpquz1RYfvMAWBgShxEXAC8I2uEJ/bBQicv77+Y2vIM0WAzkIxQxJ/HVzwDaJfRAdDrcMEvosTHYZhF4CXSoDv4kkm7Y5xB7AdxL2ocWShBiQCYDWWpwidnaWosUblJA3gehwbSOliIRaiRuPEgInMtejxIfj4Pz0KKzGcVvzFiJVIPAGk5EzvkzUPK86AB9GjjVpAYKyYAVXKA6gYfycD1uAP4C87I73P1r1M9dnM7mekWx+3WGKvLUq46j4csWjo/YylTZVDMRCfBt6XTmK3JU6UmFzWKP4An7Qh/gpEEgGYUytjN7WKf6Kf6enVgHH5GUB8nOit/75lrXMxcMtecaMuu4nfqd76r1/8kxqgtw8o20uO2OnF9W9qH3BX5qUwcdrWW//Luv3/b5wF2uKjPIDASLSo3/7vv/uAK1Hj53vf0eZV5kG9zn/PSunmUvKjqZaasiY5sNrn9DYG1XTbuAjZe8xq1+f+99Wd4GdR443HYZsCIJM9Tu9jtqAOy3AQ+eD1BZY9NDWVZTiI/BAtYvw3bNXV5AGvZoARB7BQhqFoQihKhfsFnqoJrF2M/z9MKmsLvVc7ETUuYvz/Yy5a9IrqHSemLXmBuoxAKBJCUSt8VczZmjjUi3+NBgVXoK8/L+LrErO+aLGK4X9pwL7TkweoQ1wqxd+FawRYvYtcYTtsYudA7QHYF9Pr8nloiBL3UIWgWvwbx4i8arQ7NHnKInClFf9m+P2feZg2xakJRAB7ApDO1xj/NyCOW4r+EdR7r3KiQjfG/121fV+cKYFI4gCjQ73lP6Uft4dr0NY99aC+8r/tIW50NtxO5bzFZM5JsAanFiE+LUUDJ60paEcAMK67/CuFWFjBdlVnyBBx7W33kr8QaIvYcBBZm72cDBlF5X3zK2jBAeQ+xj/t0bv6xjti4eLzfzUQuNPKgKxnb+K44V/fWiikFQrqDxkiZk0JytTWL6inwF/ugdlGAKngTFja+odaBrgsDTjEp65ax1okE9RT4V8BTBv/nqjQiPKf7BBH1TRhEWyLCsNHRHIq8Z1OG1a6+J+LCs2QR4CVAfE41KkB3wGWfgvRivKf/By2yr+L3Zc/hD7r3A+Iw6bebWypDgAdu3OufSKRiJSZAZhH9z9TELNlaTeyVBMAdOvk/qyAwqFcZyTLSmf99+rt/vSENUfB1RYOALZ7lOsJwVE5bZknOlKkq3j9rwuxNy5+1ByxaIkGoxj/DYxJRNbgmyMgQpxuHwJ6bmKPr1vA92P87aLnJXUCvrzT7IuL8k/TfCvOUZQ41WlIOYvxLwoCc52WoUfw+S7zQJy1vvTIM37oZMACLMYBYG5gmnHAEFg5jQwYTsFnDgCWetIjBTsJNQ7B/zvAnUb8Y/jfxJKT0IZWg8C+JUeCSAonIR1n8Qud+Mf1/z6GLFufGkepcraI7n9bYWpq89Po+ZVO/OP6Lw3isCMKdHZBJem5i/LfMiF2myoZ8BE40ZH/x/VfKsRsIk6jefzYqRwqY/xLJnm6U2DS0ThQLGL8S4e4WYoTCzSj/F+FLP27FmjG+l8NxGnPQA3ozBCphuQJt2r6sf5XB8F2xTVgEtt/qoTAQKqkG9v/qoXAKEMNiO7fwZBIeariINb/6iEwTl0DYvtfQBA4lyoYxPpvg3RNQ9YHlEY8yYBRrP92SCfqi+2f4ZHIesvkPNZ/WxA4k3exPZ46kpN9KYtxtP8wyZ2Uwziuf6OcSRmMf7F3J1ppBEEUQN9rCBoEVMQVRdxN1LjG9/9/lpM5xkMSghpqunuYul/Aoat7GqYW+vrn6kFv8PYPC26ksu35/s/ag37n+79uRprg619DD3rl619LI5VlD64K7vXKf//X0jeVYcdXvzLWJfn+r7MDWTtqw1VIEQH+/q+uzPMEt/39f7UY5wpf+v+/VWNaLzDw8T/VY9b8Najn538VEejJQs/rf6qJaF9qfh3f/1VFXDW8AXR9ERfbko8AqCuivSIbSx4B1VMMm7Ry7hFQNb/2v58B9VTsf0vncBVS7H9bS3CVUex/a2dwFfFr//sZUE/E6kAFPwPqiPg0sf5+E6wb4mKgspzCZY741NMkfwrUCnHRU5ke4DJGrPb1B38K1Afxua+yjeAyRaxeaxp/CtQCcdJVDOtwGSKuuvoXfwosvGKSYCwH/nY4N8UcwXi+eQTkhVju6F28V8giIk46eos/BRYWsdHUu3i98CIiNlqKLXjH+FwQXxtKYeARkANidyvR1KgVrxpPjzgOSqXvfePTOw4K+g9eOb4IiKEUlE7Xe0ekNVRSQdc+PTAd4kbJrXn/iHTulFzQ+AQuBeJWWegc+hmQxKayENRZhovvUQaWTmWgtQEX2xcZeDBqLd7chYtrySy770AGGsdws2S5/gcACezIQOsZLp5Tqzf6do2lwxAuljMZuGyDL+0EtmVg6w7uLRmNhRq0QePG0jdws2U0FKo/8R8+sb8iA2ETboacRkKNJ9YfINoDWfgCVyoC34z+u+NfZeVB8/vuaWJlsvnNFtRaBqcUlgZvJZU3m0EwQY2v4NTS0qD5nfoZUBYCNne1XXBqcelYFu7hSkFwxWSPDkFMQRyuycK6nwFlINp9WRjOKDBreuloroh9m3v6JjirxMxLR/NErHZl4faNIuOWLOx4urgt4srmV9o5GKXMbNuLhl7l1P7hDODbhWYWVrxgwNLJWCHO/Zx4DrIw2PcIMLMc8XZOHMtE3wsGrGx0FOK1dCDuZKLrEWBjt6X5hWL94xacrC17BBg4bpm1c4hdctL0kpH5PW/ZFHJ/qJTfKgJaXz0C5jRsyML4Y7/KiCWZaHjBwHyeZGL84fuYVQSEoZ8Bc7jZSvcsPpWBIHm6ePLyz+YGmKb4oLAJ+iHwcTS7iW39701s3SoC/OVguvJfqfEMAkkj4LufAR9FYEk27vD/9iTJk4XjI3Bu9wSeKwKC5KmisRE4ldKXahC4lI17j4D3IzCym/jMeSMgeH/5uAis5zLpk2DPIyAuAgd2E944fzLywCYCvL/8+9Dq7h00ggGi3VXwCQOxEJ+O8prsROxfK8hCz1NF30JwWxaC3TOXuFhT8O7iMRCrK/nN9CE+jxXk3cVLR+wPZOPScq8Rh02jM+DaEwVjTP+ePGszm0vWOfEImFX+Y+KPfZbTZKrgqaIzztmxbKxdgTBF4rkhG60Nj4Dp69+RiT87AGWWnhbU9FTRqUV5TdlolZKMTeAmKHmKwuIym/7YmNIBJq8UNanxBDeJeAqyEUpbfwJfJKVPU1lEN7JSbhr2dxkJnij4isSjrDxhigwT1aRbuAIN95VuQfxLRp3qC49+BvxE4EHKIQHsPQjcS3mkKy2GGelf5h2AcupWXTjzCCCwJ+WSAPb+T+yposio+/OLUZxvk+CRlFfSSlUR7Z5shHgdWglsy8pBnZOEiNWXlNtqdecsJowE2dip7xlQJNrYCHG/R+KTXeQe1bWfHHHYVTBa/5W4+4j4fK2QY/JSdRgm2QQNCCIm4soqeqXBRQ0jgDhumu3/fvw9VKQvBNno1y9VlEX3p+qu/0uiqJXruiUKEnd267+WZv8Quw1ZGdcrWZjYlJGQ4rub7CyedxpblgjcykhI2Y2TeJYk7yr6YY+G658yxZYY/mDvbrvSBoIoAN+ZaGgRFMFXxApqlRSh2qr3//+zFg8ePacWTHbR3ck+3/y42Z0kmLuz9CY/rscK8BqqYFY6YBvqs4zM6hIXv6I32eOn99/yuQLO7a8AAb7zSfgBsLJdhd0d1OEp4HH+dfr5H1IW/czCj7SHYVEvlmKVXiNNbE2Mr4Ap50yFKgXYpdIL5VYIQ1oXeXX6k6GD2r3GmvgriFW9Ll2qwUClACN/A7P8GvBA9VcoARFgj34oxzDrIo8tAFqun2TaNriU4NJumFYwGNKTrcDG5s11zvgCoCUiQkN6obR60FRBpRejZnDz7zEgomG933h0SKUP4/Dq31/IcZFwsshPgWi4x3ILzg+ofj4LWnRL691WBSd+VsA+LLqk+ui0GfI/ywVTUiPZ5frhRnSmbIcdofd07HQfFt34CICGH5/+TXd7sGiDjpSt4MPTfuIBXViUuQdA44hOX9LVEBYpnSjzKObfR0CkDYuyuAPAZcyodLENizbqEpgU4JRKB4ewaEgnEfVXFsgRXezCohFdRBWZd+0i9ACL7ujgPqb5BwSbY1Z3AoumUW8AKUnQ3GJVra+wqJexqv246n9OcL3NStToO6BDSUwRIcFgm1UoC9h0RWUVRXz1vwiJdVlFNoFNZ1mYHcDXRbDTZWnKWZwLfiXBEStoxHs5qh2EqTbzQHM/tGY/iSvcA5Qz2NWnBnkCwNoIJtssJw/+k7fLHTGvU/3PCTb3qDV45X2X0odDNT69AcwHH4ivRtNgz8p8JtNgGgC4EUiJDRHtcDPPnm6IQ+p757+Iv/7nBM0+qZYyT06vAZ13XouDEwv1/5IRUq6idWgUJ+jlVK7WOrZR/y8nI+rqzFs8mSenNjEr7wFKjkw1UBfgfEjVFXse6tEsVjDpLi0HtXikomCzT1KXDLof9p6XD3skKjnuWZt/QIDHG759F1AlWz/tjXnJtbgdkvqf6m+Z+PX35k2g6JBU/XfM2Wxic9BvE6B51SH1Ly48/9VpNK1eCgFkf5yR1FdIdu5sRoCWEGDnYY9P9AnndLw/sDr9i2Gj1zjM+eKgPbvdsTzmZXqNUTvjQn5zVJzBOgGAwfH06tusf7p7WdxfoLZEAFz3HqfFQ6OYnnwZoB6FIIIXNRlzkiRJkiRJkiRJkiRJkiTJH/bgQAAAAAAAyP+1EVRVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVlfbgkAAAAABA0P/XrrABAAAAAAAAAAAAAAAAAAAAAAAAtwBv5Ssr6fnIVwAAAABJRU5ErkJggg=="},Key:{UP:38,RIGHT:39,BOTTOM:40,LEFT:37,ENTER:13}},r=i(1),o=i.n(r),s=i(2),a=i.n(s),u=i(9),c=i.n(u),l=i(4),h=i.n(l),f=i(5),d=i.n(f),g=i(6),p=i.n(g),y=i(0),v=i.n(y),m={preRenderedFont:{},lastKey:-1,preRenderFont:function(t,e,i,n){t.push("?"),t.push(" "),t.push("A");for(var r=0;r<t.length;r++){var o=document.createElement("canvas"),s=o.getContext("2d");s.font=e+"px "+n;var a=s.measureText(t[r]).width;o.width=a,o.height=e+e/6,s.font=e+"px "+n,s.fillStyle=i,s.textBaseline="top",s.fillText(t[r],0,0),this.preRenderedFont[t[r]]=o}},drawImage:function(t,e,i,n,r,o,s,a,u,c,l,h){this.drawImageWrapper(t,e,i,n,r,o,s,a,u,c,l,h)},drawImageData:function(t,e,i,n,r,o,s,a,u,c,l,h){this.drawImageWrapper(t,e,i,n,r,o,s,a,u,c,l,h)},drawImageWrapper:function(t,e,i,n,r,o,s,a,u,c,l,h){i=null==i||isNaN(i)?null:Math.round(i),n=null==n||isNaN(n)?null:Math.round(n),r=null==r||isNaN(r)?null:Math.round(r),o=null==o||isNaN(o)?null:Math.round(o),s=null==s||isNaN(s)?null:Math.round(s),a=null==a||isNaN(a)?null:Math.round(a),u=null==u||isNaN(u)?null:Math.round(u),c=null==c||isNaN(c)?null:Math.round(c),l=null!=l&&l,null!=(h=null==h||isNaN(h)?null:h)&&(t.save(),t.translate(i+r/2,n+o/2),t.rotate(h*Math.PI/180),i=-r/2,n=-o/2),l&&t.clearRect(i,n,r,o),null!=t&&null!=e&&(null!=s&&null!=a&&null!=u&&null!=c?t.drawImage(e,s,a,u,c,i,n,r,o):t.drawImage(e,i,n,r,o)),null!=h&&t.restore()},drawText:function(t,e,i,n,r,o,s,a,u,c,l,h){if(t){t.save(),Array.isArray(i)||(t.fillStyle=i,t.strokeStyle=i),t.font=(l?"bold ":"")+n+"px "+r,t.filter="none",c&&(e=this.wrapTextLines(t,e).text);var f=e.split("\n"),d=0,g=0,p=0;"center"==s?u=Math.round(t.canvas.height/2-n*f.length/2):"top"==s?u=5:"bottom"==s&&(u=Math.round(t.canvas.height-n*f.length/2-n/5));for(var y=0;y<f.length;y++){var v=f[y],m=t.measureText(v).width,x=0;if(Array.isArray(i)){var k=y;k>i.length-1&&(k=i.length-1),t.fillStyle=i[k],t.strokeStyle=i[k]}"center"==o?(g=Math.round(t.canvas.width/2-t.measureText(v).width/2),x=Math.round(u+n*y)):"right"==o?(g=Math.round(t.canvas.width-t.measureText(v).width-15),x=Math.round(u+n*y)):"left"==o?(g=5,x=Math.round(u+n*y)):(g=Math.round(a),x=Math.round(u+n*y)),t.fillText(v,g,x),h&&(t.lineWidth=1,t.beginPath(),t.moveTo(g,x+3),t.lineTo(Math.round(g+m),x+3),t.stroke()),m>d&&(d=m),0==y&&(p=x)}return t.restore(),{x:g,y:p,height:n*f.length,width:d}}},wrapText:function(t,e){if(t.length>e){for(var i=e;i>0&&" "!=t[i];i--);if(i>0){var n=t.substring(0,i),r=t.substring(i+1);return n+"\n"+this.wrapText(r,e)}}return t},wrapTextLines:function(t,e,i,n,r,o){if(t&&e){t.save(),t.font=n+"px "+r;for(var s=e.split("\n"),a="",u=i||t.measureText("A").width,c=Math.round(t.canvas.width/u),l=0,h=0,f=0;f<s.length;f++){var d=this.wrapText(s[f],c);a+=d,f<s.length-1&&(a+="\n");for(var g=0;g<d.split("\n").length;g++){var p=t.measureText(d.split("\n")[g]).width;l+=n,p>h&&(h=p)}}return t.restore(),{text:a,height:l,width:h,carWidth:u}}return{text:"",height:0,width:0,carWidth:0}},drawArrow:function(t,e,i,n,r){t.save(),t.lineCap="round",t.lineWidth=8,t.strokeStyle="#FF0000",t.filter="",t.beginPath();var o=n-e,s=r-i,a=Math.atan2(s,o);t.moveTo(e,i),t.lineTo(n,r),t.moveTo(n,r),t.lineTo(n-20*Math.cos(a-Math.PI/6),r-20*Math.sin(a-Math.PI/6)),t.moveTo(n,r),t.lineTo(n-20*Math.cos(a+Math.PI/6),r-20*Math.sin(a+Math.PI/6)),t.stroke(),t.restore()},clear:function(t){t.clearRect(0,0,t.canvas.width,t.canvas.height)},isFilterHueAvailable:function(){var t=document.createElement("canvas");t.width=5,t.height=5;var e=t.getContext("2d");e.fillStyle="#FF0000",e.filter="hue-rotate(90deg)",e.fillRect(0,0,5,5);var i=e.getImageData(0,0,1,1).data;return 255!=i[0]||0!=i[1]||0!=i[2]},blurCanvas:function(t,e){t.save(),t.filter="blur("+e+"px)",this.drawImageData(t,t.canvas,0,0,t.canvas.width,t.canvas.height),t.restore()},getFontSize:function(t){return Math.floor(parseInt(t.font.match(/\d+/),10)/1.25)},autoResizeCanvas:function(t,e,i){if(document.fullscreenElement)document.fullscreenElement==t?(t.width=window.innerWidth,t.height=window.innerHeight):(t.width=e,t.height=i);else if(e>=.85*document.documentElement.clientWidth){var n=e/i;t.width=.85*document.documentElement.clientWidth,t.height=t.width/n}else t.width=e,t.height=i},enableAutoResizeCanvas:function(t,e,i){var n=this;t&&"true"!=t.getAttribute("autoresize-canvas-event")&&(this.autoResizeCanvas(t,e,i),window.addEventListener("resize",(function(){t.setAttribute("autoresize-canvas-event","true"),n.autoResizeCanvas(t,e,i)})))},autoResizeCanvasFullscreen:function(t,e){document.fullscreenElement==(e||t)&&(t.width=window.innerWidth,t.height=window.innerHeight,e&&(e.width=window.innerWidth,e.height=window.innerHeight))},enableAutoResizeCanvasFullscreen:function(t,e){var i=this;t&&"true"!=t.getAttribute("autoresizefullscreen-canvas-event")&&(this.autoResizeCanvasFullscreen(t,e),window.addEventListener("resize",(function(){t.setAttribute("autoresizefullscreen-canvas-event","true"),i.autoResizeCanvasFullscreen(t,e)})))},toggleFullscreen:function(t,e){if(t){var i=t.width,n=t.height;if(e&&(e.width=i,e.height=n),document.fullscreenElement?document.exitFullscreen&&document.exitFullscreen():(e||t).requestFullscreen?(e||t).requestFullscreen():(e||t).mozRequestFullScreen?(e||t).mozRequestFullScreen():(e||t).webkitRequestFullscreen?(e||t).webkitRequestFullscreen():(e||t).msRequestFullscreen?(e||t).msRequestFullscreen():(e||t).oRequestFullscreen&&(e||t).oRequestFullscreen(),this.enableAutoResizeCanvasFullscreen(t,e),"true"!=t.getAttribute("fullscreenchange-canvas-event")){t.setAttribute("fullscreenchange-canvas-event","true");var r=function(){document.fullscreenElement!=(e||t)&&(t.width=i,t.height=n,e&&(e.width=i,e.height=n))};void 0!==document.onfullscreenchange?document.onfullscreenchange=r:void 0!==document.onmsfullscreenchange?document.onmsfullscreenchange=r:void 0!==document.onmozfullscreenchange?document.onmozfullscreenchange=r:void 0!==document.onwebkitfullscreenchange?document.onwebkitfullscreenchange=r:void 0!==document.onokitfullscreenchange&&(document.onofullscreenchange=r)}}}},x=function(){function t(e,i,n,r,s,a,u,c){o()(this,t),this.x=e||0,this.y=i||0,this.initialX=e,this.initialY=i,this._width=n,this._height=r,this.alignement=s||"default",this.verticalAlignement=a||"default",this.canvasContext2d,this.triggersClick=[],this.triggersHover=[],this.triggersDown=[],this.triggersScroll=[],this.init=!1,this.initEvents=!1,this.selected=!1,this.clicked=!1,this.hovered=!1,this.disabled=!1,this.disableAnimation=u||!1,this.scrollDisabled=c||!1,this.offsetScrollX=0,this.offsetScrollY=0,this.touchEventStartX=0,this.touchEventStartY=0,this.touchEventStartTimestamp=0,this.tooltip}return a()(t,[{key:"draw",value:function(t){var e=this,i=t.canvas,n=i.getContext("2d");if(this.canvasContext2d=n,!this.initEvent&&null!=n){i.addEventListener("mousemove",(function(t){if(e.disabled)e.hovered=!1,e.clicked=!1,e.tooltip&&(e.tooltip.disabled=!0);else if(e.isInside(e.getMousePos(i,t))){if(null==e.triggersHover||e.disabled||e.triggersHover.forEach((function(t){return t()})),e.tooltip){var n=e.getMousePos(i,t);e.tooltip.x=n.x+10,e.tooltip.y=n.y+10,e.tooltip.disabled=!1}e.hovered=!0}else e.hovered=!1,e.tooltip&&(e.tooltip.disabled=!0)}),!1),i.addEventListener("click",(function(t){e.disabled?(e.hovered=!1,e.clicked=!1):e.isInside(e.getMousePos(i,t))?(null!=e.triggersClick&&e.triggersClick.forEach((function(t){return t()})),e.selected=!0):(e.clicked=!1,e.selected=!1)}),!1),i.addEventListener("mousedown",(function(t){e.disabled?(e.hovered=!1,e.clicked=!1):e.isInside(e.getMousePos(i,t))?(null!=e.triggersDown&&e.triggersDown.forEach((function(t){return t()})),e.clicked=!0):e.clicked=!1}),!1),i.addEventListener("mouseup",(function(){e.clicked=!1}),!1),i.addEventListener("wheel",(function(t){!e.hovered||e.disabled||e.scrollDisabled||(e.offsetScrollX+=t.deltaX,e.offsetScrollY+=t.deltaY,null!=e.triggersScroll&&e.triggersScroll.forEach((function(e){return e(t.deltaX,t.deltaY)})))}));var r=function(t){var n=t.changedTouches[0],r=e.getMousePos(i,n);e.isInside(r)?(e.hovered=!0,e.selected=!0):(e.hovered=!1,e.selected=!1),e.hovered&&!e.disabled&&(e.touchEventStartX=r.x,e.touchEventStartY=r.y,e.touchEventStartTimestamp=t.timestamp)};i.addEventListener("touchstart",r),i.addEventListener("touchend",r),i.addEventListener("touchmove",(function(t){!function(t){var n=t.changedTouches[0],r=e.getMousePos(i,n);!e.hovered||e.disabled||e.scrollDisabled||(e.offsetScrollX+=e.touchEventStartX-r.x,e.offsetScrollY+=e.touchEventStartY-r.y,null!=e.triggersScroll&&e.triggersScroll.forEach((function(t){return t(e.touchEventStartX-r.x,e.touchEventStartY-r.y)})),e.touchEventStartX=r.x,e.touchEventStartY=r.y)}(t),t.preventDefault()}))}this.disabled&&(this.selected=!1,this.clicked=!1,this.hovered=!1,this.tooltip&&(this.tooltip.disabled=!0)),this.initEvent=!0}},{key:"getMousePos",value:function(t,e){var i=t.getBoundingClientRect();return{x:e.clientX-i.left,y:e.clientY-i.top}}},{key:"isInside",value:function(t){return t.x>this.x&&t.x<this.x+this.width&&t.y<this.y+this.height&&t.y>this.y}},{key:"disable",value:function(){this.disabled=!0}},{key:"enable",value:function(){this.disabled=!1}},{key:"setClickAction",value:function(t){this.triggersClick=[t]}},{key:"addClickAction",value:function(t){this.triggersClick.push(t)}},{key:"removeClickAction",value:function(t){this.triggersClick=this.triggersClick.filter((function(e){return e!=t}))}},{key:"removeAllClickActions",value:function(){this.triggersClick=[]}},{key:"setHoverAction",value:function(t){this.triggersHover=[t]}},{key:"addHoverAction",value:function(t){this.triggersHover.push(t)}},{key:"removeHoverAction",value:function(t){this.triggersHover=this.triggersHover.filter((function(e){return e!=t}))}},{key:"removeAllHoverActions",value:function(){this.triggersHover=[]}},{key:"setDownAction",value:function(t){this.triggersDown=[t]}},{key:"addDownAction",value:function(t){this.triggersDown.push(t)}},{key:"removeDownAction",value:function(t){this.triggersDown=this.triggersDown.filter((function(e){return e!=t}))}},{key:"removeAllDownActions",value:function(){this.triggersDown=[]}},{key:"setScrollAction",value:function(t){this.triggersScroll=[t]}},{key:"addScrollAction",value:function(t){this.triggersScroll.push(t)}},{key:"removeScrollAction",value:function(t){this.triggersScroll=this.triggersScroll.filter((function(e){return e!=t}))}},{key:"removeAllScrollActions",value:function(){this.triggersScroll=[]}},{key:"height",get:function(){return this._height},set:function(t){this._height=t}},{key:"width",get:function(){return this._width},set:function(t){this._width=t}}]),t}();function k(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=v()(t);if(e){var r=v()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return p()(this,i)}}var w=function(t){d()(i,t);var e=k(i);function i(t,r,s,a,u,c,l,h,f,d,g,p,y,v,m){var x;return o()(this,i),(x=e.call(this,r,s,h,f,a,m)).autoWidth=null==x.width,x.autoHeight=null==x.height,x.text=t,x.fontSizeInitial=d,x.fontSize=x.fontSizeInitial||Math.floor(n.Setting.FONT_SIZE/1.25),x.fontFamily=g||n.Setting.FONT_FAMILY,x.fontColor=p||"white",x.color=u||"rgba(0, 0, 0, 0)",x.colorHover=c||"#95a5a6",x.colorDown=l||"#727F80",x.image,x.imgSrc=y,x.imageLoader=v,x}return a()(i,[{key:"draw",value:function(t){h()(v()(i.prototype),"draw",this).call(this,t);var e=t.canvas,r=e.getContext("2d");r.save(),this.fontSize=this.fontSizeInitial||Math.floor(n.Setting.FONT_SIZE/1.25),r.font=this.fontSize+"px "+this.fontFamily;var o=this.textWrapped,s=o.text.split("\n").length,a=o.width;if(null!=this.imgSrc&&null!=this.imageLoader&&this.loadImage(this.imageLoader),"center"==this.alignement?this.x=e.width/2-this.width/2-this.initialX:"right"==this.alignement?this.x=e.width-this.width-5-this.initialX:"left"==this.alignement&&(this.x=5),"bottom"==this.verticalAlignement?this.y=e.height-this.height-5-this.initialY:"center"==this.verticalAlignement?this.y=e.height/2-this.height/2-this.initialY:"top"==this.verticalAlignement&&(this.y=15),this.hovered&&this.clicked?r.fillStyle=this.colorDown:this.hovered?r.fillStyle=this.colorHover:r.fillStyle=this.color,r.fillRect(Math.round(this.x),Math.round(this.y),Math.round(this.width),Math.round(this.height)),this.selected){var u=r.strokeStyle,c=r.lineWidth;r.strokeStyle="#a2cdd8",r.lineWidth=3,r.strokeRect(Math.round(this.x),Math.round(this.y),Math.round(this.width),Math.round(this.height)),r.strokeStyle=u,r.lineWidth=c}if(null!=this.image){var l,f;if(this.image.width>this.width||this.image.height>this.height){var d=this.image.width/this.image.height;l=Math.floor(this.width/1.25),f=Math.floor(l/d)}var g=this.x+this.width/2-l/2,p=this.y+this.height/2-f/2;m.drawImage(r,this.image,Math.round(g),Math.round(p),Math.round(l),Math.round(f))}else if(null!=this.text){r.textBaseline="middle",r.fillStyle=this.fontColor;var y=this.x+this.width/2-a/2,x=this.y+this.height/2-(s-1)*(this.fontSize/2);m.drawText(r,this.text,this.fontColor,this.fontSize,this.fontFamily,"center"==this.alignement?"center":"default","default",Math.round(y),Math.round(x),!0)}r.restore()}},{key:"loadImage",value:function(t){this.image=t.get(this.imgSrc)}},{key:"textWrapped",get:function(){return m.wrapTextLines(this.canvasContext2d,this.text,null,this.fontSize,this.fontFamily)}},{key:"height",get:function(){if(this.image){var t=this.image.height;if(this.autoHeight)return 1.5*t}else if(this.text){var e=this.textWrapped.height;if(this.autoHeight)return e+this.fontSize/1.5}return h()(v()(i.prototype),"height",this)},set:function(t){c()(v()(i.prototype),"height",t,this,!0),this.autoHeight=!1}},{key:"width",get:function(){if(this.image){var t=this.image.width;if(this.autoWidth)return 1.25*t}else if(this.text){var e=this.textWrapped,n=e.width;if(this.autoWidth)return n+2*e.carWidth}return h()(v()(i.prototype),"width",this)},set:function(t){c()(v()(i.prototype),"width",t,this,!0),this.autoWidth=!1}}]),i}(x),T=function(t){d()(i,t);var e=k(i);function i(t,n,r,s,a,u,c,l,h,f){return o()(this,i),e.call(this,null,n,r,s,l,h,null,u,c,null,null,null,t,f,a)}return i}(w),b=function(){function t(){o()(this,t),this.images={},this.imagesResized={},this.triedLoading=0,this.hasError=!1,this.nbImagesToLoad=1,this.firstImage=!0}return a()(t,[{key:"load",value:function(t,e){var i=this;if(this.firstImage&&(this.nbImagesToLoad=t.length,this.firstImage=!1),!(t.length>0))return e();this.loadImage(t[0],(function(n){if(1!=n)return i.hasError=!0,e();t.shift(),i.load(t,e)}))}},{key:"loadImage",value:function(t,e){var i=this;this.triedLoading++;var n=new Image;n.src=t,n.onload=function(){return null==i.images?e(!1):(i.images[t]=n,i.triedLoading=0,e(!0))},n.onerror=function(){if(i.triedLoading>=5)return null!=i.images&&(i.images[t]=n),i.triedLoading=0,e(!1);setTimeout((function(){i.loadImage(t,e)}),250)}}},{key:"get",value:function(t,e,i){if(null!=this.images&&this.images.hasOwnProperty(t)){var n=this.images[t];if(!e&&!i||n.width==e&&n.height==i)return n;var r=Math.round(e),o=Math.round(i),s=t+"@"+r+"-"+o;if(!this.imagesResized.hasOwnProperty(s)){var a=document.createElement("canvas"),u=a.getContext("2d");a.width=r,a.height=o,m.drawImage(u,n,0,0,r,o,0,0,n.width,n.height),this.imagesResized[s]=a}return this.imagesResized[s]}return null}},{key:"clear",value:function(){this.images=null}}]),t}(),A=function(t){d()(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=v()(t);if(e){var r=v()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return p()(this,i)}}(i);function i(t,r,s,a,u,c,l,h,f,d){var g;return o()(this,i),(g=e.call(this,0,0,0,0,null,null,f)).text=t,g.textColor=null==r?"rgba(255, 255, 255, 0.75)":r,g.backgroundColor=null==s?"rgba(46, 204, 113, 0.5)":s,g.delayBeforeClosing=null==a?5:a,g.fontSizeInitial=c,g.fontSize=g.fontSizeInitial||Math.floor(n.Setting.FONT_SIZE/1.25),g.fontFamily=null==l?n.Setting.FONT_FAMILY:l,g.animationDelay=null==u?500:u,g.foreGround=null!=h&&h,g.timeLastFrame=0,g.animationTime=0,g.closed=!0,g.closing=!1,g.easingFunction=d,g.closeButton=new T(null,null,5,"right",null,32,32),g.closeButton.image=new Image,g.closeButton.image.src=n.Setting.CLOSE_ICON,g}return a()(i,[{key:"draw",value:function(t){var e=this;if(null!=this.text){h()(v()(i.prototype),"draw",this).call(this,t);var r=t.canvas,o=r.getContext("2d");o.save(),this.init||(this.timeLastFrame=performance.now()),null!=this.closeButton&&this.closeButton.setClickAction((function(){e.close()}));var s=performance.now()-this.timeLastFrame;this.timeLastFrame=performance.now(),this.animationTime>=1e3*this.delayBeforeClosing&&!this.closing&&!this.closed&&this.close(),this.fontSize=this.fontSizeInitial||n.Setting.FONT_SIZE;var a=m.wrapTextLines(o,this.text,null,this.fontSize,this.fontFamily).height+this.fontSize/2,u=r.width,c=1;if(this.closing?this.disableAnimation?this.animationTime=-1:this.animationTime-=s:this.animationTime+=s,this.animationTime<0&&(this.closed=!0,this.closing=!1),this.closed)this.disableCloseButton();else{this.disableAnimation||(c=this.animationTime/this.animationDelay),this.easingFunction&&(c=this.easingFunction(c));var l=r.height-a*(c<=1?c:1);o.fillStyle=this.backgroundColor,o.fillRect(0,l,u,a),m.drawText(o,this.text,this.textColor,this.fontSize,this.fontFamily,"center","default",null,l+this.fontSize,!0),null!=this.closeButton&&(this.closeButton.y=l+5,this.closeButton.draw(o)),this.enableCloseButton()}o.restore(),this.init=!0}}},{key:"close",value:function(){this.disableCloseButton(),this.closing||(this.closing=!0,this.animationTime=this.animationDelay)}},{key:"open",value:function(){this.timeLastFrame=0,this.animationTime=0,this.init=!1,this.closed=!1,this.closing=!1}},{key:"disableCloseButton",value:function(){null!=this.closeButton&&null!=this.closeButton&&this.closeButton instanceof w&&this.closeButton.disable()}},{key:"enableCloseButton",value:function(){null!=this.closeButton&&null!=this.closeButton&&this.closeButton instanceof w&&this.closeButton.enable()}},{key:"copy",value:function(){return new i(this.text,this.textColor,this.backgroundColor,this.delayBeforeClosing,this.animationDelay,this.fontSize,this.fontFamily,this.foreGround)}}]),i}(x),E=i(8),S=i.n(E),R=i(7),P=i.n(R),O=i(3),D=i.n(O),L=function(t){d()(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=v()(t);if(e){var r=v()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return p()(this,i)}}(i);function i(t,n){var r,s;o()(this,i),s=e.call(this,0,0,0,0),C.set(S()(s),{writable:!0,value:[]});for(var a=arguments.length,u=new Array(a>2?a-2:0),c=2;c<a;c++)u[c-2]=arguments[c];return(r=s).addAll.apply(r,u),s.backgroundColor=t||"rgba(44, 62, 80, 0.75)",s.blurCanvas=n||!1,s.lastKey=null==s.lastKey?-1:s.lastKey,s.selectedComponent=null==s.selectedComponent?0:s.selectedComponent,s.disable(),s}return a()(i,[{key:"draw",value:function(t){var e=this;h()(v()(i.prototype),"draw",this).call(this,t);var r=t.canvas.getContext("2d");if(!this.disabled){this.init||(document.addEventListener("keydown",(function(t){e.disabled||(e.lastKey=t.keyCode)})),this.init=!0),this.blurCanvas&&m.blurCanvas(r,5),r.save(),r.font=this.fontSize+"px "+this.fontFamily,r.fillStyle=this.backgroundColor,r.fillRect(0,0,r.canvas.width,r.canvas.height);var o=0;if(null!=D()(this,C)){this.lastKey==n.Key.UP?this.selectedComponent--:this.lastKey==n.Key.BOTTOM&&this.selectedComponent++,this.selectedComponent>=D()(this,C).length?this.selectedComponent=0:this.selectedComponent<0&&(this.selectedComponent=D()(this,C).length-1),D()(this,C).forEach((function(t){return o+=t.height}));var s=(r.canvas.height-(o||0))/2||0;D()(this,C).forEach((function(t,i){if(t instanceof x){if(t.y=s,t.initialY=s,e.selectedComponent==i?t.selected=!0:t.selected=!1,t.enable(),t.draw(r),e.selectedComponent==i&&e.lastKey==n.Key.ENTER&&null!=t.triggersClick&&t.triggersClick.length>0&&!t.disabled)return e.lastKey=-1,e.selectedComponent=0,void t.triggersClick.forEach((function(t){return t()}));s+=t.height+8}}))}r.restore()}this.lastKey=-1}},{key:"set",value:function(){this.clear(),this.addAll.apply(this,arguments),this.enable()}},{key:"add",value:function(t){this.addAll(t)}},{key:"addAll",value:function(){for(var t=this,e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];i.forEach((function(e){return D()(t,C).push(e)}))}},{key:"remove",value:function(t){P()(this,C,D()(this,C).filter((function(e){return t!=e})))}},{key:"removeAll",value:function(){for(var t=this,e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];i.forEach((function(e){return t.remove(e)}))}},{key:"clear",value:function(){P()(this,C,[])}},{key:"disable",value:function(){h()(v()(i.prototype),"disable",this).call(this),D()(this,C).forEach((function(t){return t&&t.disable&&t.disable()}))}},{key:"enable",value:function(){h()(v()(i.prototype),"enable",this).call(this),D()(this,C).forEach((function(t){return t&&t.enable&&t.enable()}))}}]),i}(x),C=new WeakMap,I=function(t){d()(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=v()(t);if(e){var r=v()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return p()(this,i)}}(i);function i(t,r,s,a,u,c,l,f,d,g,p,y){var m,x;return o()(this,i),(x=e.call(this,t,r,s,a)).text=y||"",x.fontSizeInitial=u,x.fontSize=x.fontSizeInitial||Math.floor(n.Setting.FONT_SIZE/1.25),x.fontFamily=c||n.Setting.FONT_FAMILY,x.fontColor=p||"#000000",x.backgroundColor=l||"#ffffff",x.borderColor=f||"#000000",x.borderColorHover=d||"#a2cdd8",x.borderSize=g||3,x.height=null==x.height?x.fontSize+2*x.borderSize:x.height,x.positionStart=0,x.positionEnd=0,x.offsetX=0,x.lastTime=0,x.totalTime=0,x.input=document.createElement("input"),x.input.setAttribute("type","text"),x.input.style.position="absolute",x.input.style.left="-9999px",x.input.addEventListener("input",(function(){return x.totalTime=0})),x.input.addEventListener("blur",(function(){return x.selected=!1})),x.input.addEventListener("focus",(function(){return x.selected=!0})),document.body.appendChild(x.input),x.canvas,x.appendToCanvas=!1,x.noticeLogged=!1,x.canvasTmp=document.createElement("canvas"),h()((m=S()(x),v()(i.prototype)),"addClickAction",m).call(m,(function(){return x.click()})),x}return a()(i,[{key:"draw",value:function(t){h()(v()(i.prototype),"draw",this).call(this,t);var e=t.canvas,n=e.getContext("2d");n.save(),this.input.selectionEnd!=this.positionEnd&&(this.totalTime=0),this.canvas&&!this.appendToCanvas?(document.body.removeChild(this.input),this.canvas.container.appendChild(this.input),this.appendToCanvas=!0):this.canvas||this.noticeLogged||(console&&console.warn&&console.warn("Notice: the use of JSGameTools.Canvas is needed for Input components to properly work in fullscreen mode."),this.noticeLogged=!0),this.text=this.input.value,this.positionStart=this.input.selectionStart,this.positionEnd=this.input.selectionEnd;var r=performance.now(),o=0;this.lastTime>0&&(o=r-this.lastTime),this.lastTime=r,this.totalTime+=o,n.fillStyle=this.backgroundColor,n.fillRect(Math.round(this.x),Math.round(this.y),Math.round(this.width),Math.round(this.height)),n.strokeStyle=this.selected?this.borderColorHover:this.borderColor,n.lineWidth=this.borderSize,n.strokeRect(Math.round(this.x),Math.round(this.y),Math.round(this.width),Math.round(this.height)),this.canvasTmp.width=e.width,this.canvasTmp.height=e.height;for(var s=this.canvasTmp.getContext("2d"),a=this.x+5,u=-1;u<this.text.length;u++)u>-1&&(a+=m.drawText(s,this.text[u],this.fontColor,this.fontSize,this.fontFamily,"default","default",a-this.offsetX,this.y+this.fontSize,!1).width+1),this.positionEnd==u+1&&this.selected&&(this.totalTime<=500?(s.strokeStyle=this.borderColor,s.lineWidth=1,s.beginPath(),s.moveTo(a-this.offsetX,this.y+3),s.lineTo(a-this.offsetX,this.y+this.fontSize),s.stroke()):this.totalTime>1e3&&(this.totalTime=0),this.offsetX=Math.max(0,Math.round(a-this.x-this.width+8)));m.drawImageData(n,this.canvasTmp,this.x+this.borderSize,this.y+this.borderSize,this.width-2*this.borderSize,this.height-2*this.borderSize,this.x+this.borderSize,this.y+this.borderSize,this.width-2*this.borderSize,this.height-2*this.borderSize),(this.hovered||this.clicked)&&(e.style.cursor="text"),this.selected||(this.totalTime=0),n.restore()}},{key:"click",value:function(){this.input.focus()}}]),i}(x),M=function(t){d()(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=v()(t);if(e){var r=v()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return p()(this,i)}}(i);function i(t,r,s,a,u,c,l,h,f,d,g){var p;return o()(this,i),(p=e.call(this,r,s)).text=t,p.color=c||"#000000",p.fontSize=a||n.Setting.FONT_SIZE,p.fontFamily=u||n.Setting.FONT_FAMILY,p.alignement=l||"default",p.verticalAlignement=h||"default",p.wrap=f||!0,p.bold=d||!1,p.underline=g||!1,p}return a()(i,[{key:"draw",value:function(t){h()(v()(i.prototype),"draw",this).call(this,t);var e=t.canvas.getContext("2d");e.save();var n=m.drawText(e,this.text,this.color,this.fontSize,this.fontFamily,this.alignement,this.verticalAlignement,this.initialX,this.initialY,this.wrap,this.bold,this.underline);this.x=n.x,this.y=n.y-this.fontSize,e.restore()}},{key:"height",get:function(){return m.wrapTextLines(this.canvasContext2d,this.text,null,this.fontSize,this.fontFamily).height},set:function(t){c()(v()(i.prototype),"height",t,this,!0)}},{key:"width",get:function(){return m.wrapTextLines(this.canvasContext2d,this.text,null,this.fontSize,this.fontFamily).width},set:function(t){c()(v()(i.prototype),"width",t,this,!0)}}]),i}(x),F=function(t){d()(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=v()(t);if(e){var r=v()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return p()(this,i)}}(i);function i(t,n,r,s,a,u,c,l,h,f,d,g,p){var y;return o()(this,i),(y=e.call(this,t,n,r,s,a,u||"#0000EE",h,f,d,g,p||!0)).colorHover=c||"#4D4DFF",y.colorDown=l||"#EE7700",y.initialColor=y.color,y.initialUnderline=y.underline,y}return a()(i,[{key:"draw",value:function(t){h()(v()(i.prototype),"draw",this).call(this,t);var e=t.canvas;this.clicked?(this.underline=!1,this.color=this.colorDown,e.style.cursor="pointer"):this.hovered?(this.underline=!1,this.color=this.colorHover,e.style.cursor="pointer"):(this.underline=this.initialUnderline,this.color=this.initialColor),this.init=!0}}]),i}(M),N=function(t){d()(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=v()(t);if(e){var r=v()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return p()(this,i)}}(i);function i(t,r,s,a,u,c,l,h){var f;return o()(this,i),(f=e.call(this,0,0,0,0)).text=t,f.backgroundColor=a||"rgba(255, 255, 255, 0.25)",f.fontColor=u||"#FFFFFF",f.fontSize=r||n.Setting.FONT_SIZE,f.fontFamily=s||n.Setting.FONT_FAMILY,f.wrap=c||!0,f.bold=l||!1,f.underline=h||!1,f.disabled=!0,f}return a()(i,[{key:"draw",value:function(t){if(h()(v()(i.prototype),"draw",this).call(this,t),!this.disabled){var e=t.canvas,n=e.getContext("2d");n.save(),this.x+this.width+10>e.width&&(this.x-=this.width+10),this.y+this.height+10>e.height&&(this.y-=this.height+10),n.fillStyle=this.backgroundColor,n.fillRect(this.x,this.y,this.width+10,this.height+10);var r=m.drawText(n,this.text,this.fontColor,this.fontSize,this.fontFamily,null,null,this.x+5,this.y+this.fontSize,this.wrap,this.bold,this.underline);this.width=r.width,this.height=r.height,n.restore()}}}]),i}(x),U=function(t){d()(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=v()(t);if(e){var r=v()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return p()(this,i)}}(i);function i(){var t,n;return o()(this,i),n=e.call(this,0,0,0,0),G.set(S()(n),{writable:!0,value:[]}),(t=n).addAll.apply(t,arguments),n.canvas,n}return a()(i,[{key:"draw",value:function(t){var e=this;h()(v()(i.prototype),"draw",this).call(this,t);var n=t.canvas,r=n.getContext("2d");r.save(),n.style.cursor="default";var o=D()(this,G).filter((function(t){return t&&t instanceof x&&!(t instanceof L)&&!(t instanceof N)&&!(t instanceof A)})),s=D()(this,G).filter((function(t){return t&&t instanceof L})).filter((function(t){return!t.disabled}))[0],a=D()(this,G).filter((function(t){return t&&t instanceof N})),u=D()(this,G).filter((function(t){return t&&t instanceof I})),c=D()(this,G).filter((function(t){return t&&t instanceof A&&!t.foreGround})),l=D()(this,G).filter((function(t){return t&&t instanceof A&&t.foreGround}));u&&u.forEach((function(t){return t.canvas=e.canvas})),s?o&&o.forEach((function(t){return t.disable()})):o&&o.forEach((function(t){return t.enable()})),o&&o.forEach((function(t){return t.draw(r)})),c&&c.forEach((function(t){return t.draw(r)})),a&&a.forEach((function(t){return t.draw(r)})),s&&s.draw(r),l&&l.forEach((function(t){return t.draw(r)})),r.restore()}},{key:"add",value:function(t){this.addAll(t)}},{key:"addAll",value:function(){for(var t=this,e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];i.forEach((function(e){return D()(t,G).push(e)}))}},{key:"remove",value:function(t){P()(this,G,D()(this,G).filter((function(e){return t!=e})))}},{key:"removeAll",value:function(){for(var t=this,e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];i.forEach((function(e){return t.remove(e)}))}},{key:"clear",value:function(){P()(this,G,[])}}]),i}(x),G=new WeakMap,_=function(t){d()(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=v()(t);if(e){var r=v()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return p()(this,i)}}(i);function i(t,n,r,s,a,u,c,l,h,f,d){var g;return o()(this,i),(g=e.call(this,null,n,r,s,a,u,c,l,h,f,d)).displayFrames=t||!1,g.frames=0,g.lastFrame=0,g.currentFPS=0,g.intervalCountFPS=setInterval((function(){return g.countFPS()}),1e3),g}return a()(i,[{key:"draw",value:function(t){this.text="FPS: "+this.currentFPS+(this.displayFrames?" / Frames: "+this.frames:""),h()(v()(i.prototype),"draw",this).call(this,t),this.frames++}},{key:"countFPS",value:function(){this.lastFrame>0&&(this.currentFPS=this.frames-this.lastFrame),this.lastFrame=this.frames}}]),i}(M),j=function(t){d()(i,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=v()(t);if(e){var r=v()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return p()(this,i)}}(i);function i(t,n,r,s,a,u,c,l,h,f,d,g){var p;return o()(this,i),p=e.call(this,t,n,r,s,f,d,h),H.set(S()(p),{writable:!0,value:0}),B.set(S()(p),{writable:!0,value:0}),p.backgroundColor=a||"#bdc3c7",p.foregroundColor=u||"#27ae60",p.percent=null==c?0:c,P()(S()(p),H,p.percent),p.easingFunction=g,p.animationDuration=l||2,p.lastTime=0,p.totalTime=0,p}return a()(i,[{key:"draw",value:function(t){h()(v()(i.prototype),"draw",this).call(this,t);var e=t.canvas,n=e.getContext("2d");n.save();var r=performance.now(),o=0,s=D()(this,H)==this.percent||this.disableAnimation?1:this.totalTime/(1e3*this.animationDuration);this.easingFunction&&(s=this.easingFunction(s));var a=Math.round(Math.min(this.width,this.width*(D()(this,H)+(this.percent-D()(this,H))*s)));D()(this,H)==this.percent||this.disableAnimation?(this.totalTime=0,this.lastTime=0):(this.lastTime>0&&(o=r-this.lastTime),this.totalTime+=o,this.totalTime>=1e3*this.animationDuration?(P()(this,H,this.percent),this.totalTime=0,this.lastTime=0):this.lastTime=r);var u=this.x,c=this.y;"center"==this.alignement?u=Math.round(e.width/2-this.width/2):"right"==this.alignement?u=Math.round(e.width-(this.width-15)):"left"==this.alignement&&(u=5),"center"==this.verticalAlignement?c=Math.round(e.height/2-this.height/2):"top"==this.verticalAlignement?c=5:"bottom"==this.verticalAlignement&&(c=Math.round(e.height-this.height-5)),n.fillStyle=this.backgroundColor,n.fillRect(u,c,this.width,this.height),n.fillStyle=this.foregroundColor,n.fillRect(u,c,a,this.height),n.restore()}}]),i}(x),H=new WeakMap,B=new WeakMap,z=function(){function t(e,i,n,r,s,a){o()(this,t),K.set(this,{writable:!0,value:void 0}),this.width=n||600,this.height=r||400,this.scene=e,this.scene.canvas=this,this.container=document.createElement("div"),this.canvas=i||document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height,this.container.appendChild(this.canvas),this.started=!1,this.maxFPS=a||-1,P()(this,K,0),s&&this.autoResize()}return a()(t,[{key:"draw",value:function(){var t=this.canvas.getContext("2d");m.clear(t),scene.draw(t)}},{key:"startDraw",value:function(){var t=this;this.started=!0,requestAnimationFrame((function(e){if(t.started){var i=e-D()(t,K);(t.maxFPS<1||i>1e3/t.maxFPS)&&(P()(t,K,e),t.draw()),t.startDraw()}}))}},{key:"stopDraw",value:function(){this.started=!1}},{key:"appendTo",value:function(t){t.appendChild(this.container)}},{key:"toggleFullscreen",value:function(){m.toggleFullscreen(this.canvas,this.container)}},{key:"autoResize",value:function(){m.enableAutoResizeCanvas(this.canvas,this.width,this.height)}}]),t}(),K=new WeakMap,Y={easeInCubic:function(t){return t*t*t},easeOutBounce:function(t){var e=7.5625,i=2.75;return t<1/i?e*t*t:t<2/i?e*(t-=1.5/i)*t+.75:t<2.5/i?e*(t-=2.25/i)*t+.9375:e*(t-=2.625/i)*t+.984375},easeInOutCubic:function(t){return t<.5?4*t*t*t:1-Math.pow(-2*t+2,3)/2},easeInOutSine:function(t){return-(Math.cos(Math.PI*t)-1)/2},easeInOutQuint:function(t){return t<.5?16*t*t*t*t*t:1-Math.pow(-2*t+2,5)/2},easeInOutCirc:function(t){return t<.5?(1-Math.sqrt(1-Math.pow(2*t,2)))/2:(Math.sqrt(1-Math.pow(-2*t+2,2))+1)/2},easeInOutQuad:function(t){return t<.5?2*t*t:1-Math.pow(-2*t+2,2)/2},easeInOutQuart:function(t){return t<.5?8*t*t*t*t:1-Math.pow(-2*t+2,4)/2},easeInOutExpo:function(t){return 0===t?0:1===t?1:t<.5?Math.pow(2,20*t-10)/2:(2-Math.pow(2,-20*t+10))/2},easeInOutBack:function(t){var e=2.5949095;return t<.5?Math.pow(2*t,2)*(7.189819*t-e)/2:(Math.pow(2*t-2,2)*((e+1)*(2*t-2)+e)+2)/2}}}])},function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e){function i(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}t.exports=function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}},function(t,e){function i(e){return t.exports=i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},i(e)}t.exports=i},function(t,e,i){var n=i(22);t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&n(t,e)}},function(t,e,i){var n=i(23),r=i(24);t.exports=function(t,e){return!e||"object"!==n(e)&&"function"!=typeof e?r(t):e}},function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t,e,i){var n=i(21);function r(e,i,o){return"undefined"!=typeof Reflect&&Reflect.get?t.exports=r=Reflect.get:t.exports=r=function(t,e,i){var r=n(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(i):o.value}},r(e,i,o||e)}t.exports=r},function(t,e){t.exports=function(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e){(function(e){t.exports=e}).call(this,{})},function(t,e,i){var n=i(13),r=i(14),o=i(15),s=i(16),a=i(17),u=i(18),c=i(19);c.alea=n,c.xor128=r,c.xorwow=o,c.xorshift7=s,c.xor4096=a,c.tychei=u,t.exports=c},function(module,exports,__webpack_require__){!function(a){var b=Math.sign,c=Math.min,d=Math.abs;void 0===a.Lowlight&&(a.Lowlight={}),"object"==typeof module.exports&&(module.exports=a.Lowlight);class e{constructor(){this.nodes=new Map}id(t){return t}node(t,e=!1){return e?this.nodes.get(this.id(arguments[0])):this.nodes.get(t)}data(t,e){return 2===arguments.length&&(t.graph.get(this)._data=e),t.graph.get(this)._data}adjacent(t,e){return t.graph.get(this).has(e)}neighbors(t){return Array.from(t.graph.get(this).keys())}connected(t,e){return t.graph.get(this)._connectivity===e.graph.get(this)._connectivity}connect(){let t=Array.from(this.nodes.values()),e=0;for(let e=0;e<t.length;e++)t[e].graph.get(this)._connectivity=void 0;for(let i=0;i<t.length;i++){if(void 0!==t[i].graph.get(this)._connectivity)continue;let n=[t[i]];for(e++;n.length;){let t=n.shift();t.graph.get(this)._connectivity=e,this.neighbors(t).map(t=>{void 0===t.graph.get(this)._connectivity&&0>n.indexOf(t)&&n.push(t)})}}}add(t){return 1<arguments.length?Array.from(arguments).map(t=>this.add(t)):(t.graph.set(this,new Map),this.nodes.set(t.id,t),t)}delete(t){return 1<arguments.length?Array.from(arguments).map(t=>this.delete(t)):(t.graph.delete(this),this.nodes.delete(t.id),t)}edge(t,e,i=1,n=1){if(!t.graph.has(this)||!e.graph.has(this))throw new Error("Nodes must be on the same graph");return null===i?t.graph.get(this).delete(e):t.graph.get(this).set(e,i),null===n?e.graph.get(this).delete(t):e.graph.get(this).set(t,n),this}cost(t,e){return this.adjacent(t,e)?t.graph.get(this).get(e):null}}e.fromArray=function(t,i={}){let n=e.fromArray.X(t,i.order),r=e.fromArray.Y(t,i.order),o=e.fromArray.at.bind(null,t,i.order),s=[],a=null;for(let t,u=1;u<Math.max(2,arguments.length);u++){t=new e,s.push(t),i=arguments[u]||{};let c=e.fromArray.id.bind(null,n,r,i.torus),l=i.cost||e.fromArray.cost,h=e.fromArray.edge.bind(null,t,l);for(let e=0;e<n;e++)for(let i,n=0;n<r;n++)i=t.add(a?a.get(c(e,n)):new f(c(e,n))),i.x=e,i.y=n,i.graph.get(t)._data=o(e,n),h(i,t.nodes.get(c(e-1,n))),h(i,t.nodes.get(c(e+1,n))),h(i,t.nodes.get(c(e,n-1))),h(i,t.nodes.get(c(e,n+1)));if(i.diagonals)for(let e=0;e<n;e++)for(let n=0;n<r;n++){let r=t.nodes.get(c(e,n)),o=t.adjacent(r,t.nodes.get(c(e-1,n))),s=t.adjacent(r,t.nodes.get(c(e+1,n))),a=t.adjacent(r,t.nodes.get(c(e,n-1))),u=t.adjacent(r,t.nodes.get(c(e,n+1)));"strict"===i.cutting?(o&&a&&h(r,t.nodes.get(c(e-1,n-1))),o&&u&&h(r,t.nodes.get(c(e-1,n+1))),s&&a&&h(r,t.nodes.get(c(e+1,n-1))),s&&u&&h(r,t.nodes.get(c(e+1,n+1)))):((o||a||i.cutting)&&h(r,t.nodes.get(c(e-1,n-1))),(o||u||i.cutting)&&h(r,t.nodes.get(c(e-1,n+1))),(s||a||i.cutting)&&h(r,t.nodes.get(c(e+1,n-1))),(s||u||i.cutting)&&h(r,t.nodes.get(c(e+1,n+1))))}Object.defineProperty(t,"id",{enumerable:!1,configurable:!1,writable:!0,value:t=>c(t.x,t.y)}),t.connect(),t.X=n,t.Y=r,t.TORUS=i.torus,a||(a=t.nodes)}return 1<s.length?s:s[0]},e.fromArray.X=function(t,e="yx"){return"xy"===e?t.length:"yx"===e?t[0].length:0},e.fromArray.Y=function(t,e="yx"){return"xy"===e?t[0].length:"yx"===e?t.length:0},e.fromArray.at=function(t,e="yx",i,n){return"xy"===e?t[i][n]:t[n][i]},e.fromArray.id=function(t=0,e=0,i=!1,n,r){return i?(r+e)%e*t+(n+t)%t:0<=n&&n<t&&0<=r&&r<e?r*t+n:null},e.fromArray.cost=function(){return 1},e.fromArray.edge=function(t,e,i,n){n&&t.edge(i,n,e(t.data(i),t.data(n)),e(t.data(n),t.data(i)))},e.fromArray.update=function(){console.warn("Graph.fromArray isn't implemented yet")};class f{constructor(t,e){for(let i in this.id=t,this.graph=new Map,e)"id"!=i&&"graph"!=i&&(this[i]=e[i])}}class g{constructor(t){this.nodes=[],this.score="function"==typeof t?t:t=>+t}get size(){return this.nodes.length}add(t){if(1<arguments.length){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return this.nodes.push(t),this.bubble(this.size-1)}set(t){let e=this.nodes.indexOf(t);return~e?this.score(t)<=this.score(this.nodes[e])?this.bubble(this.nodes.indexOf(t)):this.sink(this.nodes.indexOf(t)):this.add(t)}pop(){let t=this.nodes[0],e=this.nodes.pop();return 0<this.size&&(this.nodes[0]=e,this.sink(0)),t}top(){return this.nodes[0]}delete(t){if(1<arguments.length){for(let t=0;t<arguments.length;t++)this.delete(arguments[t]);return this}for(let e=0;e<this.size;e++){if(this.nodes[e]!=t)continue;let i=this.nodes.pop();return e==this.size-1?this:(this.nodes[e]=i,this.bubble(e).sink(e))}}bubble(t){let e=this.nodes[t],i=this.score(e);for(;0<t;){let n=Math.floor((t+1)/2)-1,r=this.nodes[n];if(i>=this.score(r))break;this.nodes[n]=e,this.nodes[t]=r,t=n}return this}sink(t){let e=this.nodes[t],i=this.score(e);for(;;){let n=2*(t+1),r=n-1,o=null;if(r<this.size&&this.score(this.nodes[r])<i&&(o=r),n<this.size&&this.score(this.nodes[n])<(o?this.score(this.nodes[o]):i)&&(o=n),null===o)break;this.nodes[t]=this.nodes[o],this.nodes[o]=e,t=o}return this}}let h={manhattan:function(t,e,i={}){let n=d(e.x-t.x),r=d(e.y-t.y);return(i.multiplier||1)*(n+r)},manhattanTorus:function(t,e,i={}){let n=c(d(e.x-t.x),e.x+(i.x||0)-t.x,t.x+(i.x||0)-e.x),r=c(d(e.y-t.y),e.y+(i.y||0)-t.y,t.y+(i.y||0)-e.y);return(i.multiplier||1)*(n+r)},diagonal:function(t,e,i={}){let n=d(e.x-t.x),r=d(e.y-t.y);return m*(n+r)+(dm-2*m)*c(n,r)},diagonalTorus:function(t,e,i={}){let n=c(d(e.x-t.x),e.x+(i.x||0)-t.x,t.x+(i.x||0)-e.x),r=c(d(e.y-t.y),e.y+(i.y||0)-t.y,t.y+(i.y||0)-e.y);return(i.multiplier||1)*(n+r)+((i.diagonalMultiplier||1.4)-2*(i.multiplier||1))*c(n,r)},euclidian:function(t,e,i={}){let n=d(e.x-t.x),r=d(e.y-t.y);return(i.multiplier||1)*Math.sqrt(n*n+r*r)},euclidianTorus:function(t,e,i={}){let n=c(d(e.x-t.x),e.x+(i.x||0)-t.x,t.x+(i.x||0)-e.x),r=c(d(e.y-t.y),e.y+(i.y||0)-t.y,t.y+(i.y||0)-e.y);return(i.multiplier||1)*(n+r)+((i.diagonalMultiplier||1.4)-2*(i.multiplier||1))*c(n,r)}};class i extends Error{constructor(t){super(t),this.name="WorkerError"}}class j{constructor(t,n={}){if(this.graphs=[],this.heuristic=n.heuristic||"manhattan",this.heuristicOptions=n.heuristicOptions||{},Array.isArray(t)&&(this.heuristic=n.heuristic in h?n.heuristic:n.diagonals?n.torus?"diagonalTorus":"diagonal":n.torus?"manhattanTorus":"manhattan",this.heuristicOptions.x=e.fromArray.X(t,n.order),this.heuristicOptions.y=e.fromArray.Y(t,n.order),this.graphs=e.fromArray.apply(this,arguments),!Array.isArray(this.graphs)&&(this.graphs=[this.graphs])),n.thread&&("undefined"==typeof WorkerGlobalScope||!(self instanceof WorkerGlobalScope))){this.worker=null;try{this.worker=new Worker(n.thread)}catch(t){throw"file:"===window.location.protocol&&console.warn("WebWorkers in local files may not be supported by your browser."),new i(n.thread+" couldn't be opened.")}"cost"in n&&(n.cost=n.cost.toString()),this.worker.postMessage(["constructor",t,n]),this.path=(t,e,i={})=>{this._worker_path_callback=i.callback,delete i.callback,this.worker.postMessage(["path",t,e,i])},this.worker.onmessage=t=>{let e=JSON.parse(t.data);switch(e[0]){case"path":this._worker_path_callback(e[1])}}}}path(t,e,i={}){if(i.jps)return this.jps(t,e,i);let n=new g(t=>t.estimated),r=new Map,o=this.graphs[i.layer||0];if(t=o.node(t,!0),e=o.node(e,!0),n.add({node:t,estimated:0}),r.set(t,{score:0,from:null}),!i.static||o.connected(t,e))for(;n.size;){let t=n.pop().node;if(t===e)break;o.neighbors(t).map(s=>{let a=(r.has(t)?r.get(t).score:0)+o.cost(t,s);a<(r.has(s)?r.get(s).score:1/0)&&(r.set(s,{score:a,from:t}),n.set({node:s,estimated:a+h[i.heuristic||this.heuristic](s,e,i.heuristicOptions||this.heuristicOptions)}))}),n.delete(t)}let s=[];if(r.has(e)){let t=e;for(s.push(e);null!==(t=r.get(t).from);)s.push(t);s=s.reverse()}return i.callback&&i.callback(s,r),s}}if(j.JPS=class{constructor(){}static access(t,e,i,n){return t.adjacent(e,n?t.node(i,!0):i)}static neighborhood(t,e,i,n){let r=[],o=i.get(n).from||null;if(null===o)return e.neighbors(n);{let i={x:b(n.x-o.x),y:b(n.y-o.y)};if(0!=i.x&&0!=i.y){let o=t(n,{x:n.x+i.x,y:n.y},!0),s=t(n,{x:n.x,y:n.y+i.y},!0);(o||s)&&(r.push(e.node({x:n.x+i.x,y:n.y+i.y},!0)),o&&(r.push(e.node({x:n.x+i.x,y:n.y},!0)),!t(n,{x:n.x,y:n.y-i.y},!0)&&r.push(e.node({x:n.x+i.x,y:n.y-i.y},!0))),s&&(r.push(e.node({x:n.x,y:n.y+i.y},!0)),!t(n,{x:n.x-i.x,y:n.y},!0)&&r.push(e.node({x:n.x-i.x,y:n.y+i.y},!0))))}else t(n,{x:n.x+i.x,y:n.y+i.y},!0)&&(r.push(e.node({x:n.x+i.x,y:n.y+i.y},!0)),0==i.x?0!=i.y&&(!t(n,{x:n.x-1,y:n.y},!0)&&r.push(e.node({x:n.x-1,y:n.y+i.y},!0)),!t(n,{x:n.x+1,y:n.y},!0)&&r.push(e.node({x:n.x+1,y:n.y+i.y},!0))):(!t(n,{x:n.x,y:n.y-1},!0)&&r.push(e.node({x:n.x+i.x,y:n.y-1},!0)),!t(n,{x:n.x,y:n.y+1},!0)&&r.push(e.node({x:n.x+i.x,y:n.y+1},!0))))}return r.filter(t=>t)}static jump(t,e,i,n,r,o){for(;;){if(!t(o,r))return null;if(r.x===n.x&&r.y===n.y)return r;let s={x:b(r.x-o.x),y:b(r.y-o.y)};if(0!=s.x&&0!=s.y){if(!t(r,{x:r.x-s.x,y:r.y},!0)&&t(r,{x:r.x-s.x,y:r.y+s.y},!0)||!t(r,{x:r.x,y:r.y-s.y},!0)&&t(r,{x:r.x+s.x,y:r.y-s.y},!0))return r;let o=j.JPS.jump.bind(this,t,e,i,n);if(null!==o(e.node({x:r.x+s.x,y:r.y},!0),r)||null!==o(e.node({x:r.x,y:r.y+s.y},!0),r))return r}else if(0!=s.x){if(!t(r,{x:r.x,y:r.y-1},!0)&&t(r,{x:r.x+s.x,y:r.y-1},!0)||!t(r,{x:r.x,y:r.y+1},!0)&&t(r,{x:r.x+s.x,y:r.y+1},!0))return r}else if(0!=s.y&&(!t(r,{x:r.x-1,y:r.y},!0)&&t(r,{x:r.x-1,y:r.y+s.y},!0)||!t(r,{x:r.x+1,y:r.y},!0)&&t(r,{x:r.x+1,y:r.y+s.y},!0)))return r;o=r,r=e.node({x:r.x+s.x,y:r.y+s.y},!0)}return null}},j.prototype.jps=function(t,e,i={}){if(this.graphs[i.layer||0].TORUS)return console.warn("Torus map aren't yet supported by JPS"),i.callback&&i.callback([],new Map),[];let n=new g(t=>t.estimated),r=new Map,o=this.graphs[i.layer||0],s=null;t=o.node(t,!0),e=o.node(e,!0),n.add({node:t,estimated:0}),r.set(t,{score:0,from:null});let a=j.JPS.access.bind(this,o),u=j.JPS.neighborhood.bind(this,a,o,r),c=j.JPS.jump.bind(this,a,o,r,e);if(!i.static||o.connected(t,e))for(;n.size;){let t=n.pop().node;if(t===e)break;u(t).map(a=>{if(null!==(s=c(a,t))){let a=(r.has(t)?r.get(t).score:0)+o.cost(t,s);a<(r.has(s)?r.get(s).score:1/0)&&(r.set(s,{score:a,from:t,jumped:!0}),n.set({node:s,estimated:a+h[i.heuristic||this.heuristic](s,e,i.heuristicOptions||this.heuristicOptions)}))}}),n.delete(t)}let l=[];if(r.has(e)){let i=e;for(;i.x!=t.x||i.y!=t.y;)for(let t=r.get(i).from;i.x!=t.x||i.y!=t.y;)l.push(i),i=o.node({x:i.x+b(t.x-i.x),y:i.y+b(t.y-i.y)},!0);l.push(i),l.reverse()}return i.callback&&i.callback(l,r),l},"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope){let a;onmessage=function(b){let c=b.data;switch(c[0]){case"constructor":if("cost"in c[2]){let a=/^\((.*?)\)\s*=>\s*{/.test(c[2].cost),b=/^function /.test(c[2].cost);c[2].cost=eval(`(${a||b?"":"function "}${c[2].cost})`)}a=new j(c[1],c[2]);break;case"path":postMessage(JSON.stringify(["path",a.path(c[1],c[2],c[3])]))}}}a.Lowlight.Astar={Graph:e,Node:f,BinaryHeap:g,Heuristic:h,Configuration:j,WorkerError:i}}("undefined"==typeof window?this:window)},function(t,e,i){(function(t){var n;!function(t,r,o){function s(t){var e,i=this,n=(e=4022871197,function(t){t=String(t);for(var i=0;i<t.length;i++){var n=.02519603282416938*(e+=t.charCodeAt(i));n-=e=n>>>0,e=(n*=e)>>>0,e+=4294967296*(n-=e)}return 2.3283064365386963e-10*(e>>>0)});i.next=function(){var t=2091639*i.s0+2.3283064365386963e-10*i.c;return i.s0=i.s1,i.s1=i.s2,i.s2=t-(i.c=0|t)},i.c=1,i.s0=n(" "),i.s1=n(" "),i.s2=n(" "),i.s0-=n(t),i.s0<0&&(i.s0+=1),i.s1-=n(t),i.s1<0&&(i.s1+=1),i.s2-=n(t),i.s2<0&&(i.s2+=1),n=null}function a(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function u(t,e){var i=new s(t),n=e&&e.state,r=i.next;return r.int32=function(){return 4294967296*i.next()|0},r.double=function(){return r()+11102230246251565e-32*(2097152*r()|0)},r.quick=r,n&&("object"==typeof n&&a(n,i),r.state=function(){return a(i,{})}),r}r&&r.exports?r.exports=u:i(6)&&i(10)?void 0===(n=function(){return u}.call(e,i,e,r))||(r.exports=n):this.alea=u}(0,t,i(6))}).call(this,i(9)(t))},function(t,e,i){(function(t){var n;!function(t,r,o){function s(t){var e=this,i="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:i+=t;for(var n=0;n<i.length+64;n++)e.x^=0|i.charCodeAt(n),e.next()}function a(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function u(t,e){var i=new s(t),n=e&&e.state,r=function(){return(i.next()>>>0)/4294967296};return r.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=i.next,r.quick=r,n&&("object"==typeof n&&a(n,i),r.state=function(){return a(i,{})}),r}r&&r.exports?r.exports=u:i(6)&&i(10)?void 0===(n=function(){return u}.call(e,i,e,r))||(r.exports=n):this.xor128=u}(0,t,i(6))}).call(this,i(9)(t))},function(t,e,i){(function(t){var n;!function(t,r,o){function s(t){var e=this,i="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:i+=t;for(var n=0;n<i.length+64;n++)e.x^=0|i.charCodeAt(n),n==i.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function a(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function u(t,e){var i=new s(t),n=e&&e.state,r=function(){return(i.next()>>>0)/4294967296};return r.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=i.next,r.quick=r,n&&("object"==typeof n&&a(n,i),r.state=function(){return a(i,{})}),r}r&&r.exports?r.exports=u:i(6)&&i(10)?void 0===(n=function(){return u}.call(e,i,e,r))||(r.exports=n):this.xorwow=u}(0,t,i(6))}).call(this,i(9)(t))},function(t,e,i){(function(t){var n;!function(t,r,o){function s(t){var e=this;e.next=function(){var t,i,n=e.x,r=e.i;return t=n[r],i=(t^=t>>>7)^t<<24,i^=(t=n[r+1&7])^t>>>10,i^=(t=n[r+3&7])^t>>>3,i^=(t=n[r+4&7])^t<<7,t=n[r+7&7],i^=(t^=t<<13)^t<<9,n[r]=i,e.i=r+1&7,i},function(t,e){var i,n=[];if(e===(0|e))n[0]=e;else for(e=""+e,i=0;i<e.length;++i)n[7&i]=n[7&i]<<15^e.charCodeAt(i)+n[i+1&7]<<13;for(;n.length<8;)n.push(0);for(i=0;i<8&&0===n[i];++i);for(8==i?n[7]=-1:n[i],t.x=n,t.i=0,i=256;i>0;--i)t.next()}(e,t)}function a(t,e){return e.x=t.x.slice(),e.i=t.i,e}function u(t,e){null==t&&(t=+new Date);var i=new s(t),n=e&&e.state,r=function(){return(i.next()>>>0)/4294967296};return r.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=i.next,r.quick=r,n&&(n.x&&a(n,i),r.state=function(){return a(i,{})}),r}r&&r.exports?r.exports=u:i(6)&&i(10)?void 0===(n=function(){return u}.call(e,i,e,r))||(r.exports=n):this.xorshift7=u}(0,t,i(6))}).call(this,i(9)(t))},function(t,e,i){(function(t){var n;!function(t,r,o){function s(t){var e=this;e.next=function(){var t,i,n=e.w,r=e.X,o=e.i;return e.w=n=n+1640531527|0,i=r[o+34&127],t=r[o=o+1&127],i^=i<<13,t^=t<<17,i^=i>>>15,t^=t>>>12,i=r[o]=i^t,e.i=o,i+(n^n>>>16)|0},function(t,e){var i,n,r,o,s,a=[],u=128;for(e===(0|e)?(n=e,e=null):(e+="\0",n=0,u=Math.max(u,e.length)),r=0,o=-32;o<u;++o)e&&(n^=e.charCodeAt((o+32)%e.length)),0===o&&(s=n),n^=n<<10,n^=n>>>15,n^=n<<4,n^=n>>>13,o>=0&&(s=s+1640531527|0,r=0==(i=a[127&o]^=n+s)?r+1:0);for(r>=128&&(a[127&(e&&e.length||0)]=-1),r=127,o=512;o>0;--o)n=a[r+34&127],i=a[r=r+1&127],n^=n<<13,i^=i<<17,n^=n>>>15,i^=i>>>12,a[r]=n^i;t.w=s,t.X=a,t.i=r}(e,t)}function a(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function u(t,e){null==t&&(t=+new Date);var i=new s(t),n=e&&e.state,r=function(){return(i.next()>>>0)/4294967296};return r.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=i.next,r.quick=r,n&&(n.X&&a(n,i),r.state=function(){return a(i,{})}),r}r&&r.exports?r.exports=u:i(6)&&i(10)?void 0===(n=function(){return u}.call(e,i,e,r))||(r.exports=n):this.xor4096=u}(0,t,i(6))}).call(this,i(9)(t))},function(t,e,i){(function(t){var n;!function(t,r,o){function s(t){var e=this,i="";e.next=function(){var t=e.b,i=e.c,n=e.d,r=e.a;return t=t<<25^t>>>7^i,i=i-n|0,n=n<<24^n>>>8^r,r=r-t|0,e.b=t=t<<20^t>>>12^i,e.c=i=i-n|0,e.d=n<<16^i>>>16^r,e.a=r-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):i+=t;for(var n=0;n<i.length+20;n++)e.b^=0|i.charCodeAt(n),e.next()}function a(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function u(t,e){var i=new s(t),n=e&&e.state,r=function(){return(i.next()>>>0)/4294967296};return r.double=function(){do{var t=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},r.int32=i.next,r.quick=r,n&&("object"==typeof n&&a(n,i),r.state=function(){return a(i,{})}),r}r&&r.exports?r.exports=u:i(6)&&i(10)?void 0===(n=function(){return u}.call(e,i,e,r))||(r.exports=n):this.tychei=u}(0,t,i(6))}).call(this,i(9)(t))},function(t,e,i){var n;!function(r,o,s){var a,u=s.pow(256,6),c=s.pow(2,52),l=2*c;function h(t,e,i){var n=[],h=g(function t(e,i){var n,r=[],o=typeof e;if(i&&"object"==o)for(n in e)try{r.push(t(e[n],i-1))}catch(t){}return r.length?r:"string"==o?e:e+"\0"}((e=1==e?{entropy:!0}:e||{}).entropy?[t,p(o)]:null==t?function(){try{var t;return a&&(t=a.randomBytes)?t=t(256):(t=new Uint8Array(256),(r.crypto||r.msCrypto).getRandomValues(t)),p(t)}catch(t){var e=r.navigator,i=e&&e.plugins;return[+new Date,r,i,r.screen,p(o)]}}():t,3),n),y=new f(n),v=function(){for(var t=y.g(6),e=u,i=0;t<c;)t=256*(t+i),e*=256,i=y.g(1);for(;t>=l;)t/=2,e/=2,i>>>=1;return(t+i)/e};return v.int32=function(){return 0|y.g(4)},v.quick=function(){return y.g(4)/4294967296},v.double=v,g(p(y.S),o),(e.pass||i||function(t,e,i,n){return n&&(n.S&&d(n,y),t.state=function(){return d(y,{})}),i?(s.random=t,e):t})(v,h,"global"in e?e.global:this==s,e.state)}function f(t){var e,i=t.length,n=this,r=0,o=n.i=n.j=0,s=n.S=[];for(i||(t=[i++]);r<256;)s[r]=r++;for(r=0;r<256;r++)s[r]=s[o=255&o+t[r%i]+(e=s[r])],s[o]=e;(n.g=function(t){for(var e,i=0,r=n.i,o=n.j,s=n.S;t--;)e=s[r=255&r+1],i=256*i+s[255&(s[r]=s[o=255&o+e])+(s[o]=e)];return n.i=r,n.j=o,i})(256)}function d(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function g(t,e){for(var i,n=t+"",r=0;r<n.length;)e[255&r]=255&(i^=19*e[255&r])+n.charCodeAt(r++);return p(e)}function p(t){return String.fromCharCode.apply(0,t)}if(g(s.random(),o),t.exports){t.exports=h;try{a=i(20)}catch(t){}}else void 0===(n=function(){return h}.call(e,i,e,t))||(t.exports=n)}("undefined"!=typeof self?self:this,[],Math)},function(t,e){},function(t,e,i){var n=i(3);t.exports=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=n(t)););return t}},function(t,e){function i(e,n){return t.exports=i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},i(e,n)}t.exports=i},function(t,e){function i(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?t.exports=i=function(t){return typeof t}:t.exports=i=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(e)}t.exports=i},function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},function(t,e,i){"use strict";i.r(e),i.d(e,"GameConstants",(function(){return n})),i.d(e,"Event",(function(){return u})),i.d(e,"Reactor",(function(){return c})),i.d(e,"Grid",(function(){return p})),i.d(e,"Snake",(function(){return I})),i.d(e,"GameGroup",(function(){return M})),i.d(e,"GameUtils",(function(){return l})),i.d(e,"Position",(function(){return h})),i.d(e,"GameEngine",(function(){return Rt}));var n={CaseType:{EMPTY:0,SNAKE:1,FRUIT:2,WALL:3,SNAKE_DEAD:4,SURROUNDED:5,FRUIT_GOLD:6,CROSSED:7},PlayerType:{AI:"PLAYER_AI",HUMAN:"PLAYER_HUMAN",HYBRID_HUMAN_AI:"PLAYER_HYBRID_HUMAN_AI"},AiLevel:{RANDOM:"AI_LEVEL_RANDOM",LOW:"AI_LEVEL_LOW",DEFAULT:"AI_LEVEL_DEFAULT",HIGH:"AI_LEVEL_HIGH",ULTRA:"AI_LEVEL_ULTRA",CUSTOM:"AI_LEVEL_CUSTOM"},OutputType:{TEXT:"OUTPUT_TEXT",GRAPHICAL:"OUTPUT_GRAPHICAL"},Setting:{CANVAS_WIDTH:800,CANVAS_HEIGHT:600,FONT_FAMILY:"Delius",FONT_SIZE:32,HEADER_HEIGHT_DEFAULT:75,TARGET_FPS:60,TIME_MULTIPLIER:15,IMAGE_SNAKE_HUE:75,IMAGE_SNAKE_SATURATION:50,IMAGE_SNAKE_VALUE:77,CARS_TO_PRERENDER:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","×"],APP_VERSION:"2.1.1",DATE_VERSION:"06/01/2020",PROB_GOLD_FRUIT_1_PLAYER:100,PROB_GOLD_FRUIT_MULTIPLE_PLAYERS:50,INFO_NOTIF_COLOR:"rgba(52, 152, 219, 0.5)",ERROR_NOTIF_COLOR:"rgba(231, 76, 60, 0.5)"},Direction:{UP:0,TOP:0,RIGHT:1,BOTTOM:2,DOWN:2,LEFT:3,ANGLE_1:4,ANGLE_2:5,ANGLE_3:6,ANGLE_4:7},Key:{UP:38,RIGHT:39,BOTTOM:40,LEFT:37,ENTER:13},Error:{ROOM_NOT_FOUND:"ROOM_NOT_FOUND",ROOM_ALREADY_JOINED:"ROOM_ALREADY_JOINED",INVALID_SETTINGS:"INVALID_SETTINGS",MAX_ROOM_LIMIT_REACHED:"MAX_ROOM_LIMIT_REACHED",AUTHENTICATION_REQUIRED:"AUTHENTICATION_REQUIRED",ALREADY_CREATED_ROOM:"ALREADY_CREATED_ROOM",BANNED:"BANNED",DISCONNECTED:"DISCONNECTED"},GameState:{STARTING:"STARTING",STARTED:"STARTED",SEARCHING_PLAYERS:"SEARCHING_PLAYERS",AUTHENTICATION_SUCCESS:"AUTHENTICATION_SUCCESS"}},r=i(1),o=i.n(r),s=i(2),a=i.n(s),u=function(){function t(e){o()(this,t),this.name=e,this.callbacks=[]}return a()(t,[{key:"registerCallback",value:function(t){this.callbacks.push(t)}}]),t}(),c=function(){function t(){o()(this,t),this.events={}}return a()(t,[{key:"registerEvent",value:function(t){this.events[t]=new u(t)}},{key:"dispatchEvent",value:function(t,e){for(var i=this.events[t].callbacks,n=0,r=i.length;n<r;n++)i[n](e)}},{key:"addEventListener",value:function(t,e){this.events[t].registerCallback(e)}}]),t}(),l={randRange:function(t,e,i){return Math.floor((i?i():Math.random())*(e-t+1))+t},addHue:function(t,e){var i=t+e;return i>360?i-360:i<0?360+i:i},shuffle:function(t,e){for(var i,n,r=t.length-1;r>0;r--)i=Math.floor((e?e():Math.random())*(r+1)),n=t[r],t[r]=t[i],t[i]=n;return t},millisecondsFormat:function(t){return t/=1e3,("0"+Math.trunc(t/60)).slice(-2)+":"+("0"+Math.trunc(t%60)).slice(-2)},secondsFormat:function(t){return this.millisecondsFormat(1e3*t)}},h=function(){function t(e,i,n){o()(this,t),this.x=e,this.y=i,this.direction=n}return a()(t,[{key:"copy",value:function(){return new t(this.x,this.y,this.direction)}},{key:"convertToKeyDirection",value:function(){switch(this.direction){case n.Direction.UP:return n.Key.UP;case n.Direction.RIGHT:return n.Key.RIGHT;case n.Direction.LEFT:return n.Key.LEFT;case n.Direction.BOTTOM:return n.Key.BOTTOM;default:return this.direction}}},{key:"convertToSimpleDirection",value:function(){switch(this.direction){case n.Key.UP:return n.Direction.UP;case n.Key.RIGHT:return n.Direction.RIGHT;case n.Key.LEFT:return n.Direction.LEFT;case n.Key.BOTTOM:return n.Direction.BOTTOM;default:return this.direction}}},{key:"equals",value:function(t){return null!=t&&(this.x==t.x&&this.y==t.y)}}]),t}(),f=i(11),d=i.n(f),g=i(12),p=function(){function t(e,i,r,s,a,u,c,l,f){o()(this,t),this.width=null==e?20:e,this.height=null==i?20:i,this.generateWalls=null!=r&&r,this.borderWalls=null!=s&&s,this.maze=null!=a&&a,this.mazeFirstPosition=new h(1,1,n.Direction.RIGHT),this.mazeForceAuto=null!=c&&c,this.grid,this.initialGrid,this.fruitPos,this.fruitPosGold,this.customGrid=u,this.seedGrid=l?""+parseInt(l):void 0,this.seedGame=l?""+parseInt(f):void 0,this.rngGrid,this.rngGame}return a()(t,[{key:"init",value:function(){if(null!=this.customGrid||null!=this.initialGrid){var t;t=null!=this.initialGrid?this.initialGrid:this.customGrid,this.height=t.length,this.width=t[0].length,this.initialGrid=new Array(this.height),this.grid=new Array(this.height);for(var e=0;e<this.height;e++)this.initialGrid[e]=t[e].slice(),this.grid[e]=t[e].slice()}else{this.grid=new Array(this.height);for(var i=0;i<this.height;i++){this.grid[i]=new Array(this.width);for(var r=0;r<this.width;r++)this.borderWalls&&(0==i||i==this.height-1||0==r||r==this.width-1)||this.generateWalls&&this.rngGrid()>.65||this.maze?this.grid[i][r]=n.CaseType.WALL:this.grid[i][r]=n.CaseType.EMPTY}this.maze?this.generateMaze():this.generateWalls&&this.fixWalls(this.borderWalls)}this.fruitPosGold=null}},{key:"reset",value:function(){this.grid=void 0,this.initialGrid=void 0,this.fruitPos=void 0,this.fruitPosGold=void 0,this.rngGrid=new d.a(this.seedGrid),this.rngGame=new d.a(this.seedGame)}},{key:"fixWalls",value:function(t){var e,i,r,o;t?(e=1,r=this.height-1,i=1,o=this.width-1):(e=0,r=this.height,i=0,o=this.width);for(var s=e;s<r;s++)for(var a=i;a<o;a++){var u=new h(a,s),c=this.getNextPosition(u,n.Direction.UP),l=this.getNextPosition(c,n.Direction.LEFT),f=this.getNextPosition(c,n.Direction.RIGHT),d=this.getNextPosition(u,n.Direction.BOTTOM),g=this.getNextPosition(d,n.Direction.LEFT),p=this.getNextPosition(d,n.Direction.RIGHT);this.get(l)!=n.CaseType.WALL&&this.get(f)!=n.CaseType.WALL&&this.get(g)!=n.CaseType.WALL&&this.get(p)!=n.CaseType.WALL||this.set(n.CaseType.EMPTY,u)}}},{key:"maze_recursion",value:function(t,e){for(var i=l.shuffle([n.Direction.UP,n.Direction.RIGHT,n.Direction.BOTTOM,n.Direction.LEFT],this.rngGrid),r=0;r<i.length;r++)switch(i[r]){case n.Direction.UP:if(t-2<=0)continue;this.get(new h(e,t-2))!=n.CaseType.EMPTY&&(this.set(n.CaseType.EMPTY,new h(e,t-2)),this.set(n.CaseType.EMPTY,new h(e,t-1)),this.maze_recursion(t-2,e));break;case n.Direction.RIGHT:if(e+2>=this.width-1)continue;this.get(new h(e+2,t))!=n.CaseType.EMPTY&&(this.set(n.CaseType.EMPTY,new h(e+2,t)),this.set(n.CaseType.EMPTY,new h(e+1,t)),this.maze_recursion(t,e+2));break;case n.Direction.BOTTOM:if(t+2>=this.height-1)continue;this.get(new h(e,t+2))!=n.CaseType.EMPTY&&(this.set(n.CaseType.EMPTY,new h(e,t+2)),this.set(n.CaseType.EMPTY,new h(e,t+1)),this.maze_recursion(t+2,e));break;case n.Direction.LEFT:if(e-2<=0)continue;this.get(new h(e-2,t))!=n.CaseType.EMPTY&&(this.set(n.CaseType.EMPTY,new h(e-2,t)),this.set(n.CaseType.EMPTY,new h(e-1,t)),this.maze_recursion(t,e-2))}}},{key:"generateMaze",value:function(){this.mazeFirstPosition=new h(1,1,n.Direction.RIGHT),this.set(n.CaseType.EMPTY,this.mazeFirstPosition),this.maze_recursion(1,1)}},{key:"set",value:function(t,e){this.grid[e.y][e.x]=t}},{key:"get",value:function(t){return this.grid[t.y][t.x]}},{key:"valToChar",value:function(t){switch(t){case n.CaseType.EMPTY:return"-";case n.CaseType.SNAKE:return"o";case n.CaseType.SNAKE_DEAD:return"O";case n.CaseType.FRUIT:return"x";case n.CaseType.WALL:return"#";case n.CaseType.SURROUNDED:return"/";case n.CaseType.FRUIT_GOLD:return"X"}}},{key:"getImageCase",value:function(t){switch(this.get(t)){case n.CaseType.WALL:return"wall.png";case n.CaseType.FRUIT:return"fruit.png";case n.CaseType.FRUIT_GOLD:return"fruit_gold.png";case n.CaseType.EMPTY:case n.CaseType.SNAKE:case n.CaseType.SNAKE_DEAD:case n.CaseType.SURROUNDED:case n.CaseType.CROSSED:return""}return"unknown.png"}},{key:"getGraph",value:function(t){for(var e=new Array(this.height),i=0;i<this.height;i++){e[i]=new Array(this.width);for(var r=0;r<this.width;r++){var o=new h(r,i);t&&this.get(o)==n.CaseType.SNAKE?e[i][r]=0:this.isDeadPosition(o)?e[i][r]=1:e[i][r]=0}}return e}},{key:"getRandomPosition",value:function(){return new h(l.randRange(0,this.width-1,this.rngGame),l.randRange(0,this.height-1,this.rngGame))}},{key:"setFruit",value:function(t,e){var i,r,o=[1];if(e||null==this.fruitPos||this.get(this.fruitPos)!=n.CaseType.FRUIT||this.set(n.CaseType.EMPTY,this.fruitPos),!(this.getTotal(n.CaseType.EMPTY)>0))return!!(this.getTotal(n.CaseType.EMPTY)<=0&&this.fruitPosGold);do{if(i=this.getRandomPosition(),(r=this.detectCorridor(i))&&this.get(i)==n.CaseType.EMPTY&&this.set(n.CaseType.SURROUNDED,i),this.getTotal(n.CaseType.EMPTY)<=0)return!!this.fruitPosGold}while(this.get(i)!=n.CaseType.EMPTY||this.isFruitSurrounded(i,!0)||this.maze&&!this.testFruitMaze(i,o)||r);return e?(this.fruitPosGold=i,this.set(n.CaseType.FRUIT_GOLD,i)):(this.fruitPos=i,this.set(n.CaseType.FRUIT,i)),this.maze||null!=this.fruitPosGold||1!=l.randRange(1,t>1?n.Setting.PROB_GOLD_FRUIT_MULTIPLE_PLAYERS:n.Setting.PROB_GOLD_FRUIT_1_PLAYER,this.rngGame)||this.setFruit(t,!0),!0}},{key:"testFruitMaze",value:function(t,e){var i=this.getGraph(!0);return new g.Astar.Configuration(i,{order:"yx",torus:!1,diagonals:!1,cutting:!1,cost:function(t,e){return 1==e?null:1}}).path({x:this.mazeFirstPosition.x,y:this.mazeFirstPosition.y},{x:t.x,y:t.y}).length<Math.ceil(this.getTotal(n.CaseType.EMPTY)/(1*Math.ceil(e[0]/4)))?(e[0]++,!1):(e[0]++,!0)}},{key:"isCaseSurrounded",value:function(t,e,i,r){if(null==t||null==t)return!1;for(var o=JSON.parse(JSON.stringify(this.grid)),s=[t];s.length>0;){var a=s[0];s.shift();for(var u=[this.getNextPosition(a,n.Direction.UP),this.getNextPosition(a,n.Direction.BOTTOM),this.getNextPosition(a,n.Direction.LEFT),this.getNextPosition(a,n.Direction.RIGHT)],c=0;c<u.length;c++)if(o[u[c].y][u[c].x]!=n.CaseType.CROSSED&&r.indexOf(this.get(u[c]))>-1){if(s.push(u[c]),i.indexOf(this.get(u[c]))>-1)return!1;e&&this.get(u[c])==n.CaseType.EMPTY?(this.set(n.CaseType.SURROUNDED,u[c]),o[u[c].y][u[c].x]=n.CaseType.SURROUNDED):o[u[c].y][u[c].x]=n.CaseType.CROSSED}}return(e&&(this.get(t)==n.CaseType.EMPTY||this.get(t)==n.CaseType.FRUIT)||this.get(t)==n.CaseType.FRUIT_GOLD)&&this.set(n.CaseType.SURROUNDED,t),!0}},{key:"isFruitSurrounded",value:function(t,e){var i=this.isCaseSurrounded(t,!1,[n.CaseType.SNAKE],[n.CaseType.EMPTY,n.CaseType.SNAKE]);return i&&e&&this.isCaseSurrounded(t,!0,[n.CaseType.SNAKE],[n.CaseType.EMPTY,n.CaseType.SNAKE]),i}},{key:"detectCorridor",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:JSON.parse(JSON.stringify(this.grid));if(this.maze)return!1;var i=this.getNextPosition(t,n.Direction.TOP),r=this.getNextPosition(t,n.Direction.BOTTOM),o=this.getNextPosition(t,n.Direction.RIGHT),s=this.getNextPosition(t,n.Direction.LEFT),a=this.isDeadPosition(i,!0,!0),u=this.isDeadPosition(r,!0,!0),c=this.isDeadPosition(o,!0,!0),l=this.isDeadPosition(s,!0,!0),h=a+u+c+l;if(h>=3)return!0;if(h<=1||this.get(t)!=n.CaseType.EMPTY)return!1;e[t.y][t.x]=n.CaseType.CROSSED;var f=e[i.y][i.x]!=n.CaseType.CROSSED&&this.detectCorridor(i,e),d=e[r.y][r.x]!=n.CaseType.CROSSED&&this.detectCorridor(r,e),g=e[s.y][s.x]!=n.CaseType.CROSSED&&this.detectCorridor(s,e),p=e[o.y][o.x]!=n.CaseType.CROSSED&&this.detectCorridor(o,e);return!!(d||f||g||p)}},{key:"getOnLine",value:function(t,e){for(var i=0,n=0;n<this.width;n++)this.get(new h(n,e))==t&&i++;return i}},{key:"getTotal",value:function(t){for(var e=0,i=0;i<this.height;i++)e+=this.getOnLine(t,i);return e}},{key:"getNextPosition",value:function(t,e){var i=new h(t.x,t.y,e);switch(e){case n.Direction.LEFT:i.x--,i.direction=n.Direction.LEFT;break;case n.Direction.UP:i.y--,i.direction=n.Direction.UP;break;case n.Direction.RIGHT:i.x++,i.direction=n.Direction.RIGHT;break;case n.Direction.BOTTOM:i.y++,i.direction=n.Direction.BOTTOM;break;case n.Key.LEFT:i.x--,i.direction=n.Key.LEFT;break;case n.Key.UP:i.y--,i.direction=n.Key.UP;break;case n.Key.RIGHT:i.x++,i.direction=n.Direction.RIGHT;break;case n.Key.BOTTOM:i.y++,i.direction=n.Direction.BOTTOM}return i.x<0?i.x=this.width-1:i.x>=this.width&&(i.x=0),i.y<0?i.y=this.height-1:i.y>=this.height&&(i.y=0),i}},{key:"getDirectionTo",value:function(t,e){return this.getNextPosition(t,n.Direction.UP).equals(e)?n.Direction.UP:this.getNextPosition(t,n.Direction.BOTTOM).equals(e)?n.Direction.BOTTOM:this.getNextPosition(t,n.Direction.RIGHT).equals(e)?n.Direction.RIGHT:this.getNextPosition(t,n.Direction.LEFT).equals(e)?n.Direction.LEFT:-1}},{key:"isDeadPosition",value:function(t,e,i){return!e&&this.get(t)==n.CaseType.SNAKE||this.get(t)==n.CaseType.WALL||this.get(t)==n.CaseType.SNAKE_DEAD||i&&this.get(t)==n.CaseType.SURROUNDED}},{key:"toString",value:function(){for(var t="",e=0;e<this.height;e++){for(var i=0;i<this.width;i++)t+=this.valToChar(this.get(new h(i,e)))+" ";t+="\n"}return t}}]),t}(),y=function(){function t(){o()(this,t),this.aiFruitGoal=n.CaseType.FRUIT,this._aiLevelText="custom"}return a()(t,[{key:"ai",value:function(t){var e=t.getHeadPosition(),i=t.grid.fruitPos,r=t.grid.fruitPosGold;if(null!=i){var o=Math.abs(i.x-e.x)+Math.abs(i.y-e.y),s=null!=r?Math.abs(r.x-e.x)+Math.abs(r.y-e.y):-1;null!=r&&t.grid.get(r)==n.CaseType.FRUIT_GOLD&&this.aiFruitGoal==n.CaseType.FRUIT?this.aiFruitGoal=s<o?n.CaseType.FRUIT_GOLD:n.CaseType.FRUIT:null!=r&&t.grid.get(r)==n.CaseType.FRUIT_GOLD||(this.aiFruitGoal=n.CaseType.FRUIT)}return null}},{key:"aiLevelText",get:function(){return this._aiLevelText}}]),t}(),v=i(7),m=i.n(v),x=i(4),k=i.n(x),w=i(5),T=i.n(w),b=i(3),A=i.n(b);function E(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=A()(t);if(e){var r=A()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return T()(this,i)}}var S=function(t){k()(i,t);var e=E(i);function i(){var t;return o()(this,i),(t=e.call(this))._aiLevelText="random",t}return a()(i,[{key:"ai",value:function(t){m()(A()(i.prototype),"ai",this).call(this,t);var e=t.getHeadPosition(),r=t.grid.isDeadPosition(t.getNextPosition(e,n.Key.UP)),o=t.grid.isDeadPosition(t.getNextPosition(e,n.Key.LEFT)),s=t.grid.isDeadPosition(t.getNextPosition(e,n.Key.BOTTOM)),a=t.grid.isDeadPosition(t.getNextPosition(e,n.Key.RIGHT));if(r&&o&&s&&a)return n.Key.UP;for(var u=null;null==u||t.grid.isDeadPosition(t.getNextPosition(e,u));){switch(l.randRange(1,4,t.grid?t.grid.rngGame:null)){case 1:u=n.Key.UP;break;case 2:u=n.Key.LEFT;break;case 3:u=n.Key.BOTTOM;break;case 4:u=n.Key.RIGHT}}return u}}]),i}(y);function R(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=A()(t);if(e){var r=A()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return T()(this,i)}}var P=function(t){k()(i,t);var e=R(i);function i(){var t;return o()(this,i),(t=e.call(this))._aiLevelText="low",t}return a()(i,[{key:"ai",value:function(t){if(m()(A()(i.prototype),"ai",this).call(this,t),null!=t.grid.fruitPos){var e=t.getHeadPosition(),r=this.aiFruitGoal==n.CaseType.FRUIT_GOLD?t.grid.fruitPosGold:t.grid.fruitPos,o=n.Key.RIGHT;r.x>e.x?o=r.x-e.x>t.grid.width/2?n.Key.LEFT:n.Key.RIGHT:r.x<e.x?o=e.x-r.x>t.grid.width/2?n.Key.RIGHT:n.Key.LEFT:r.y<e.y?o=e.y-r.y>t.grid.height/2?n.Key.BOTTOM:n.Key.UP:r.y>e.y&&(o=r.y-e.y>t.grid.height/2?n.Key.UP:n.Key.BOTTOM);var s=t.getNextPosition(e,o);if(t.grid.isDeadPosition(s)){for(var a=this.direction,u=null,c=1;c<t.queue.length;c++)if(t.get(c).direction!=a){u=t.get(c).direction;break}s=t.getNextPosition(e,u),t.grid.isDeadPosition(s)?t.grid.isDeadPosition(t.getNextPosition(e,n.Key.UP))?t.grid.isDeadPosition(t.getNextPosition(e,n.Key.RIGHT))?t.grid.isDeadPosition(t.getNextPosition(e,n.Key.BOTTOM))?t.grid.isDeadPosition(t.getNextPosition(e,n.Key.LEFT))||(o=n.Key.LEFT):o=n.Key.BOTTOM:o=n.Key.RIGHT:o=n.Key.UP:o=s.convertToKeyDirection()}return o}}}]),i}(y);function O(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=A()(t);if(e){var r=A()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return T()(this,i)}}var D=function(t){k()(i,t);var e=O(i);function i(t){var n;return o()(this,i),(n=e.call(this)).enableTorus=t,n._aiLevelText="normal",n}return a()(i,[{key:"ai",value:function(t){m()(A()(i.prototype),"ai",this).call(this,t);var e=t.getHeadPosition(),r=t.grid.fruitPos,o=t.grid.fruitPosGold;if(t.grid.fruitPos){var s=t.grid.getGraph(!1),a=new g.Astar.Configuration(s,{order:"yx",torus:!!this.enableTorus,diagonals:!1,cutting:!1,static:!0,cost:function(t,e){return 1==e?null:1}}),u=a.path({x:e.x,y:e.y},{x:this.aiFruitGoal==n.CaseType.FRUIT_GOLD?o.x:r.x,y:this.aiFruitGoal==n.CaseType.FRUIT_GOLD?o.y:r.y});if(u.length<1&&(u=a.path({x:e.x,y:e.y},{x:this.aiFruitGoal!=n.CaseType.FRUIT_GOLD&&o?o.x:r.x,y:this.aiFruitGoal!=n.CaseType.FRUIT_GOLD&&o?o.y:r.y})),u.length>1){var c=new h(u[1].x,u[1].y);return new h(null,null,t.getDirectionTo(e,c)).convertToKeyDirection()}u=null}return null}}]),i}(y);function L(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=A()(t);if(e){var r=A()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return T()(this,i)}}var C=function(t){k()(i,t);var e=L(i);function i(t){var n;return o()(this,i),(n=e.call(this,!0)).aiLow=new P(t),n._aiLevelText="high",n}return a()(i,[{key:"ai",value:function(t){var e=m()(A()(i.prototype),"ai",this).call(this,t);return e||this.aiLow.ai(t)}}]),i}(D),I=function(){function t(e,i,r,s,a,u,c,l){o()(this,t),this.direction=null==e?n.Direction.RIGHT:e,this.initialDirection=this.direction,this.initialLength=null==i?3:i,this.initTriedDirections=[],this.errorInit=!1,this.grid=r||new p,this.queue=[],this.lastKey=-1,this.lastTail,this.lastTailMoved,this.ticksDead=0,this.player=null==s?n.PlayerType.HUMAN:s,this.aiLevel=null==a?n.AiLevel.DEFAULT:a,this.autoRetry=null!=u&&u,this.score=0,this.gameOver=!1,this.scoreMax=!1,this.color,this.name=null==c?"Snake":c,this.snakeAI=new y,this.customAI=l,this.ticksWithoutAction=0,this.initAI()}return a()(t,[{key:"init",value:function(){if(this.initialLength<=0)return this.errorInit=!0,!1;this.grid.maze&&this.initTriedDirections.length<=0&&(this.initialDirection=this.grid.mazeFirstPosition.direction,this.direction=this.initialDirection);var t=0,e=0;if(this.initialDirection==n.Direction.RIGHT&&-1==this.initTriedDirections.indexOf(n.Direction.RIGHT)||this.initialDirection==n.Direction.LEFT&&-1==this.initTriedDirections.indexOf(n.Direction.LEFT)){for(var i=0;i<this.grid.height;i++)for(var r=0,o=0;o<this.grid.width;o++)if(this.grid.get(new h(o,i))==n.CaseType.EMPTY?r++:r=0,r>=this.initialLength){t++;break}}else if(this.initialDirection==n.Direction.UP&&-1==this.initTriedDirections.indexOf(n.Direction.UP)||this.initialDirection==n.Direction.BOTTOM&&-1==this.initTriedDirections.indexOf(n.Direction.BOTTOM))for(var s=0;s<this.grid.width;s++)for(var a=0,u=0;u<this.grid.height;u++)if(this.grid.get(new h(s,u))==n.CaseType.EMPTY?a++:a=0,a>=this.initialLength){e++;break}if(this.initTriedDirections.push(this.initialDirection),t<=0&&(this.initialDirection==n.Direction.RIGHT||this.initialDirection==n.Direction.LEFT)||e<=0&&(this.initialDirection==n.Direction.UP||this.initialDirection==n.Direction.BOTTOM))return-1==this.initTriedDirections.indexOf(n.Direction.RIGHT)?(this.initialDirection=n.Direction.RIGHT,this.direction=n.Direction.RIGHT,this.init()):-1==this.initTriedDirections.indexOf(n.Direction.LEFT)?(this.initialDirection=n.Direction.LEFT,this.direction=n.Direction.LEFT,this.init()):-1==this.initTriedDirections.indexOf(n.Direction.UP)?(this.initialDirection=n.Direction.UP,this.direction=n.Direction.UP,this.init()):-1==this.initTriedDirections.indexOf(n.Direction.BOTTOM)?(this.initialDirection=n.Direction.BOTTOM,this.direction=n.Direction.BOTTOM,this.init()):(this.errorInit=!0,!1);for(var c,l,f=!0,d=[];f;){f=!1,c=this.grid.maze?this.grid.mazeFirstPosition:this.grid.getRandomPosition(),l=new h(c.x,c.y,this.initialDirection),d=[];for(var g=this.initialLength-1;g>=0;g--)g<this.initialLength-1&&(this.initialDirection==n.Direction.RIGHT?l=this.grid.getNextPosition(new h(l.x,l.y,this.initialDirection),n.Direction.RIGHT):this.initialDirection==n.Direction.LEFT?l=this.grid.getNextPosition(new h(l.x,l.y,this.initialDirection),n.Direction.LEFT):this.initialDirection==n.Direction.BOTTOM?l=this.grid.getNextPosition(new h(l.x,l.y,this.initialDirection),n.Direction.BOTTOM):this.initialDirection==n.Direction.UP&&(l=this.grid.getNextPosition(new h(l.x,l.y,this.initialDirection),n.Direction.UP))),this.grid.get(l)!=n.CaseType.EMPTY?f=!0:d.push(new h(l.x,l.y,l.direction));if(this.grid.maze&&f)return this.init()}for(var p=0;p<d.length;p++)this.insert(d[p]);return this.grid.maze&&this.player==n.PlayerType.HYBRID_HUMAN_AI&&(this.player=n.PlayerType.HUMAN),this.player==n.PlayerType.HYBRID_HUMAN_AI&&(this.aiLevel=n.AiLevel.HIGH),this.lastTail=this.get(this.queue.length-1),!0}},{key:"initAI",value:function(){if(this.customAI)this.snakeAI=this.customAI,this.aiLevel=n.AiLevel.CUSTOM;else switch(this.aiLevel){case n.AiLevel.RANDOM:this.snakeAI=new S;break;case n.AiLevel.LOW:this.snakeAI=new P;break;case n.AiLevel.DEFAULT:this.snakeAI=new D;break;case n.AiLevel.HIGH:case n.AiLevel.ULTRA:this.snakeAI=new C;break;default:this.snakeAI=new D}}},{key:"reset",value:function(){this.direction=this.initialDirection,this.initTriedDirections=[],this.errorInit=!1,this.queue=[],this.score=0,this.gameOver=!1,this.scoreMax=!1,this.lastTailMoved=!0,this.lastTail=void 0,this.lastKey=-1,this.aiFruitGoal=n.CaseType.FRUIT,this.ticksDead=0,this.ticksWithoutAction=0}},{key:"insert",value:function(t){this.queue.unshift(t),this.grid.set(n.CaseType.SNAKE,t)}},{key:"remove",value:function(){var t=this.queue.pop();this.grid.set(n.CaseType.EMPTY,t),this.lastTail=t}},{key:"length",value:function(){return this.queue.length}},{key:"get",value:function(t){return null!=this.queue[t]?this.queue[t].copy():null}},{key:"set",value:function(t,e){t>=0&&t<this.length()&&(this.queue[t]=e)}},{key:"getHeadPosition",value:function(){return this.get(0)}},{key:"getTailPosition",value:function(){return this.get(this.length()-1)}},{key:"hasMaxScore",value:function(){return this.grid.getTotal(n.CaseType.EMPTY)<=0&&!this.grid.fruitPosGold&&!this.grid.fruitPos}},{key:"setGameOver",value:function(t){this.gameOver=!0,this.ticksDead=t;for(var e=0;e<this.length();e++)this.grid.set(n.CaseType.SNAKE_DEAD,this.get(e))}},{key:"kill",value:function(){this.autoRetry=!1,this.grid=null,this.queue=null}},{key:"keyToDirection",value:function(t){return t==n.Key.LEFT&&this.direction!=n.Direction.RIGHT&&this.direction!=n.Direction.LEFT?n.Direction.LEFT:t==n.Key.UP&&this.direction!=n.Direction.BOTTOM&&this.direction!=n.Direction.UP?n.Direction.UP:t==n.Key.RIGHT&&this.direction!=n.Direction.LEFT&&this.direction!=n.Direction.RIGHT?n.Direction.RIGHT:t==n.Key.BOTTOM&&this.direction!=n.Direction.UP&&this.direction!=n.Direction.BOTTOM?n.Direction.BOTTOM:null}},{key:"moveTo",value:function(t){var e=this.keyToDirection(t);null!=e&&(this.direction=e)}},{key:"getNextPosition",value:function(t,e){return this.grid.getNextPosition(t,e)}},{key:"getDirectionTo",value:function(t,e){return this.grid.getDirectionTo(t,e)}},{key:"getGraphicDirectionFor",value:function(t,e,i){if(null==e||null==i)return t.direction;var r=this.getDirectionTo(t,i),o=this.getDirectionTo(t,e);return r==n.Direction.LEFT&&o==n.Direction.BOTTOM||r==n.Direction.BOTTOM&&o==n.Direction.LEFT?n.Direction.ANGLE_1:r==n.Direction.RIGHT&&o==n.Direction.BOTTOM||r==n.Direction.BOTTOM&&o==n.Direction.RIGHT?n.Direction.ANGLE_2:r==n.Direction.UP&&o==n.Direction.RIGHT||r==n.Direction.RIGHT&&o==n.Direction.UP?n.Direction.ANGLE_3:r==n.Direction.UP&&o==n.Direction.LEFT||r==n.Direction.LEFT&&o==n.Direction.UP?n.Direction.ANGLE_4:t.direction}},{key:"getGraphicDirection",value:function(t){return this.getGraphicDirectionFor(this.get(t),this.get(t-1),this.get(t+1))}},{key:"copy",value:function(){for(var e=new t(direction,3,new p(this.grid.width,this.grid.height,!1,!1),this.player,this.aiLevel,!1),i=0;i<e.grid.height;i++)for(var n=0;n<e.grid.width;n++)e.grid.set(this.grid.get(new h(n,i)),new h(n,i));e.queue=[];for(var r=0;r<this.queue.length;r++)e.queue.push(elem.copy());return e}},{key:"ai",value:function(){if(this.snakeAI&&this.snakeAI.ai){var t=this.snakeAI.ai(this);return t&&this.keyToDirection(t)!=this.direction?this.ticksWithoutAction=0:this.ticksWithoutAction++,t}return null}},{key:"isAIStuck",value:function(t,e){if(this.snakeAI&&this.snakeAI.ai){if((this.direction==n.Direction.LEFT||this.direction==n.Direction.RIGHT)&&this.ticksWithoutAction>=this.grid.width*t)return!0;if((this.direction==n.Direction.UP||this.direction==n.Direction.BOTTOM)&&this.ticksWithoutAction>=this.grid.height*e)return!0}return!1}},{key:"getAILevelText",value:function(){return this.snakeAI?this.snakeAI.aiLevelText:"???"}}]),t}(),M=function(){function t(e){o()(this,t),this.games=null==e?[]:e,this.reactor=new c,this.reactor.registerEvent("onStart"),this.reactor.registerEvent("onPause"),this.reactor.registerEvent("onContinue"),this.reactor.registerEvent("onStop"),this.reactor.registerEvent("onReset"),this.reactor.registerEvent("onExit"),this.reactor.registerEvent("onScoreIncreased"),this.init()}return a()(t,[{key:"init",value:function(){for(var t=this,e=0;e<this.games.length;e++)0==e&&(this.games[e].enableKeyMenu=!0),this.games[e].onPause(function(e){t.pauseAll(e)}.bind(null,e)),this.games[e].onContinue(function(e){t.startAll(e)}.bind(null,e)),this.games[e].onExit(function(e){t.checkExit(e)}.bind(null,e)),this.games[e].onStop(function(e){t.checkStop(e)}.bind(null,e)),this.games[e].onReset(function(e){t.resetAll(e)}.bind(null,e)),this.games[e].onScoreIncreased(function(e){t.checkOnScoreIncreased(e)}.bind(null,e))}},{key:"start",value:function(){this.startAll(null)}},{key:"startAll",value:function(t){for(var e=0;e<this.games.length;e++)!this.games[e].paused||this.games[e].starting||null!=t&&e==t||this.games[e].start();this.reactor.dispatchEvent("onStart")}},{key:"onStart",value:function(t){this.reactor.addEventListener("onStart",t)}},{key:"pauseAll",value:function(t){for(var e=0;e<this.games.length;e++)this.games[e].paused||null!=t&&e==t||this.games[e].pause();this.reactor.dispatchEvent("onPause")}},{key:"onPause",value:function(t){this.reactor.addEventListener("onPause",t)}},{key:"resetAll",value:function(t){for(var e=0;e<this.games.length;e++)this.games[e].isReseted||null!=t&&e==t||this.games[e].reset();this.reactor.dispatchEvent("onReset")}},{key:"onReset",value:function(t){this.reactor.addEventListener("onReset",t)}},{key:"checkExit",value:function(t){for(var e=!0,i=0;i<this.games.length;i++)this.games[i].exited||(e=!1);e?this.reactor.dispatchEvent("onExit"):this.startAll(t)}},{key:"onExit",value:function(t){this.reactor.addEventListener("onExit",t)}},{key:"checkStop",value:function(){for(var t=!0,e=0;e<this.games.length;e++)this.games[e].gameOver||(t=!1);t&&this.reactor.dispatchEvent("onStop")}},{key:"onStop",value:function(t){this.reactor.addEventListener("onStop",t)}},{key:"stopAll",value:function(t){for(var e=0;e<this.games.length;e++)t?this.games[e].finish(!0):this.games[e].stop()}},{key:"killAll",value:function(){for(var t=0;t<this.games.length;t++)this.games[t].kill()}},{key:"checkOnScoreIncreased",value:function(){this.reactor.dispatchEvent("onScoreIncreased")}},{key:"onScoreIncreased",value:function(t){this.reactor.addEventListener("onScoreIncreased",t)}},{key:"setDisplayFPS",value:function(t){for(var e=0;e<this.games.length;e++)this.games[e].setDisplayFPS(t)}},{key:"setNotification",value:function(t){for(var e=0;e<this.games.length;e++)this.games[e].setNotification(t.copy())}},{key:"closeNotification",value:function(){for(var t=0;t<this.games.length;t++)this.games[t].setNotification(null)}},{key:"errorOccurred",value:function(){for(var t=0;t<this.games.length;t++)if(this.games[t].errorOccurred)return!0;return!1}},{key:"closeRanking",value:function(){for(var t=0;t<this.games.length;t++)this.games[t].closeRanking();return!1}},{key:"getWinners",value:function(){for(var t=[],e=[],i=-1,n=0;n<this.games.length;n++)for(var r=0;r<this.games[n].snakes.length;r++)this.games[n].snakes[r].score>i&&(i=this.games[n].snakes[r].score);if(i>=0)for(var o=0,s=0;s<this.games.length;s++)for(var a=0;a<this.games[s].snakes.length;a++)this.games[s].snakes[a].score>=i&&(t.push(this.games[s].snakes[a]),e.push(o)),o++;return{winners:t,score:i,index:e}}}]),t}();i(8);function F(t){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function N(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function U(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?Object(arguments[e]):{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter((function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable})))),n.forEach((function(e){N(t,e,i[e])}))}return t}function G(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function j(t,e,i){return e&&_(t.prototype,e),i&&_(t,i),t}function H(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function B(t,e){return!e||"object"!==F(e)&&"function"!=typeof e?H(t):e}function z(t){return(z=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function K(t,e){return(K=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Y(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&K(t,e)}var W={type:"logger",log:function(t){this.output("log",t)},warn:function(t){this.output("warn",t)},error:function(t){this.output("error",t)},output:function(t,e){console&&console[t]&&console[t].apply(console,e)}},V=new(function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};G(this,t),this.init(e,i)}return j(t,[{key:"init",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.prefix=e.prefix||"i18next:",this.logger=t||W,this.options=e,this.debug=e.debug}},{key:"setDebug",value:function(t){this.debug=t}},{key:"log",value:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return this.forward(e,"log","",!0)}},{key:"warn",value:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return this.forward(e,"warn","",!0)}},{key:"error",value:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return this.forward(e,"error","")}},{key:"deprecate",value:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}},{key:"forward",value:function(t,e,i,n){return n&&!this.debug?null:("string"==typeof t[0]&&(t[0]="".concat(i).concat(this.prefix," ").concat(t[0])),this.logger[e](t))}},{key:"create",value:function(e){return new t(this.logger,U({},{prefix:"".concat(this.prefix,":").concat(e,":")},this.options))}}]),t}()),q=function(){function t(){G(this,t),this.observers={}}return j(t,[{key:"on",value:function(t,e){var i=this;return t.split(" ").forEach((function(t){i.observers[t]=i.observers[t]||[],i.observers[t].push(e)})),this}},{key:"off",value:function(t,e){this.observers[t]&&(e?this.observers[t]=this.observers[t].filter((function(t){return t!==e})):delete this.observers[t])}},{key:"emit",value:function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];if(this.observers[t]){var r=[].concat(this.observers[t]);r.forEach((function(t){t.apply(void 0,i)}))}if(this.observers["*"]){var o=[].concat(this.observers["*"]);o.forEach((function(e){e.apply(e,[t].concat(i))}))}}}]),t}();function X(){var t,e,i=new Promise((function(i,n){t=i,e=n}));return i.resolve=t,i.reject=e,i}function J(t){return null==t?"":""+t}function Z(t,e,i){t.forEach((function(t){e[t]&&(i[t]=e[t])}))}function Q(t,e,i){function n(t){return t&&t.indexOf("###")>-1?t.replace(/###/g,"."):t}function r(){return!t||"string"==typeof t}for(var o="string"!=typeof e?[].concat(e):e.split(".");o.length>1;){if(r())return{};var s=n(o.shift());!t[s]&&i&&(t[s]=new i),t=t[s]}return r()?{}:{obj:t,k:n(o.shift())}}function $(t,e,i){var n=Q(t,e,Object);n.obj[n.k]=i}function tt(t,e){var i=Q(t,e),n=i.obj,r=i.k;if(n)return n[r]}function et(t,e,i){var n=tt(t,i);return void 0!==n?n:tt(e,i)}function it(t,e,i){for(var n in e)"__proto__"!==n&&(n in t?"string"==typeof t[n]||t[n]instanceof String||"string"==typeof e[n]||e[n]instanceof String?i&&(t[n]=e[n]):it(t[n],e[n],i):t[n]=e[n]);return t}function nt(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var rt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function ot(t){return"string"==typeof t?t.replace(/[&<>"'\/]/g,(function(t){return rt[t]})):t}var st="undefined"!=typeof window&&window.navigator&&window.navigator.userAgent&&window.navigator.userAgent.indexOf("MSIE")>-1,at=function(t){function e(t){var i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ns:["translation"],defaultNS:"translation"};return G(this,e),i=B(this,z(e).call(this)),st&&q.call(H(i)),i.data=t||{},i.options=n,void 0===i.options.keySeparator&&(i.options.keySeparator="."),i}return Y(e,t),j(e,[{key:"addNamespaces",value:function(t){this.options.ns.indexOf(t)<0&&this.options.ns.push(t)}},{key:"removeNamespaces",value:function(t){var e=this.options.ns.indexOf(t);e>-1&&this.options.ns.splice(e,1)}},{key:"getResource",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=void 0!==n.keySeparator?n.keySeparator:this.options.keySeparator,o=[t,e];return i&&"string"!=typeof i&&(o=o.concat(i)),i&&"string"==typeof i&&(o=o.concat(r?i.split(r):i)),t.indexOf(".")>-1&&(o=t.split(".")),tt(this.data,o)}},{key:"addResource",value:function(t,e,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{silent:!1},o=this.options.keySeparator;void 0===o&&(o=".");var s=[t,e];i&&(s=s.concat(o?i.split(o):i)),t.indexOf(".")>-1&&(n=e,e=(s=t.split("."))[1]),this.addNamespaces(e),$(this.data,s,n),r.silent||this.emit("added",t,e,i,n)}},{key:"addResources",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{silent:!1};for(var r in i)"string"!=typeof i[r]&&"[object Array]"!==Object.prototype.toString.apply(i[r])||this.addResource(t,e,r,i[r],{silent:!0});n.silent||this.emit("added",t,e,i)}},{key:"addResourceBundle",value:function(t,e,i,n,r){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{silent:!1},s=[t,e];t.indexOf(".")>-1&&(n=i,i=e,e=(s=t.split("."))[1]),this.addNamespaces(e);var a=tt(this.data,s)||{};n?it(a,i,r):a=U({},a,i),$(this.data,s,a),o.silent||this.emit("added",t,e,i)}},{key:"removeResourceBundle",value:function(t,e){this.hasResourceBundle(t,e)&&delete this.data[t][e],this.removeNamespaces(e),this.emit("removed",t,e)}},{key:"hasResourceBundle",value:function(t,e){return void 0!==this.getResource(t,e)}},{key:"getResourceBundle",value:function(t,e){return e||(e=this.options.defaultNS),"v1"===this.options.compatibilityAPI?U({},{},this.getResource(t,e)):this.getResource(t,e)}},{key:"getDataByLanguage",value:function(t){return this.data[t]}},{key:"toJSON",value:function(){return this.data}}]),e}(q),ut={processors:{},addPostProcessor:function(t){this.processors[t.name]=t},handle:function(t,e,i,n,r){var o=this;return t.forEach((function(t){o.processors[t]&&(e=o.processors[t].process(e,i,n,r))})),e}},ct={},lt=function(t){function e(t){var i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return G(this,e),i=B(this,z(e).call(this)),st&&q.call(H(i)),Z(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],t,H(i)),i.options=n,void 0===i.options.keySeparator&&(i.options.keySeparator="."),i.logger=V.create("translator"),i}return Y(e,t),j(e,[{key:"changeLanguage",value:function(t){t&&(this.language=t)}},{key:"exists",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}},i=this.resolve(t,e);return i&&void 0!==i.res}},{key:"extractFromKey",value:function(t,e){var i=void 0!==e.nsSeparator?e.nsSeparator:this.options.nsSeparator;void 0===i&&(i=":");var n=void 0!==e.keySeparator?e.keySeparator:this.options.keySeparator,r=e.ns||this.options.defaultNS;if(i&&t.indexOf(i)>-1){var o=t.match(this.interpolator.nestingRegexp);if(o&&o.length>0)return{key:t,namespaces:r};var s=t.split(i);(i!==n||i===n&&this.options.ns.indexOf(s[0])>-1)&&(r=s.shift()),t=s.join(n)}return"string"==typeof r&&(r=[r]),{key:t,namespaces:r}}},{key:"translate",value:function(t,e,i){var n=this;if("object"!==F(e)&&this.options.overloadTranslationOptionHandler&&(e=this.options.overloadTranslationOptionHandler(arguments)),e||(e={}),null==t)return"";Array.isArray(t)||(t=[String(t)]);var r=void 0!==e.keySeparator?e.keySeparator:this.options.keySeparator,o=this.extractFromKey(t[t.length-1],e),s=o.key,a=o.namespaces,u=a[a.length-1],c=e.lng||this.language,l=e.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(c&&"cimode"===c.toLowerCase()){if(l){var h=e.nsSeparator||this.options.nsSeparator;return u+h+s}return s}var f=this.resolve(t,e),d=f&&f.res,g=f&&f.usedKey||s,p=f&&f.exactUsedKey||s,y=Object.prototype.toString.apply(d),v=["[object Number]","[object Function]","[object RegExp]"],m=void 0!==e.joinArrays?e.joinArrays:this.options.joinArrays,x=!this.i18nFormat||this.i18nFormat.handleAsObject,k="string"!=typeof d&&"boolean"!=typeof d&&"number"!=typeof d;if(x&&d&&k&&v.indexOf(y)<0&&("string"!=typeof m||"[object Array]"!==y)){if(!e.returnObjects&&!this.options.returnObjects)return this.logger.warn("accessing an object - but returnObjects options is not enabled!"),this.options.returnedObjectHandler?this.options.returnedObjectHandler(g,d,e):"key '".concat(s," (").concat(this.language,")' returned an object instead of string.");if(r){var w="[object Array]"===y,T=w?[]:{},b=w?p:g;for(var A in d)if(Object.prototype.hasOwnProperty.call(d,A)){var E="".concat(b).concat(r).concat(A);T[A]=this.translate(E,U({},e,{joinArrays:!1,ns:a})),T[A]===E&&(T[A]=d[A])}d=T}}else if(x&&"string"==typeof m&&"[object Array]"===y)(d=d.join(m))&&(d=this.extendTranslation(d,t,e,i));else{var S=!1,R=!1;if(!this.isValidLookup(d)&&void 0!==e.defaultValue){if(S=!0,void 0!==e.count){var P=this.pluralResolver.getSuffix(c,e.count);d=e["defaultValue".concat(P)]}d||(d=e.defaultValue)}this.isValidLookup(d)||(R=!0,d=s);var O=e.defaultValue&&e.defaultValue!==d&&this.options.updateMissing;if(R||S||O){if(this.logger.log(O?"updateKey":"missingKey",c,u,s,O?e.defaultValue:d),r){var D=this.resolve(s,U({},e,{keySeparator:!1}));D&&D.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}var L=[],C=this.languageUtils.getFallbackCodes(this.options.fallbackLng,e.lng||this.language);if("fallback"===this.options.saveMissingTo&&C&&C[0])for(var I=0;I<C.length;I++)L.push(C[I]);else"all"===this.options.saveMissingTo?L=this.languageUtils.toResolveHierarchy(e.lng||this.language):L.push(e.lng||this.language);var M=function(t,i){n.options.missingKeyHandler?n.options.missingKeyHandler(t,u,i,O?e.defaultValue:d,O,e):n.backendConnector&&n.backendConnector.saveMissing&&n.backendConnector.saveMissing(t,u,i,O?e.defaultValue:d,O,e),n.emit("missingKey",t,u,i,d)};if(this.options.saveMissing){var N=void 0!==e.count&&"string"!=typeof e.count;this.options.saveMissingPlurals&&N?L.forEach((function(t){n.pluralResolver.getPluralFormsOfKey(t,s).forEach((function(e){return M([t],e)}))})):M(L,s)}}d=this.extendTranslation(d,t,e,f,i),R&&d===s&&this.options.appendNamespaceToMissingKey&&(d="".concat(u,":").concat(s)),R&&this.options.parseMissingKeyHandler&&(d=this.options.parseMissingKeyHandler(d))}return d}},{key:"extendTranslation",value:function(t,e,i,n,r){var o=this;if(this.i18nFormat&&this.i18nFormat.parse)t=this.i18nFormat.parse(t,i,n.usedLng,n.usedNS,n.usedKey,{resolved:n});else if(!i.skipInterpolation){i.interpolation&&this.interpolator.init(U({},i,{interpolation:U({},this.options.interpolation,i.interpolation)}));var s,a=i.interpolation&&i.interpolation.skipOnVariables||this.options.interpolation.skipOnVariables;if(a){var u=t.match(this.interpolator.nestingRegexp);s=u&&u.length}var c=i.replace&&"string"!=typeof i.replace?i.replace:i;if(this.options.interpolation.defaultVariables&&(c=U({},this.options.interpolation.defaultVariables,c)),t=this.interpolator.interpolate(t,c,i.lng||this.language,i),a){var l=t.match(this.interpolator.nestingRegexp);s<(l&&l.length)&&(i.nest=!1)}!1!==i.nest&&(t=this.interpolator.nest(t,(function(){for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return r&&r[0]===i[0]?(o.logger.warn("It seems you are nesting recursively key: ".concat(i[0]," in key: ").concat(e[0])),null):o.translate.apply(o,i.concat([e]))}),i)),i.interpolation&&this.interpolator.reset()}var h=i.postProcess||this.options.postProcess,f="string"==typeof h?[h]:h;return null!=t&&f&&f.length&&!1!==i.applyPostProcessor&&(t=ut.handle(f,t,e,this.options&&this.options.postProcessPassResolved?U({i18nResolved:n},i):i,this)),t}},{key:"resolve",value:function(t){var e,i,n,r,o,s=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"==typeof t&&(t=[t]),t.forEach((function(t){if(!s.isValidLookup(e)){var u=s.extractFromKey(t,a),c=u.key;i=c;var l=u.namespaces;s.options.fallbackNS&&(l=l.concat(s.options.fallbackNS));var h=void 0!==a.count&&"string"!=typeof a.count,f=void 0!==a.context&&"string"==typeof a.context&&""!==a.context,d=a.lngs?a.lngs:s.languageUtils.toResolveHierarchy(a.lng||s.language,a.fallbackLng);l.forEach((function(t){s.isValidLookup(e)||(o=t,!ct["".concat(d[0],"-").concat(t)]&&s.utils&&s.utils.hasLoadedNamespace&&!s.utils.hasLoadedNamespace(o)&&(ct["".concat(d[0],"-").concat(t)]=!0,s.logger.warn('key "'.concat(i,'" for languages "').concat(d.join(", "),'" won\'t get resolved as namespace "').concat(o,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),d.forEach((function(i){if(!s.isValidLookup(e)){r=i;var o,u,l=c,d=[l];if(s.i18nFormat&&s.i18nFormat.addLookupKeys)s.i18nFormat.addLookupKeys(d,c,i,t,a);else h&&(o=s.pluralResolver.getSuffix(i,a.count)),h&&f&&d.push(l+o),f&&d.push(l+="".concat(s.options.contextSeparator).concat(a.context)),h&&d.push(l+=o);for(;u=d.pop();)s.isValidLookup(e)||(n=u,e=s.getResource(i,t,u,a))}})))}))}})),{res:e,usedKey:i,exactUsedKey:n,usedLng:r,usedNS:o}}},{key:"isValidLookup",value:function(t){return!(void 0===t||!this.options.returnNull&&null===t||!this.options.returnEmptyString&&""===t)}},{key:"getResource",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(t,e,i,n):this.resourceStore.getResource(t,e,i,n)}}]),e}(q);function ht(t){return t.charAt(0).toUpperCase()+t.slice(1)}var ft=function(){function t(e){G(this,t),this.options=e,this.whitelist=this.options.supportedLngs||!1,this.supportedLngs=this.options.supportedLngs||!1,this.logger=V.create("languageUtils")}return j(t,[{key:"getScriptPartFromCode",value:function(t){if(!t||t.indexOf("-")<0)return null;var e=t.split("-");return 2===e.length?null:(e.pop(),"x"===e[e.length-1].toLowerCase()?null:this.formatLanguageCode(e.join("-")))}},{key:"getLanguagePartFromCode",value:function(t){if(!t||t.indexOf("-")<0)return t;var e=t.split("-");return this.formatLanguageCode(e[0])}},{key:"formatLanguageCode",value:function(t){if("string"==typeof t&&t.indexOf("-")>-1){var e=["hans","hant","latn","cyrl","cans","mong","arab"],i=t.split("-");return this.options.lowerCaseLng?i=i.map((function(t){return t.toLowerCase()})):2===i.length?(i[0]=i[0].toLowerCase(),i[1]=i[1].toUpperCase(),e.indexOf(i[1].toLowerCase())>-1&&(i[1]=ht(i[1].toLowerCase()))):3===i.length&&(i[0]=i[0].toLowerCase(),2===i[1].length&&(i[1]=i[1].toUpperCase()),"sgn"!==i[0]&&2===i[2].length&&(i[2]=i[2].toUpperCase()),e.indexOf(i[1].toLowerCase())>-1&&(i[1]=ht(i[1].toLowerCase())),e.indexOf(i[2].toLowerCase())>-1&&(i[2]=ht(i[2].toLowerCase()))),i.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?t.toLowerCase():t}},{key:"isWhitelisted",value:function(t){return this.logger.deprecate("languageUtils.isWhitelisted",'function "isWhitelisted" will be renamed to "isSupportedCode" in the next major - please make sure to rename it\'s usage asap.'),this.isSupportedCode(t)}},{key:"isSupportedCode",value:function(t){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(t=this.getLanguagePartFromCode(t)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(t)>-1}},{key:"getBestMatchFromCodes",value:function(t){var e,i=this;return t?(t.forEach((function(t){if(!e){var n=i.formatLanguageCode(t);i.options.supportedLngs&&!i.isSupportedCode(n)||(e=n)}})),!e&&this.options.supportedLngs&&t.forEach((function(t){if(!e){var n=i.getLanguagePartFromCode(t);if(i.isSupportedCode(n))return e=n;e=i.options.supportedLngs.find((function(t){if(0===t.indexOf(n))return t}))}})),e||(e=this.getFallbackCodes(this.options.fallbackLng)[0]),e):null}},{key:"getFallbackCodes",value:function(t,e){if(!t)return[];if("function"==typeof t&&(t=t(e)),"string"==typeof t&&(t=[t]),"[object Array]"===Object.prototype.toString.apply(t))return t;if(!e)return t.default||[];var i=t[e];return i||(i=t[this.getScriptPartFromCode(e)]),i||(i=t[this.formatLanguageCode(e)]),i||(i=t[this.getLanguagePartFromCode(e)]),i||(i=t.default),i||[]}},{key:"toResolveHierarchy",value:function(t,e){var i=this,n=this.getFallbackCodes(e||this.options.fallbackLng||[],t),r=[],o=function(t){t&&(i.isSupportedCode(t)?r.push(t):i.logger.warn("rejecting language code not found in supportedLngs: ".concat(t)))};return"string"==typeof t&&t.indexOf("-")>-1?("languageOnly"!==this.options.load&&o(this.formatLanguageCode(t)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&o(this.getScriptPartFromCode(t)),"currentOnly"!==this.options.load&&o(this.getLanguagePartFromCode(t))):"string"==typeof t&&o(this.formatLanguageCode(t)),n.forEach((function(t){r.indexOf(t)<0&&o(i.formatLanguageCode(t))})),r}}]),t}(),dt=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","kk","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],gt={1:function(t){return Number(t>1)},2:function(t){return Number(1!=t)},3:function(t){return 0},4:function(t){return Number(t%10==1&&t%100!=11?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2)},5:function(t){return Number(0==t?0:1==t?1:2==t?2:t%100>=3&&t%100<=10?3:t%100>=11?4:5)},6:function(t){return Number(1==t?0:t>=2&&t<=4?1:2)},7:function(t){return Number(1==t?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2)},8:function(t){return Number(1==t?0:2==t?1:8!=t&&11!=t?2:3)},9:function(t){return Number(t>=2)},10:function(t){return Number(1==t?0:2==t?1:t<7?2:t<11?3:4)},11:function(t){return Number(1==t||11==t?0:2==t||12==t?1:t>2&&t<20?2:3)},12:function(t){return Number(t%10!=1||t%100==11)},13:function(t){return Number(0!==t)},14:function(t){return Number(1==t?0:2==t?1:3==t?2:3)},15:function(t){return Number(t%10==1&&t%100!=11?0:t%10>=2&&(t%100<10||t%100>=20)?1:2)},16:function(t){return Number(t%10==1&&t%100!=11?0:0!==t?1:2)},17:function(t){return Number(1==t||t%10==1&&t%100!=11?0:1)},18:function(t){return Number(0==t?0:1==t?1:2)},19:function(t){return Number(1==t?0:0==t||t%100>1&&t%100<11?1:t%100>10&&t%100<20?2:3)},20:function(t){return Number(1==t?0:0==t||t%100>0&&t%100<20?1:2)},21:function(t){return Number(t%100==1?1:t%100==2?2:t%100==3||t%100==4?3:0)},22:function(t){return Number(1==t?0:2==t?1:(t<0||t>10)&&t%10==0?2:3)}};function pt(){var t={};return dt.forEach((function(e){e.lngs.forEach((function(i){t[i]={numbers:e.nr,plurals:gt[e.fc]}}))})),t}var yt=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};G(this,t),this.languageUtils=e,this.options=i,this.logger=V.create("pluralResolver"),this.rules=pt()}return j(t,[{key:"addRule",value:function(t,e){this.rules[t]=e}},{key:"getRule",value:function(t){return this.rules[t]||this.rules[this.languageUtils.getLanguagePartFromCode(t)]}},{key:"needsPlural",value:function(t){var e=this.getRule(t);return e&&e.numbers.length>1}},{key:"getPluralFormsOfKey",value:function(t,e){var i=this,n=[],r=this.getRule(t);return r?(r.numbers.forEach((function(r){var o=i.getSuffix(t,r);n.push("".concat(e).concat(o))})),n):n}},{key:"getSuffix",value:function(t,e){var i=this,n=this.getRule(t);if(n){var r=n.noAbs?n.plurals(e):n.plurals(Math.abs(e)),o=n.numbers[r];this.options.simplifyPluralSuffix&&2===n.numbers.length&&1===n.numbers[0]&&(2===o?o="plural":1===o&&(o=""));var s=function(){return i.options.prepend&&o.toString()?i.options.prepend+o.toString():o.toString()};return"v1"===this.options.compatibilityJSON?1===o?"":"number"==typeof o?"_plural_".concat(o.toString()):s():"v2"===this.options.compatibilityJSON||this.options.simplifyPluralSuffix&&2===n.numbers.length&&1===n.numbers[0]?s():this.options.prepend&&r.toString()?this.options.prepend+r.toString():r.toString()}return this.logger.warn("no plural rule found for: ".concat(t)),""}}]),t}(),vt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};G(this,t),this.logger=V.create("interpolator"),this.options=e,this.format=e.interpolation&&e.interpolation.format||function(t){return t},this.init(e)}return j(t,[{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.interpolation||(t.interpolation={escapeValue:!0});var e=t.interpolation;this.escape=void 0!==e.escape?e.escape:ot,this.escapeValue=void 0===e.escapeValue||e.escapeValue,this.useRawValueToEscape=void 0!==e.useRawValueToEscape&&e.useRawValueToEscape,this.prefix=e.prefix?nt(e.prefix):e.prefixEscaped||"{{",this.suffix=e.suffix?nt(e.suffix):e.suffixEscaped||"}}",this.formatSeparator=e.formatSeparator?e.formatSeparator:e.formatSeparator||",",this.unescapePrefix=e.unescapeSuffix?"":e.unescapePrefix||"-",this.unescapeSuffix=this.unescapePrefix?"":e.unescapeSuffix||"",this.nestingPrefix=e.nestingPrefix?nt(e.nestingPrefix):e.nestingPrefixEscaped||nt("$t("),this.nestingSuffix=e.nestingSuffix?nt(e.nestingSuffix):e.nestingSuffixEscaped||nt(")"),this.nestingOptionsSeparator=e.nestingOptionsSeparator?e.nestingOptionsSeparator:e.nestingOptionsSeparator||",",this.maxReplaces=e.maxReplaces?e.maxReplaces:1e3,this.alwaysFormat=void 0!==e.alwaysFormat&&e.alwaysFormat,this.resetRegExp()}},{key:"reset",value:function(){this.options&&this.init(this.options)}},{key:"resetRegExp",value:function(){var t="".concat(this.prefix,"(.+?)").concat(this.suffix);this.regexp=new RegExp(t,"g");var e="".concat(this.prefix).concat(this.unescapePrefix,"(.+?)").concat(this.unescapeSuffix).concat(this.suffix);this.regexpUnescape=new RegExp(e,"g");var i="".concat(this.nestingPrefix,"(.+?)").concat(this.nestingSuffix);this.nestingRegexp=new RegExp(i,"g")}},{key:"interpolate",value:function(t,e,i,n){var r,o,s,a=this,u=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function c(t){return t.replace(/\$/g,"$$$$")}var l=function(t){if(t.indexOf(a.formatSeparator)<0){var r=et(e,u,t);return a.alwaysFormat?a.format(r,void 0,i):r}var o=t.split(a.formatSeparator),s=o.shift().trim(),c=o.join(a.formatSeparator).trim();return a.format(et(e,u,s),c,i,n)};this.resetRegExp();var h=n&&n.missingInterpolationHandler||this.options.missingInterpolationHandler,f=n&&n.interpolation&&n.interpolation.skipOnVariables||this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:function(t){return c(t)}},{regex:this.regexp,safeValue:function(t){return a.escapeValue?c(a.escape(t)):c(t)}}].forEach((function(e){for(s=0;r=e.regex.exec(t);){if(void 0===(o=l(r[1].trim())))if("function"==typeof h){var i=h(t,r,n);o="string"==typeof i?i:""}else{if(f){o=r[0];continue}a.logger.warn("missed to pass in variable ".concat(r[1]," for interpolating ").concat(t)),o=""}else"string"==typeof o||a.useRawValueToEscape||(o=J(o));if(t=t.replace(r[0],e.safeValue(o)),e.regex.lastIndex=0,++s>=a.maxReplaces)break}})),t}},{key:"nest",value:function(t,e){var i,n,r=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=U({},o);function a(t,e){var i=this.nestingOptionsSeparator;if(t.indexOf(i)<0)return t;var n=t.split(new RegExp("".concat(i,"[ ]*{"))),r="{".concat(n[1]);t=n[0],r=(r=this.interpolate(r,s)).replace(/'/g,'"');try{s=JSON.parse(r),e&&(s=U({},e,s))}catch(e){return this.logger.warn("failed parsing options string in nesting for key ".concat(t),e),"".concat(t).concat(i).concat(r)}return delete s.defaultValue,t}for(s.applyPostProcessor=!1,delete s.defaultValue;i=this.nestingRegexp.exec(t);){var u=[],c=!1;if(i[0].includes(this.formatSeparator)&&!/{.*}/.test(i[1])){var l=i[1].split(this.formatSeparator).map((function(t){return t.trim()}));i[1]=l.shift(),u=l,c=!0}if((n=e(a.call(this,i[1].trim(),s),s))&&i[0]===t&&"string"!=typeof n)return n;"string"!=typeof n&&(n=J(n)),n||(this.logger.warn("missed to resolve ".concat(i[1]," for nesting ").concat(t)),n=""),c&&(n=u.reduce((function(t,e){return r.format(t,e,o.lng,o)}),n.trim())),t=t.replace(i[0],n),this.regexp.lastIndex=0}return t}}]),t}();var mt=function(t){function e(t,i,n){var r,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return G(this,e),r=B(this,z(e).call(this)),st&&q.call(H(r)),r.backend=t,r.store=i,r.services=n,r.languageUtils=n.languageUtils,r.options=o,r.logger=V.create("backendConnector"),r.state={},r.queue=[],r.backend&&r.backend.init&&r.backend.init(n,o.backend,o),r}return Y(e,t),j(e,[{key:"queueLoad",value:function(t,e,i,n){var r=this,o=[],s=[],a=[],u=[];return t.forEach((function(t){var n=!0;e.forEach((function(e){var a="".concat(t,"|").concat(e);!i.reload&&r.store.hasResourceBundle(t,e)?r.state[a]=2:r.state[a]<0||(1===r.state[a]?s.indexOf(a)<0&&s.push(a):(r.state[a]=1,n=!1,s.indexOf(a)<0&&s.push(a),o.indexOf(a)<0&&o.push(a),u.indexOf(e)<0&&u.push(e)))})),n||a.push(t)})),(o.length||s.length)&&this.queue.push({pending:s,loaded:{},errors:[],callback:n}),{toLoad:o,pending:s,toLoadLanguages:a,toLoadNamespaces:u}}},{key:"loaded",value:function(t,e,i){var n=t.split("|"),r=n[0],o=n[1];e&&this.emit("failedLoading",r,o,e),i&&this.store.addResourceBundle(r,o,i),this.state[t]=e?-1:2;var s={};this.queue.forEach((function(i){var n,a,u,c,l,h;n=i.loaded,a=o,c=Q(n,[r],Object),l=c.obj,h=c.k,l[h]=l[h]||[],u&&(l[h]=l[h].concat(a)),u||l[h].push(a),function(t,e){for(var i=t.indexOf(e);-1!==i;)t.splice(i,1),i=t.indexOf(e)}(i.pending,t),e&&i.errors.push(e),0!==i.pending.length||i.done||(Object.keys(i.loaded).forEach((function(t){s[t]||(s[t]=[]),i.loaded[t].length&&i.loaded[t].forEach((function(e){s[t].indexOf(e)<0&&s[t].push(e)}))})),i.done=!0,i.errors.length?i.callback(i.errors):i.callback())})),this.emit("loaded",s),this.queue=this.queue.filter((function(t){return!t.done}))}},{key:"read",value:function(t,e,i){var n=this,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:350,s=arguments.length>5?arguments[5]:void 0;return t.length?this.backend[i](t,e,(function(a,u){a&&u&&r<5?setTimeout((function(){n.read.call(n,t,e,i,r+1,2*o,s)}),o):s(a,u)})):s(null,{})}},{key:"prepareLoading",value:function(t,e){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),r&&r();"string"==typeof t&&(t=this.languageUtils.toResolveHierarchy(t)),"string"==typeof e&&(e=[e]);var o=this.queueLoad(t,e,n,r);if(!o.toLoad.length)return o.pending.length||r(),null;o.toLoad.forEach((function(t){i.loadOne(t)}))}},{key:"load",value:function(t,e,i){this.prepareLoading(t,e,{},i)}},{key:"reload",value:function(t,e,i){this.prepareLoading(t,e,{reload:!0},i)}},{key:"loadOne",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=t.split("|"),r=n[0],o=n[1];this.read(r,o,"read",void 0,void 0,(function(n,s){n&&e.logger.warn("".concat(i,"loading namespace ").concat(o," for language ").concat(r," failed"),n),!n&&s&&e.logger.log("".concat(i,"loaded namespace ").concat(o," for language ").concat(r),s),e.loaded(t,n,s)}))}},{key:"saveMissing",value:function(t,e,i,n,r){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(e)?this.logger.warn('did not save key "'.concat(i,'" as the namespace "').concat(e,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!"):null!=i&&""!==i&&(this.backend&&this.backend.create&&this.backend.create(t,e,i,n,null,U({},o,{isUpdate:r})),t&&t[0]&&this.store.addResource(t[0],e,i,n))}}]),e}(q);function xt(){return{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,whitelist:!1,nonExplicitWhitelist:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!0,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(t){var e={};if("object"===F(t[1])&&(e=t[1]),"string"==typeof t[1]&&(e.defaultValue=t[1]),"string"==typeof t[2]&&(e.tDescription=t[2]),"object"===F(t[2])||"object"===F(t[3])){var i=t[3]||t[2];Object.keys(i).forEach((function(t){e[t]=i[t]}))}return e},interpolation:{escapeValue:!0,format:function(t,e,i,n){return t},prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!1}}}function kt(t){return"string"==typeof t.ns&&(t.ns=[t.ns]),"string"==typeof t.fallbackLng&&(t.fallbackLng=[t.fallbackLng]),"string"==typeof t.fallbackNS&&(t.fallbackNS=[t.fallbackNS]),t.whitelist&&(t.whitelist&&t.whitelist.indexOf("cimode")<0&&(t.whitelist=t.whitelist.concat(["cimode"])),t.supportedLngs=t.whitelist),t.nonExplicitWhitelist&&(t.nonExplicitSupportedLngs=t.nonExplicitWhitelist),t.supportedLngs&&t.supportedLngs.indexOf("cimode")<0&&(t.supportedLngs=t.supportedLngs.concat(["cimode"])),t}function wt(){}var Tt=new(function(t){function e(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;if(G(this,e),t=B(this,z(e).call(this)),st&&q.call(H(t)),t.options=kt(i),t.services={},t.logger=V,t.modules={external:[]},n&&!t.isInitialized&&!i.isClone){if(!t.options.initImmediate)return t.init(i,n),B(t,H(t));setTimeout((function(){t.init(i,n)}),0)}return t}return Y(e,t),j(e,[{key:"init",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;function n(t){return t?"function"==typeof t?new t:t:null}if("function"==typeof e&&(i=e,e={}),e.whitelist&&!e.supportedLngs&&this.logger.deprecate("whitelist",'option "whitelist" will be renamed to "supportedLngs" in the next major - please make sure to rename this option asap.'),e.nonExplicitWhitelist&&!e.nonExplicitSupportedLngs&&this.logger.deprecate("whitelist",'options "nonExplicitWhitelist" will be renamed to "nonExplicitSupportedLngs" in the next major - please make sure to rename this option asap.'),this.options=U({},xt(),this.options,kt(e)),this.format=this.options.interpolation.format,i||(i=wt),!this.options.isClone){this.modules.logger?V.init(n(this.modules.logger),this.options):V.init(null,this.options);var r=new ft(this.options);this.store=new at(this.options.resources,this.options);var o=this.services;o.logger=V,o.resourceStore=this.store,o.languageUtils=r,o.pluralResolver=new yt(r,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),o.interpolator=new vt(this.options),o.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},o.backendConnector=new mt(n(this.modules.backend),o.resourceStore,o,this.options),o.backendConnector.on("*",(function(e){for(var i=arguments.length,n=new Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];t.emit.apply(t,[e].concat(n))})),this.modules.languageDetector&&(o.languageDetector=n(this.modules.languageDetector),o.languageDetector.init(o,this.options.detection,this.options)),this.modules.i18nFormat&&(o.i18nFormat=n(this.modules.i18nFormat),o.i18nFormat.init&&o.i18nFormat.init(this)),this.translator=new lt(this.services,this.options),this.translator.on("*",(function(e){for(var i=arguments.length,n=new Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];t.emit.apply(t,[e].concat(n))})),this.modules.external.forEach((function(e){e.init&&e.init(t)}))}this.modules.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined");var s=["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"];s.forEach((function(e){t[e]=function(){var i;return(i=t.store)[e].apply(i,arguments)}}));var a=["addResource","addResources","addResourceBundle","removeResourceBundle"];a.forEach((function(e){t[e]=function(){var i;return(i=t.store)[e].apply(i,arguments),t}}));var u=X(),c=function(){t.changeLanguage(t.options.lng,(function(e,n){t.isInitialized=!0,t.logger.log("initialized",t.options),t.emit("initialized",t.options),u.resolve(n),i(e,n)}))};return this.options.resources||!this.options.initImmediate?c():setTimeout(c,0),u}},{key:"loadResources",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:wt,n=i,r="string"==typeof t?t:this.language;if("function"==typeof t&&(n=t),!this.options.resources||this.options.partialBundledLanguages){if(r&&"cimode"===r.toLowerCase())return n();var o=[],s=function(t){t&&e.services.languageUtils.toResolveHierarchy(t).forEach((function(t){o.indexOf(t)<0&&o.push(t)}))};if(r)s(r);else{var a=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);a.forEach((function(t){return s(t)}))}this.options.preload&&this.options.preload.forEach((function(t){return s(t)})),this.services.backendConnector.load(o,this.options.ns,n)}else n(null)}},{key:"reloadResources",value:function(t,e,i){var n=X();return t||(t=this.languages),e||(e=this.options.ns),i||(i=wt),this.services.backendConnector.reload(t,e,(function(t){n.resolve(),i(t)})),n}},{key:"use",value:function(t){if(!t)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!t.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===t.type&&(this.modules.backend=t),("logger"===t.type||t.log&&t.warn&&t.error)&&(this.modules.logger=t),"languageDetector"===t.type&&(this.modules.languageDetector=t),"i18nFormat"===t.type&&(this.modules.i18nFormat=t),"postProcessor"===t.type&&ut.addPostProcessor(t),"3rdParty"===t.type&&this.modules.external.push(t),this}},{key:"changeLanguage",value:function(t,e){var i=this;this.isLanguageChangingTo=t;var n=X();this.emit("languageChanging",t);var r=function(t){var r="string"==typeof t?t:i.services.languageUtils.getBestMatchFromCodes(t);r&&(i.language||(i.language=r,i.languages=i.services.languageUtils.toResolveHierarchy(r)),i.translator.language||i.translator.changeLanguage(r),i.services.languageDetector&&i.services.languageDetector.cacheUserLanguage(r)),i.loadResources(r,(function(t){!function(t,r){r?(i.language=r,i.languages=i.services.languageUtils.toResolveHierarchy(r),i.translator.changeLanguage(r),i.isLanguageChangingTo=void 0,i.emit("languageChanged",r),i.logger.log("languageChanged",r)):i.isLanguageChangingTo=void 0,n.resolve((function(){return i.t.apply(i,arguments)})),e&&e(t,(function(){return i.t.apply(i,arguments)}))}(t,r)}))};return t||!this.services.languageDetector||this.services.languageDetector.async?!t&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect(r):r(t):r(this.services.languageDetector.detect()),n}},{key:"getFixedT",value:function(t,e){var i=this,n=function t(e,n){var r;if("object"!==F(n)){for(var o=arguments.length,s=new Array(o>2?o-2:0),a=2;a<o;a++)s[a-2]=arguments[a];r=i.options.overloadTranslationOptionHandler([e,n].concat(s))}else r=U({},n);return r.lng=r.lng||t.lng,r.lngs=r.lngs||t.lngs,r.ns=r.ns||t.ns,i.t(e,r)};return"string"==typeof t?n.lng=t:n.lngs=t,n.ns=e,n}},{key:"t",value:function(){var t;return this.translator&&(t=this.translator).translate.apply(t,arguments)}},{key:"exists",value:function(){var t;return this.translator&&(t=this.translator).exists.apply(t,arguments)}},{key:"setDefaultNamespace",value:function(t){this.options.defaultNS=t}},{key:"hasLoadedNamespace",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;var n=this.languages[0],r=!!this.options&&this.options.fallbackLng,o=this.languages[this.languages.length-1];if("cimode"===n.toLowerCase())return!0;var s=function(t,i){var n=e.services.backendConnector.state["".concat(t,"|").concat(i)];return-1===n||2===n};if(i.precheck){var a=i.precheck(this,s);if(void 0!==a)return a}return!!this.hasResourceBundle(n,t)||(!this.services.backendConnector.backend||!(!s(n,t)||r&&!s(o,t)))}},{key:"loadNamespaces",value:function(t,e){var i=this,n=X();return this.options.ns?("string"==typeof t&&(t=[t]),t.forEach((function(t){i.options.ns.indexOf(t)<0&&i.options.ns.push(t)})),this.loadResources((function(t){n.resolve(),e&&e(t)})),n):(e&&e(),Promise.resolve())}},{key:"loadLanguages",value:function(t,e){var i=X();"string"==typeof t&&(t=[t]);var n=this.options.preload||[],r=t.filter((function(t){return n.indexOf(t)<0}));return r.length?(this.options.preload=n.concat(r),this.loadResources((function(t){i.resolve(),e&&e(t)})),i):(e&&e(),Promise.resolve())}},{key:"dir",value:function(t){if(t||(t=this.languages&&this.languages.length>0?this.languages[0]:this.language),!t)return"rtl";return["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam"].indexOf(this.services.languageUtils.getLanguagePartFromCode(t))>=0?"rtl":"ltr"}},{key:"createInstance",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;return new e(t,i)}},{key:"cloneInstance",value:function(){var t=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:wt,r=U({},this.options,i,{isClone:!0}),o=new e(r),s=["store","services","language"];return s.forEach((function(e){o[e]=t[e]})),o.services=U({},this.services),o.services.utils={hasLoadedNamespace:o.hasLoadedNamespace.bind(o)},o.translator=new lt(o.services,o.options),o.translator.on("*",(function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];o.emit.apply(o,[t].concat(i))})),o.init(r,n),o.translator.options=o.options,o.translator.backendConnector.services.utils={hasLoadedNamespace:o.hasLoadedNamespace.bind(o)},o}}]),e}(q)),bt=i(0);function At(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=A()(t);if(e){var r=A()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return T()(this,i)}}bt.Component;function Et(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=A()(t);if(e){var r=A()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return T()(this,i)}}bt.Component;function St(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=A()(t);if(e){var r=A()(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return T()(this,i)}}bt.Component;bt.Constants.Setting.FONT_FAMILY="DELIUS";"undefined"!=typeof window&&(window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame,window.cancelAnimationFrame=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame||window.oCancelAnimationFrame||window.mozCancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame),"undefined"!=typeof document&&void 0===document.fullscreenElement&&Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement||document.oFullscreenElement}}),"undefined"!=typeof document&&(document.exitFullscreen=document.exitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen||document.msExitFullscreen),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")});!function(t){if("undefined"!=typeof window)try{if(!window.Worker)throw"Workers not supported";var e=new Worker("dist/GameEngineWorker.js");e&&(e.postMessage("ping"),e.onmessage=function(i){if("pong"==i.data)return e.terminate(),t(!0)})}catch(e){return t(!1)}}((function(t){t})),"undefined"!=typeof window&&(window.PLAYER_AI=n.PlayerType.AI,window.PLAYER_HUMAN=n.PlayerType.HUMAN,window.PLAYER_HYBRID_HUMAN_AI=n.PlayerType.HYBRID_HUMAN_AI,window.AI_LEVEL_RANDOM=n.AiLevel.RANDOM,window.AI_LEVEL_LOW=n.AiLevel.LOW,window.AI_LEVEL_DEFAULT=n.AiLevel.DEFAULT,window.AI_LEVEL_HIGH=n.AiLevel.HIGH,window.AI_LEVEL_ULTRA=n.AiLevel.ULTRA,window.UP=n.Direction.UP,window.RIGHT=n.Direction.RIGHT,window.BOTTOM=n.Direction.BOTTOM,window.LEFT=n.Direction.LEFT,window.ANGLE_1=n.Direction.ANGLE_1,window.ANGLE_2=n.Direction.ANGLE_2,window.ANGLE_3=n.Direction.ANGLE_3,window.ANGLE_4=n.Direction.ANGLE_4,window.APP_VERSION=n.Setting.APP_VERSION,window.DATE_VERSION=n.Setting.DATE_VERSION);var Rt=function(){function t(e,i,n,r,s,a){o()(this,t),this.grid=e,this.snakes=i,this.speed=null==n?8:n,this.initialSpeed=null==n?8:n,this.initialSpeedUntouched=null==n?8:n,this.enablePause=null==r||r,this.enableRetry=null==s||s,this.progressiveSpeed=null!=a&&a,this.countBeforePlay=3,this.lastKey=-1,this.numFruit=1,this.ticks=0,this.firstStart=!0,this.starting=!1,this.paused=!0,this.exited=!1,this.killed=!1,this.isReseted=!0,this.gameOver=!1,this.gameFinished=!1,this.gameMazeWin=!1,this.scoreMax=!1,this.errorOccurred=!1,this.clientSidePredictionsMode=!1,this.aiStuck=!1,this.intervalPlay,this.reactor=new c,this.reactor.registerEvent("onStart"),this.reactor.registerEvent("onPause"),this.reactor.registerEvent("onContinue"),this.reactor.registerEvent("onReset"),this.reactor.registerEvent("onStop"),this.reactor.registerEvent("onExit"),this.reactor.registerEvent("onKill"),this.reactor.registerEvent("onScoreIncreased"),this.reactor.registerEvent("onUpdate"),this.reactor.registerEvent("onUpdateCounter")}return a()(t,[{key:"init",value:function(){if(!this.clientSidePredictionsMode)if(null==this.snakes?(this.errorOccurred=!0,this.snakes=[]):Array.isArray(this.snakes)?(Array.isArray(this.snakes)&&this.snakes.length<=0||this.grid.maze&&this.snakes.length>1)&&(this.errorOccurred=!0):this.snakes=[this.snakes],this.grid instanceof p==0)this.errorOccurred=!0;else if(!this.errorOccurred){this.initGridAndSnakes();for(var t=l.randRange(0,360,this.grid?new d.a(this.grid.seedGame):null),e=0;e<this.snakes.length;e++)this.snakes[e]instanceof I==0?this.errorOccurred=!0:(t=l.addHue(t,Math.round(360/this.snakes.length)),this.snakes[e].color=t)}}},{key:"initGridAndSnakes",value:function(){if(this.grid.reset(),this.grid.init(),null!=this.snakes){for(var t=0;t<this.snakes.length;t++)this.snakes[t].reset();for(var e=0;e<this.snakes.length;e++)this.snakes[e].init()}this.grid.setFruit(this.snakes.length)}},{key:"reset",value:function(){this.paused=!0,this.isReseted=!0,this.exited=!1,this.clearIntervalPlay(),this.numFruit=1,this.ticks=0,this.lastKey=-1,this.scoreMax=!1,this.errorOccurred=!1,this.gameOver=!1,this.gameFinished=!1,this.gameMazeWin=!1,this.starting=!1,this.initialSpeed=this.initialSpeedUntouched,this.speed=this.initialSpeedUntouched,this.aiStuck=!1,this.grid.seedGrid&&(this.grid.seedGrid=""+(parseInt(this.grid.seedGrid)+1)),this.grid.seedGame&&(this.grid.seedGame=""+(parseInt(this.grid.seedGame)+1)),this.initGridAndSnakes(),this.reactor.dispatchEvent("onReset"),this.start()}},{key:"start",value:function(){var t=this;if(this.reactor.dispatchEvent("onUpdateCounter"),!this.errorOccurred){if(null!=this.snakes)for(var e=0;e<this.snakes.length;e++)this.snakes[e].errorInit&&(this.errorOccurred=!0,this.stop());!this.paused||this.gameOver||this.killed||this.scoreMax||this.starting||(this.starting=!0,this.firstStart||this.reactor.dispatchEvent("onContinue"),this.countBeforePlay=3,this.clearIntervalPlay(),this.reactor.dispatchEvent("onUpdateCounter"),this.intervalPlay=setInterval((function(){t.countBeforePlay--,t.reactor.dispatchEvent("onUpdateCounter"),t.countBeforePlay<0&&t.forceStart()}),1e3))}}},{key:"forceStart",value:function(){this.clearIntervalPlay(),this.countBeforePlay=-1,this.paused=!1,this.isReseted=!1,this.firstStart=!1,this.starting=!1,this.reactor.dispatchEvent("onStart"),this.tick()}},{key:"clearIntervalPlay",value:function(){clearInterval(this.intervalPlay)}},{key:"continue",value:function(){this.clientSidePredictionsMode||(this.start(),this.reactor.dispatchEvent("onContinue"))}},{key:"stop",value:function(t){this.gameOver||this.clientSidePredictionsMode||(this.paused=!0,this.gameOver=!0,t&&(this.gameFinished=!0),this.clearIntervalPlay(),this.reactor.dispatchEvent("onStop"))}},{key:"pause",value:function(){this.paused||this.clientSidePredictionsMode||(this.paused=!0,this.clearIntervalPlay(),this.reactor.dispatchEvent("onPause"))}},{key:"kill",value:function(){if(!this.killed){if(this.paused=!0,this.gameOver=!0,this.killed=!0,null!=this.snakes)for(var t=0;t<this.snakes.length;t++)this.snakes[t].kill(),this.snakes[t]=null;this.clearIntervalPlay(),this.grid=null,this.snakes=null,this.reactor.dispatchEvent("onKill")}}},{key:"exit",value:function(){this.exited||(this.stop(),this.exited=!0,this.reactor.dispatchEvent("onExit"))}},{key:"getNBPlayer",value:function(t){var e=0;if(null!=this.snakes)for(var i=0;i<this.snakes.length;i++)this.snakes[i].player==t&&e++;return e}},{key:"getPlayer",value:function(t,e){var i=0;if(null!=this.snakes)for(var n=0;n<this.snakes.length;n++)if(this.snakes[n].player==e&&i++,i==t)return this.snakes[n];return null}},{key:"tick",value:function(){var t=this;setTimeout((function(){if(!t.paused&&!t.killed){0==t.lastTime&&(t.lastTime=time),t.ticks++;var e,i=!1;if(t.grid&&(!t.grid.maze||t.grid.mazeForceAuto||t.grid.maze&&t.getNBPlayer(n.PlayerType.HUMAN)<=0&&t.getNBPlayer(n.PlayerType.HYBRID_HUMAN_AI)<=0||t.grid.maze&&(t.getNBPlayer(n.PlayerType.HUMAN)>0||t.getNBPlayer(n.PlayerType.HYBRID_HUMAN_AI)>0)&&-1!=(t.getPlayer(1,n.PlayerType.HYBRID_HUMAN_AI)||t.getPlayer(1,n.PlayerType.HUMAN)).lastKey)){for(var r=0;r<t.snakes.length;r++){var o=t.snakes[r].direction,s=!1,a=!1;if(i=!1,t.snakes[r].lastTailMoved=!1,!t.snakes[r].gameOver&&!t.snakes[r].scoreMax){t.snakes[r].player==n.PlayerType.HUMAN||t.snakes[r].player==n.PlayerType.HYBRID_HUMAN_AI?(t.snakes[r].moveTo(t.snakes[r].lastKey),t.snakes[r].lastKey=-1):t.snakes[r].player==n.PlayerType.AI&&(!t.clientSidePredictionsMode||t.clientSidePredictionsMode&&t.snakes[r].aiLevel!=n.AiLevel.RANDOM)&&t.snakes[r].moveTo(t.snakes[r].ai());var u=t.snakes[r].getHeadPosition();t.snakes[r].player==n.PlayerType.HYBRID_HUMAN_AI&&t.grid.isDeadPosition(t.snakes[r].getNextPosition(u,t.snakes[r].direction))&&(t.snakes[r].direction=o,t.snakes[r].moveTo(t.snakes[r].ai()),t.snakes[r].lastKey=-1),u=t.snakes[r].getNextPosition(u,t.snakes[r].direction),t.grid.isDeadPosition(u)?t.snakes[r].setGameOver(t.ticks):t.grid.get(u)==n.CaseType.FRUIT||t.grid.get(u)==n.CaseType.FRUIT_GOLD?(t.grid.get(u)==n.CaseType.FRUIT?(t.snakes[r].score++,t.grid.set(n.CaseType.EMPTY,t.grid.fruitPos),t.grid.fruitPos=null):t.grid.get(u)==n.CaseType.FRUIT_GOLD&&(t.snakes[r].score+=3,t.grid.set(n.CaseType.EMPTY,t.grid.fruitPosGold),t.grid.fruitPosGold=null,a=!0),e=!0,t.snakes[r].insert(u),t.grid.maze?(t.gameMazeWin=!0,t.gameFinished=!0,t.stop()):t.snakes[r].hasMaxScore()&&t.snakes.length<=1?(t.scoreMax=!0,t.snakes[r].scoreMax=!0,t.stop()):(t.numFruit++,a||(s=!0)),t.snakes.length<=1&&t.progressiveSpeed&&t.snakes[r].score>0&&t.initialSpeed>1&&(t.initialSpeed=Math.ceil(-t.initialSpeedUntouched/100*t.snakes[r].score+t.initialSpeedUntouched),t.initialSpeed=t.initialSpeed<1?1:t.initialSpeed)):(t.snakes[r].insert(u),t.grid.maze||(t.snakes[r].remove(),t.snakes[r].lastTailMoved=!0))}t.scoreMax||!s||t.clientSidePredictionsMode||(i=!t.grid.setFruit(t.snakes.length))}t.scoreMax||i||!t.grid.isFruitSurrounded(t.grid.fruitPos,!0)&&!t.grid.detectCorridor(t.grid.fruitPos)||t.clientSidePredictionsMode||(i=!t.grid.setFruit(t.snakes.length)),t.scoreMax||null==t.grid.fruitPosGold||!t.grid.isFruitSurrounded(t.grid.fruitPosGold,!0)&&!t.grid.detectCorridor(t.grid.fruitPos)||(t.grid.set(n.CaseType.EMPTY,t.grid.fruitPosGold),t.grid.fruitPosGold=null);for(var c=0,l=0;l<t.snakes.length;l++)(t.snakes[l].gameOver||t.snakes[l].scoreMax)&&c++;for(var h=!1,f=0;f<t.snakes.length;f++)if(!t.snakes[f].gameOver&&t.snakes[f].isAIStuck(1,1))t.aiStuck=!0,h=!!t.snakes[f].isAIStuck(5,5);else if((t.snakes[f].player==n.PlayerType.HUMAN||t.snakes[f].player==n.PlayerType.HYBRID_HUMAN_AI)&&!t.snakes[f].gameOver||t.snakes[f].player==n.PlayerType.AI&&!t.snakes[f].gameOver){t.aiStuck=!1,h=!1;break}(c>=t.snakes.length||i||h)&&(t.stop(),t.snakes.length>1&&(t.gameFinished=!0)),t.reactor.dispatchEvent("onUpdate"),e&&t.reactor.dispatchEvent("onScoreIncreased")}t.tick()}}),this.initialSpeed*n.Setting.TIME_MULTIPLIER)}},{key:"onReset",value:function(t){this.reactor.addEventListener("onReset",t)}},{key:"onStart",value:function(t){this.reactor.addEventListener("onStart",t)}},{key:"onContinue",value:function(t){this.reactor.addEventListener("onContinue",t)}},{key:"onStop",value:function(t){this.reactor.addEventListener("onStop",t)}},{key:"onPause",value:function(t){this.reactor.addEventListener("onPause",t)}},{key:"onExit",value:function(t){this.reactor.addEventListener("onExit",t)}},{key:"onKill",value:function(t){this.reactor.addEventListener("onKill",t)}},{key:"onScoreIncreased",value:function(t){this.reactor.addEventListener("onScoreIncreased",t)}},{key:"onUpdate",value:function(t){this.reactor.addEventListener("onUpdate",t)}},{key:"onUpdateCounter",value:function(t){this.reactor.addEventListener("onUpdateCounter",t)}}]),t}()}])}));